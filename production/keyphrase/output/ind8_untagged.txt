spoton  an indoor 3d location sensing technology based on rf signal strength jeffrey hightower and gaetano borriello  jeffro  gaetano  @ cs.washington.edu university of washington computer science and engineering seattle  wa 98195 roy want want @ parc.xerox.com xerox palo alto research center palo alto  ca 94304 uw cse technical report # 2000-02-02 february 18  2000 abstract providing a reliable technology and architecture for determining the location of real world objects and people will undoubtedly enable applications  customization  and inference not currently possible  this paper documents the creation of spoton  a new tagging technology for three dimensional location sensing based on radio signal strength analysis  although there are many aspects to the topic of location sensing and several of them will be briefly discussed  this paper is primarily concerned with the hardware and embedded system development of such a system  1 introduction in the next century  consumer computing will rely heavily upon mobility  context awareness  task inference  and distributed services  this is not simply a problem of adhoc networking of existing applications  but one that requires the development of new devices and services to measure  record  and leverage the state of the physical world  it is also critical that this real world awareness must have a low cognitive load to the user  thus creating a level of convenience in applications that does not exist now  the terms invisible and ubiquitous computing captures these principles  while there are certainly many facets to invisible computing  location-sensing systems capture our particular interest and are a fundamental technology in the field  the overarching goal of spoton is to create and analyze a fine-grained indoor locationsensing system and the associated services for use within an invisible computing framework  this paper documents the process of creating the spoton object tagging technology based on radio signal strength analysis and focuses mostly on the hardware and embedded systems aspects  such an approach combines the advantages of wireless location systems  fine granularity  with that of infrared-based systems  detection at a distance   this paper is organized as follows  section 2 presents relevant background information and a review of related work  section 3 documents the rfideas experiment our initial attempt to develop a signal strength based location sensing system using commercial components  section 4 describes our custom hardware design based on the lessons learned from the rfideas experiment  finally  we speculate about applications  discuss future work  and offer conclusions in sections 5  6  and 7  1 2 background 2.1 positioning  tracking  and location sensing before a general survey of similar work is presented  it is necessary to offer a definition  we wish to partition systems into two categories  positioning and tracking  positioning systems are those that provide the means to determine location and leave it up to the user to compute his or her actual position  tracking systems  on the other hand  are those that monitor objects in their purview without involving the tracked objects in the computation  many systems are somewhat of a hybrid of these two types whether by design or simply by configuration often in the interest of security and privacy  we apply the term location sensing to such hybrid systems including our own where the policy of manipulating location data attempts to be separate from the mechanism of actually pinpointing the object  2.2 related work there have been many systems and architectures over the years tackling the problem of determining location  since each was developed to fulfill a different goal  they vary widely in many parameters including accuracy  cost  size  configurability  security  and reliability  examples include gps  active badges and the xerox parctab  at & t cambridge ultrasonic bats  microsoft researchs wavelan system  the smart floor from georgia tech  pinpointcos radio tags  various computer vision systems  and various cellular phone based solutions  the global positioning system  gps  provides an excellent architecture for determining location and is perhaps the canonical example of a positioning system under definitions presented in section 2.1 the worldwide satellite constellation provides reliable and ubiquitous capability and  assuming a differential reference  allows transceivers to compute their location to within 1-5 meters.1 the difficulty with gps is that it functions minimally or not at all when the receivers are indoors  the first and arguably archetypal indoor location sensing system is active badges developed at at & t cambridge.2 a small infrared beacon is worn by every person and emits a globally unique identifier every 10 seconds  a central sever collects this data from fixed ir sensors around the building  aggregates the data into a central repository  and provides an api for applications to take advantage of the data  an extension to this work used by the xerox parctab system implemented a 360-degree infrared deathstar to address the problem of ir directionality.3 many groups have explored using computer vision technology to implement a tracking system  easy living and perceptual user interfaces  pui  are two microsoft research groups working in this space  easy living attempts to outfit a home environment with stereo vision technology.4 the pui group focuses on enhancing desktop applications with extra input provided by inexpensive camera technology often present on consumer pcs.5 vision system are perhaps the canonical example of tracking systems using our definition from section 2.1 the objects seen by the cameras do not usually participate in the location computation  another group at microsoft research has developed a building wide tracking system based on wavelan wireless networking technology  their system leverages the signal strength and signal to noise ratio available from the wavelan network interface 2 card  nic  and triangulates 2d position within a building using either empirical data or a mathematical model of indoor radio propagation  advantages of this approach are that it requires very few basestations and uses the same infrastructure that provides general wireless networking in the building  the difficulty is that the object being tracked must support a wavelan nic  which may be impractical on small or power constrained devices  in addition  it is not trivial to generalize this approach to multi-floored buildings or three dimensions  the system can place objects to within 3 meters of their actual position with 50 % probability.6 pinpointco sells a commercial product called 3d-id to perform indoor location tracking based on rf code and phase.7 3d-id is similar to both our work and the msr wavelan system  it had decent accuracy and is somewhat scalable but has the disadvantage of being very expensive  at & t cambridge has more recently developed an ultrasonic tracking technology augmenting the previous generation active badges to provide more accurate positioning in certain circumstances  users and objects are tagged with bats that emit periodic ultrasonic signals to receivers mounted throughout the ceiling  this system is very efficient and has the added benefit of being able to extract orientation information in addition to basic position data.8 unfortunately  using ultrasonics in this way requires a very large fixed infrastructure throughout the ceilings and is rather sensitive to the precise placement of the ceiling sensors thus its scalability is questionable  the us federal communications commissions e911 initiatives call for wireless phone providers develop a method to effectively locate phones placing emergency 911 calls.9 these rulings have spawned many companies investigating technology to determine location using the cellular telephone infrastructure because in addition fcc compliance  cell phone location will enable new valuable services  for example  a user could query his wireless telephone to request the nearest gas station  post office  movie theater  bus  pr other such service  various rf techniques including angle of arrival to the antenna array  signal attenuation  and time stamping as well as established technologies such as gps are being employed in this space  these approaches differ from our work in that they are not focused on fine-grained positioning nor do they address the indoor environment in particular  there is also a large body of existing work in location tracking in support virtual reality and animation motion capture  technically  many of these systems can provide valuable insight into developing similar systems for ubiquitous computing  for example  it has been shown that cdma-like radio technology can be used for precise position tracking  on the order of 2mm grain size  for virtual environments.10 however  three important issues separate location sensing for invisible computing from most of these systems  first  these systems are often quite expensive and thus not readily deployable in the ubiquitous sense  but more important then cost  many of these systems are not designed to be scalable even to a building wide level they are designed to capture position well in a single room immersive environment  finally  vr and animation tracking systems usually do not incorporate sensitivity to the privacy of location information nor do they provide a general management architecture enabling many diverse applications to leverage the location data  our idea to develop a fine grained tagging technology based on rf signal strength is most similar to the msr wavelan and the pinpoint systems  however laboratory 3 experiments indicate that we can achieve better resolution and accuracy then the msr system with a much lower cost then the product from pinpoint  furthermore  we believe accuracy and efficiency could be enhanced even further by the addition of sensor fusion techniques such as integrated accelerometers and online building maps  3 rfideas experiment spoton began with a question  why build custom tag hardware if suitable components already exist in the commercial market ? a search led to an illinois company called rfideas and their air id product  air id is an adjustable long range active id badge  reader and software solution for desktop computers  featuring hands-free login  automatic desktop computer locking based on the user 's proximity and read/write memory in the air id badge.11 figure 1  rfideas badge  left  and basestation  right   air id boasts a simple rs232 basestation protocol and a signal strength measurement with multibit accuracy  thus  although it is designed for workstation auto-logon  we felt that perhaps the rfideas setup could be used in a different way to provide signal strength measurements in our more robust location-sensing architecture  3.1 air id analysis the first step was to perform a simple experiment to determine if it was reasonable to believe that air id could provide the signal strength data required and warranted further investigation  the experiment was setup as follows  1 in a large indoor space  a single basestation transmitter is placed at a central point in the room connected to a laptop running our measurement and logging program  2  12 badges are placed in a concentric circle of a known radius surrounding the basestation  3 several signal strength measurements are taken and logged  4 all badges are moved to slightly increase  by approximately 1 foot  the radius of the circle around the basestation  4 5 steps 3 and 4 are repeated until the majority of the badges are out of range of the basestation  figure 2 below summarizes the results  the badge average data points are the average of all twelve badge signal strength measurements as distance from the basestation increases and are in abstract units  as expected  the signal strength drop-off roughly obeys an inverse square drop-off as distance from the basestation increases  the variations are most likely the result of signal reflection and interference inherent in an indoor environment  in addition  we found that badges were fairly uniform and consistent in their signal strength none seemed to report consistently above or below average signal strengths nor did they drift widely over time  4.50 signal strength 4.00 3.50 3.00 2.50 2.00 1.50 1.00 0.50 0.00 0 5 10 15 distance from base  ft  badge average inverse square stddev figure 2  rfideas signal strength results admittedly  this experiment is very simple  however  these basic results were sufficient evidence for us to believe it might be possible to use air id in the construction of a location sensing system  5 3.2 concept the location sensing architecture we set out to build is conceptually simple even though the algorithm implementation is certainly nontrivial  multiple basestations provide signal strength measurements mapping to an approximate distance  a central server then aggregates the values to triangulate the precise position of the tagged object  finally  the computed object positions are published to client applications  base object o base base figure 2  location sensing concept 3.3 implementation implementation of the prototype system required development of an architecture supporting the air id components in a flexible manner  the following sections summarize our experience in several areas  3.3.1 internetworking air id basestations support only rs-232 serial connections  this is clearly a limitation since such cabling is not ubiquitous  has limited run length  and the number of physical serial ports on the server may be limited  in addition  given the need to precisely mount the air id basestations in the environment  they should not depend on the proximity of the controlling server  it would be far more flexible to have basestation connectivity over arbitrary distances and configurations  the hydra microwebserver12 can solve this problem without any modification to the rfideas hardware  6 ethernet rs-232 serial figure 3  hydra microwebserver hydra has both an ethernet and serial port in a small form factor and thus is ideal for the air id internetworking task  a custom driver for the hydra allows pass-through operation of air id commands from the ethernet to the serial port with the addition of some caching and optimization  for example  although the air id basestation protocol requires acknowledgement of each step of a command from the controlling server  the entire sequence can be sent to the hydra in one packet  the hydra then handles the acknowledgements with air id locally  the following figure depicts the overall internetworking architecture allowing a heterogeneous mix of network and serially connected basestations  rs232 server basestation object tag ethernet object tag hydra microwebserver object tag basestation figure 3  architectural illustration 7 3.3.2 aggregation algorithm a straightforward hill-climbing algorithm attempting to minimize signal strength error relative to empirical data is used to compute the location  the algorithm works as follows  1 choose a random coordinate position s and constant distance m 2 for each of the 6 possible points p located m units in the primary xyz directions  do the following  a compute a prediction vector vp of signal strength values based on the distance d to each basestation from point p using equation 1 derived from empirical data  b compute an error vector ep where each element of ep is a difference of squares of the predicted and observed signal strength values  3 s < = p where ep is less than the current minimum error value  4 when s does not change then return s equation 1 is the function based on empirical data mapping distance to a basestation  d  to a signal strength estimate  ss   note that ss is in abstract units  ss = 0.0236 * d 2 0.629 * d + 4.781 equation 1  signal strength from distance computation the move distance m is chosen to be a constant small value mapping to approximately 6 inches of distance  an easy optimization to this algorithm is to choose s to start at the last computed position instead of at random with each new location computation  3.3.3 server as mentioned in section 3.3.1  the air id interface has been abstracted away to allow connectivity over both rs-232 and ethernet via the hydra microwebserver  in fact  both of these protocol implementations are instances of a generic api such that it would take little effort to support other control mechanisms such as usb or a short-range radio technology  the location computation algorithm is similarly designed and it would be trivial to replace the algorithm we presented in section 3.3.2 with another method such as simulated annealing  in this prototype system  we only publish the immediate location state of objects in the field of view for use by client applications  there is no data store or time sequence analysis  moreover  client applications must conform to a fixed api defined by the server  while these limitations are clearly not desirable in a robust location sensing system  they are quite acceptable for this prototype in proof of concept  3.3.4 visualization client a visualization client provides display of the computed location data  this client application aided development and allows demonstration of the prototype  it is built on an opengl codebase developed by zoran popavic for a subdivision surfaces rendering 8 system.13 it has intuitive mouse-based navigation for pan  tilt  zoom  and 3-axis motion  figure 4 shows a screen capture  the grid represents the physical room  the large ball is the probable position of the sensed tag  the lines are the signal strength measurements  and the small ball trail is the path taken by the convergence algorithm  figure 4  visualization environment 3.4 results the prototype air id location system we built can determine tag location in a semi-reliable manner  however  limitations are significant  first  although the system is certainly adequate for some applications such as automatic room light control  the overall accuracy is much poorer then desired  objects can only be fixed to a position voxel about 3 meters on a side  therefore  for small rooms  this prototype system is not much better than a rudimentary motion sensor  albeit one that could recognize the moving object by name   the coarseness is certainly a result of the mere two bits of signal strength accuracy provided by air id  rfideas promised next generation air id hardware with 8-bit accuracy but it was not available during the time of this work  the second problem is measurement frequency  since the air id protocol is not designed for the location-sensing task  even using the api efficiently on a multithreaded server still requires 10 to 20 seconds to take one location measurement from all relevant basestations  it is very easy to miss significant changes in position of the tags as they come and go with such a slow sample rate  although the signal strength measurements presented in section 3.1 were promising  one might ask why the attempt was made to build a full system using air id when it may have been reasonable from the outset to conclude that two bits of accuracy  although we were working with rfideas for an 8 bit prototype  and a wrapped api were too limiting  the answer comes in two parts  first  other then the development labor  using the rfideas product is a relatively low cost solution they are inexpensive off-the-shelf components  second and most important  building the air id based prototype gave first hand experience in the location sensing problem space and highlighted the critical design parameters  then  using this practical experience we could construct new custom hardware much more optimized to the task  9 4 new custom hardware the rfideas prototype captured key parameters required in a well-designed location sensing system based on rf signal strength  it should provide a precise signal strength measurement probably at least 8 bits of resolution  it should be able to attenuate transmit power in a predictable manner  it should allow location sampling at a rate of 1-2hz or better  it should consume very little power  it should have sufficient memory and cycles to permit basic caching  authentication  or other such tasks  this figure presents the new spoton tag radio architecture we developed to address these issues  radio transceiver rx integrator/ peak detector a/d converter tx data xmit power adjuster processor signal strength figure 4  hardware rf architecture 4.1 lab prototype the first step was to choose a radio transceiver and attempt to develop a method of accurately and reliably capturing the rf signal strength  using the rfmonolithics tr1000 transceiver development boards  we prototyped several signal strength analysis circuits before settling upon one that is robust  efficient  and accurate to the degree desired  lab tests also suggested it was reasonable to believe that a single hardware architecture could act as either a basestation or an object tag with only a difference in peripherals and the form of the packaging  10 4.2 spoton tag hardware specification once the lab prototyping was complete  we built a custom development board  the following laundry list describes the hardware and a photo of the spoton board is shown in figure 5  1 rfmonolithics 916.5mhz tr1000 radio transceiver 2 custom signal strength analysis and rf attenuation circuitry 3  10-bit a/d converter for signal strength capture 4 dragonball ez  68k  microprocessor 5  2 axis mems accelerometer 6  2mb dram  2mb flash 7 rs-232 port  for development only  8 very low power  operates on 2 li coin cells  9 power boost regulator 10 piezo audio speaker and 4 general purpose buttons figure 5  custom development board 4.3 cost analysis figure 6 presents a breakdown of the component cost for the spoton board  note that the printed circuit board and its associated manufacturing costs are omitted from this chart  the total hardware component cost is around $ 120 but is estimate to be closer to $ 30-40 after revision to omit features only needed for development and assuming manufacturing in quantity  11 accelerometer 17 % batteries/holders 3 % db9 connector 4 % fuse jumpers 1 % 3 % leds 8 % dragonball 10 % resistors/caps/d iodes 16 % dram/flash 12 % switches 2 % tr1000 10 % misc ics 6 % power regulator 1 % piezo speaker 3 % buttons 4 % figure 6  cost breakdown of the spoton board 4.4 power consumption a basic power consumption analysis on the spoton board has been completed to quantify the power requirements of various components and operations  the results are presented in figure 7 consider these numbers as upper bounds because the development board is optimized for debugging and not power efficiency  in the present design  two lithium coin cell batteries provide approximately 180mah each implying about 10 hours of normal operation  even with careful power saving techniques  this battery life is less than desirable  therefore  the next hardware revision may increase the number of coin cells or move to larger cells such as aaaa  12 power consumption analysis 49.5 50.7 continuous rf transmit continuous 2mhz a/d conversion 50 43.8 40 25.6 30 10 0.1 1.49 none 20 none w/ -l dram  predicted  current  ma  60 5.62 9.1 15.64 12.53 20.3 doze  sleep  mode 1/32 burst mode accelerometer polling audio playing rs232 exchange dram writing while  1  loop rf receive simple key polling 0 full power system state figure 7  power consumption of the spoton board 4.5 status and goals the firmware is nearly complete  a hardware revision to remove features only used for development  make minor design adjustments  and shrink the board to tag size will occur shortly  one possible idea is to implement an interface and form factor so that spoton tags can function in a compact flash  pcmcia  or a similar generic card slot allowing many devices to plug in spoton and easily integrate location-sensing ability  in any case  spoton tags would certainly also work standalone  lab experiments with the new hardware seem to indicate that sub 13 meter voxel location sensing accuracy should be possible but since the actual development is still in progress  there are no hard numbers to back up this claim at present  5 applications fine-grained location information would enable applications not readily possible by other means  although this is not an applications paper per se  we can nonetheless briefly speculate about a few possibilities  precise positioning info could be used to dynamically track people and mobile objects in real time within a space such as by a camera  lighting instrument  or laser pointer  this could be valuable for surveying security sensitive articles or perhaps by a multi-camera cinematographic video conferencing system  spoton tags may also be useful in much more esoteric applications such as presentations  film  or theater production  one could imagine a historical marker system by which interesting information or anecdotes could be placed around a site and retrieved dynamically as location aware objects and people travel through a space  for home automation  various consumer electronics and household 13 appliances could present their interface or take action based on the location of people or other tagged objects  the application we are currently developing at the university of washington is one for migrating mediated audio  location-sensing technology such as spoton tags allow multimedia streams to follow roaming users through different mediacells  the content is mediated when multiple users come together in the same space  6 future work although developing the spoton tagging technology for fine-grained location sensing is an important contribution  location sensing as a field is ultimately about data integration and sensor fusion  although a system such as spoton may provide very accurate location information of a particular type  it alone is almost certainly not the ultimate solution in the problem space  any robust and scalable location sensing architecture needs to develop a data model to characterize the notion of location as described by a heterogeneous mix of sensors  for example  a complete system may use spoton tagging technology supplemented with the onboard accelerometers  wide area gps receivers  and perhaps a simple software agent to determine when a person is typing on a keyboard  here is a brief taxonomy of several location data types that should be successfully representable in a general location model  1 absolute systems that provide conclusive position data in the form of coordinates  latitude and longitude  etc  spoton  properly configured  and the gps satellites are two examples  2 relative location data generated from a relative sensor is comparative to another sensor but it alone does not yield an absolute location measurement  many systems including spoton can be used to provide relative location data instead of or in addition to absolute positions  3 anonymous traditional motions sensors produce anonymous data  as does the keyboard agent previously mentioned  at least in the basic case   the sensor is aware that someone or something is present but their id is unknown  anonymous data is also generated if the user of a positioning system chooses not to reveal his or her identity to the infrastructure in the interest of privacy or security  4 symbolic this type of data does not have a geographic form  although it can often be mapped to such a form with another step  the canonical example is the event indicating someone is typing at a particular keyboard and the machine name or ip address is known but its precise geographic position is not  5 motion the key ingredient in motion data is the addition of the fourth dimension  time  accelerometers and radar speed measurement systems both provide direct measurement of motion data such as speed and acceleration  motion data can also often be derived by aggregating other data such as relative position information over time  motion is arguably an orthogonal issue and perhaps not a distinct data type  but we include it in this list anyway because it is certainly an essential part of a robust location-sensing system  assuming such a general location representation model can be developed  several important issues then need to be addressed  for example  which sensor fusion techniques are best suited to populate the model in different circumstances ? how do 14 concerns such as grain-size variability or inconsistency from different location sensing sources influence the model and data-store design ? how do privacy and security concerns associated with exploiting location information in applications influence the model ? how can location-sensing data be best managed and integrated into a larger context-aware architecture or is this not necessary ? finally  what applications do real users want from a location sensing system ? 7 conclusions this paper has presented the background and development of spoton a finegrained indoor location sensing system based on rf signal strength  spoton tags are custom devices that operate standalone or potentially as a plug in card enabling larger devices to take advantage of location-sensing technology  they are low power  small form factor  and can be located with sub 1m3 voxel accuracy  yet still have enough processing power for caching  authentication  and other such tasks  we believe that spoton tagging technology offers several advantages over existing systems and  when combined with a general location data model  will be a key component in the next generation of calm and invisible computing  8 acknowledgements the work presented in this paper was completed over the course of summer 1999 working with roy want  marshall bern  and frank vest at xerox parc and during autumn 1999 and winter 2000 at the university of washington working with gaetano borriello and the portolano research group  thanks go to all of these folks for their valuable insight and assistance  1 starlink incorporated  dgps explained  http  //www.starlinkdgps.com/dgpsexp.htm  1999 r want  a hopper  v falco  j gibbons  the active badge location system  acm transactions on information systems  vol  40  no  1  pp  91-102  january 1992 3 r.want  b.schilit  n adams  r gold  d goldberg  k petersen  j.ellis  m weiser  the parctab ubiquitous computing experiment  book chapter  mobile computing  kluwer publishing  edited by tomasz imielinski  chapter 2  pp 45-101  isbn 0-7923-9697-9  february 1997 also available as xerox b & w  march 1995 p95-00050  4 microsoft research  easy living  http  //www.research.microsoft.com/easyliving/  1999 5 m turk  moving from guis to puis  proc  fourth symposium on intelligent information media  tokyo  japan  december 1998   also microsoft research technical report # msr-tr98-69  6 p bahl  v n padmanabhan  user location and tracking in an in-building radio network  microsoft research technical report  msr-tr-99-12  february 1999  7 pinpointco website  http  //www.pinpointco.com/  1999 8 a harter and a hopper  a distributed location system for the active office  ieee network  january 1994 9 federal communications commission  enhanced 911  http  //www.fcc.gov/e911/ 10 bible  s.r  zyda  m and brutzman  d  1995   using spread-spectrum ranging techniques for position tracking in a virtual environment in the proceedings of the 1995 workshop on networked realities  boston  ma  october 26-28  1995  11 rfideas website  http  //www.rfideas.com/  1999 2 15 12 j.h  kang  k partridge  hydra microwebserver  http  //www.cs.washington.edu/research/portolano/hydra/  1999 13 zoran popovic  motion transformation by physically based spacetime optimization  ph.d thesis  carnegie mellon university 1999  16 