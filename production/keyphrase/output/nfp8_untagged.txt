self-calibrating rssi-based indoor localization with ieee 802.15.4 paolo barsocchi  stefano lenzi  stefano chessa  member  ieee isti-cnr  computer pisa research area  via g.moruzzi 1  56124 pisa  italy science department  university of pisa  largo b pontecorvo 3  56127 pisa  italy abstractthe received signal strength indicator  rssi  based localization techniques are attractive because of their simplicity  since rssi has become a standard feature in most wireless devices  rssi-based localization techniques does not require additional hardware  and does not have a significant impact on local power consumption  sensor size and thus cost  the path loss exponent  and the wall attenuation factor are the key parameters in the distance estimation based on rssi  existing techiniques  exploit both rssi and distance measurements to calibrate the parameters  this procedure is very expensive in terms of time as it requires human intervention  in this paper we propose a selfcalibration procedure which only exploits the measurements of the rssi between pairs of anchors  in particular we propose two heuristics for self-calibration and we evaluate their performance with respect to an ad-hoc calibration campaign by performing measures in an indoor environment with an ieee 802.15.4 sensor network  index termsieee 802.15.4  indoor localization  selfcalibration  rssi  i i ntroduction context-aware systems unobtrusively assist people by predicting their needs  this prediction is often based on context information acquired from the environment  to this purpose they can exploit wireless networks of sensors  1  placed in the environment or on the users themselves  the first efforts to introduce context-awareness have been related to the localization of users  2    3    4    5   and up to now localization is still one of the main building blocks of context-aware systems  the general solution based on global positioning system  gps  is unfortunately available only in outdoor environments  in indoor environment a viable solution to localization of users exploits wireless sensor networks  sensor network-based solutions estimate the  unknown  location of mobile sensors  placed on the users  with respect to a set of fixed sensor  called anchors   whose position is known  by estimating the distances between the mobile node and a set of anchors  once these distances are known a standard multilateration technique  1  or other methods  12  can be used to determine the mobiles position  this means that the localization problem reduces to the determination of the distances between arbitrary pairs of sensor nodes  these distances can be estimated using a number of inter-sensor measurements techniques  which can be broadly classified into three categories  received signal work founded in part by the european commission in the framework of the fp6 projects persona  contract n 045459  and intermedia  contract n.38419  strength indicator  rssi   angle of arrival  aoa   and propagation time based  tof   among them  rssi-based localization techniques have received considerable research interest  6    7    8    9  as they do not require complex hardware  in  8  the authors suggest that algorithms that estimate distances between two wireless devices based on their reciprocal rssi are unable to capture the myriad of effects on signal propagation in an indoor environment  nevertheless  in  6  the authors have shown that despite the reputation of rssi as a coarse method to estimate range  it can achieve an accuracy of about 1m rms in a testbed experiment  fading outliers can still impair the rssi relative location system  implying the need for a robust estimator  a method to improve the quality of localization exploiting a number of rssi measurements averaged in a time window to counteract interference and fading has been proposed in  7   the radar system  10  uses the rssi for determining the distance to known anchors  in an offline phase  a centralized repository  database  of signal strengths at various positions with respect to a set of anchors  is built  during the online phase  the best fit of transmitters rssi to the existing data in the repository  is used for obtaining a location  radar is capable of estimating the location of a mobile user to within a few meters  cricket is another localization system  11  that uses a combination of radio and acoustic signals to estimate the distance to known anchors  cricket can achieve a location granularity of 1.2 meters x 1.2 meters  although  previously study shown that rssi-based localization techniques can only provide a coarse location estimate  they are attractive because of their simplicity  since rssi has become a standard feature in most wireless devices  rssibased localization techniques require no additional hardware  and do not have a significant impact on local power consumption  sensor size and thus cost  the distance estimation techniques exploiting rssi rely on a radio propagation model  in indoor environment these models also take into account parameters such as the wall attenuation factor  waf  and floor attenuation factors  faf  to model the effect of walls and floors on the radio waves  unfortunately  rssi is environment dependent  moreover in indoor environments  the wireless channel is very noisy and the radio frequency signal can suffer from reflection  diffraction and multipath effect  which makes the signal strength a complex function of distance  to overcome these problems  wireless location systems uses a priori calibration of the propagation model  the calibration works in two phases  the training phase and the estimation phase  in the training phase it is measured the rssi at a grid of points in the area of interest  and in the estimation phase this information is used to estimate the propagation model parameters  clearly  the accuracy of the calibration procedure depends on the number of points in the grid and to the number of measures taken per point  this procedure is very expensive in terms of time as it requires human intervention  which is a practical barrier to its wider adoption  in this paper we use the same propagation model proposed in  12  which we assume to be valid  and we consider a self-calibration procedure which only exploits the measures of the rssi between pairs of anchors  in particular we propose two heuristics for self-calibration and we evaluate their performance with respect to an ad-hoc calibration campaign by performing measures in an indoor environment with an ieee 802.15.4 sensor network  we show that the performance of self-calibration in terms of accuracy of the estimated distances is close to that achievable with more expensive  ad-hoc calibration procedures  and it is thus a viable alternative to simplify the calibration of a localization system  the rest of this paper is organized as follows  section ii describe the localization model used  section iii depict the indoor propagation model which we assume to be valid  section iv describe the two heurists used to calibrate the propagation model parameters  in section v we evaluate their performance with respect to the ad-hoc calibration campaign  finally  in section vi we conclude  ii  l ocalization model in this paper we assume a localization model comprising a set of anchors a =  a1  a2      an   a set of mobile nodes m =  m1  m2      mp  and a localization server l the anchors have well know position on the map  identified by the pair  xi  yi   each anchor periodically emits a beacon packet containg its identifier  the mobile nodes are those which need to be localized by the system  to this purpose a mobile node recieves the beacons from the anchors  for each beacon computes the corresponding received signal strength indicator  rssi   and sends to the localization server the pair < rssi  anchor id >  the localization server accomulates all the pairs of each mobile node and estimates the position of the mobiles exploiting a suitable propagation model  the propagation model is used to calculate the expected rssi map of the building  the rssi map is evaluated only for a grid of points  for each point of the grid with coordinates  x  y   the map provides a n-dimensional vector s  x  y  rn defined as s  x  y  =  s1  s2      sn  where si is the expected rssi value from anchor ai  figure 1 shows an example of deployment of the anchors in a building and the grid of points of the rssi map  iii  i ndoor propagation model for ieee 802.15.4 the large-scale path loss model considered in this paper is summarized in this section  most researchers model the indoor fig  1 map of the building used for testing our localization system path loss with the one-slope model  6   which assumes a linear dependence between the path loss  db  and the logarithm of the distance d between the transmitter and the receiver  l  d  = l0 + 10 log10  d   1  db where l0 is the path loss at a reference distance of 1 meter  throught the paper we express distances in meters  and is the power decay index  also called path loss exponent   a generalization of the one-slope model is the two-slope model suggested by  13  to approximate the two-ray propagation model  the two-slope model is characterized by a break point that separates the varius properties of propagation in near and far regions relative to the transmitter  in fact  the path loss exponent changes when the distance d is greater than the break point  in particular  the authors in  13  describe the existence of a transition region where the break point b is such that  4ht hr ht hr < b <   2  where ht is the transmitter antenna height  hr is the receiver antenna height  and is the wavelength of the radio signal  however  in a typical sensor network scenario  the break point distance is hundreds of meters  therefore in practice the one-slope and the two-slope models are equivalent in indoor scenarios where the rooms are only a few square meters in size  although the one-slope model is simple to use  it does not adequately account for the propagation characteristics in indoor environments  in fact  a further generalization of the one-slope model consists in adding an attenuation term due to losses introduced by walls and floors penetrated by the direct path  l  d  db = l0 + 10 log10  d  + w af + f af  3  where f af is the floor attenuation factor  and w af is the wall attenuation factor expressed as  w af = n x ki li  4  i=1 where ki is the number of penetrated walls of type i  and li is the attenuation due to the wall of type i since the sensor devices were located on the same floor  the attenuation term due to the propagation among different floors was not included in  3   a similar model was proposed in  12   in their model they introduce a multi-wall component  this factor also includes the number of normal and fireproof doors and their status  open/closed  met by the direct paths  we observe that these parameters are important for the 802.11 based localization  due to the lower density of the access points  the anchors of the system  deployed in the indoor environment  this result in a cumebersome system to handle for the end-user  since the status of the doors need to be frequently updated  in our case we deal with a high anchor density and the anchors have a reduced radio communication range  thus the number of doors affecting direct paths is very low  for this reason we neglect the door status and we use a simplified model  iv  c alibration techniques the objective of the calibration is to adapt the theoretical propagation model to the enviroment where it is actually used  self-calibration achieves this goal without human intervention  by exploiting only information obtained from the anchors  in particular  the anchors prelimary exchange beacons to compute reciprocal rssi  the localization server uses this information to configure the parameters of the theoretical propagation model  the paramaters of the propagation model equation 3 are  l0  is the path loss at distance of 1 meter ;  the air attenuation factor ; li  the attenuation factor for the wall of type i since l0 should be estimated in a free space and it is not affected by the environment  it only depends on physical properties of the devices hardware and it can be estimated a priori  thus it is not object of self-calibration  to calibrate parameters and li we propose two heuristics  global self-calibration  g-model  and per-wall self-calibration  pw-model  comparing these with an ad-hoc calibration  hmodel   g-model assigns the same parameters for every wall  based on all rssi measures obtained from any pair of anchors  instead  pw-model provides an attenuation factor for the walls which directly affect the communication between specific pairs of anchors  and it uses global-calibration for all the other walls  the h-model  which has been used in many previous works  6    14   exploints the rssi measurements on a grid of points in the enviroment to estimate the propagation model parameters  hereafter we use the following notation  c =   ai  aj  a  ai and aj can communicate directly  ri =  aj1  aj2      ajn  is the set which contains the id of all anchors in the same room  hence  a  b  ri  a 6= b the communication between a and b is wall-free ; wn is the set of all pairs  ai  aj  such that the communication channel between ai and aj crosses exactly n wall  s  ; a global self-calibration the g-model considers a single virtual type of wall  this leads equation  3  to  l  d  = l0 + 10 log10  d  + klw  5  db where k identifies the number of wall crossed by the signal and lw is the attenuation introduced by the wall on the signal  during the self-calibration phase we can estimate all the required parameters  l0   lw   substituting d  i  j  as actual distance between anchors ai and aj  and k  i  j  as the number of wall crossed by the direct path between anchors ai and aj in equation  5   we want to obtain an estimation rssi  i  j  of actual rssi  rssi  i  j  = l0 10log10  d  i  j   + +k  i  j  lw i  j   ai  aj  c  6  rssi  i  j  the estimated differs from the measured rssi  i  j  by an error component  i  j   we assume that all are identically distributed and uncorrelated among themselves  recalling that l0 is estimate a priori  see section iv   and according to  16   the approximation of the remaining parameters parameters   lw  that minimizes the least mean square error krssi rssi k2 can be achieved by direct method  the computation cost for direct method solving a linear least mean square estimator problem is polynomial  16   b per-wall self-calibration with this technique we estimate an individual attenuation factor for each wall in between any pair of anchors belonging to c let us assume there are q different types of wall in the map of the building and let f =  f1  f2      fq  the set of attenuation factors for each type of wall  thus the equation 6 building the linear system becomes  rssi  i  j  = l0 10log10  d  i  j   + +k  i  j  lw + q x + kh  i  j  fh  i  j  i  j   ai  aj  c  7  h=1 the path loss exponent used in this equation is previusly evaluated with the g-model  instead the evaluation of paramaters lw  and fi f is achieved with the same methodology used in subsection iv-a  by means of the least mean square estimator  table i parameters and performance comparison among models v s imulation and preliminary results as observed in  12  the measured rssi is function of the path loss and of the wall attenuation factor which can estimated with the above calibration technique  furthermore  transmit powers will vary as batteries become depleted  this implies that the parameters changes during the sensors lifetime  in this section we present the results of a measurement campaign aimed at comparing the performance of the three heuristics proposed in the previous section  we performed a two phases of measurements  each aimed at  1  performing the calibration of the propagation model using the three heuristics ; 2  measuring the rssi on a grid of points in the environment  to compare the performance of the heuristics  we use the h-model as reference technique  and we evaluate the performance of the two self-calibration techniques in terms of the following formula  g = kstdclb  rssi  slf clbg  rssi  k2 w = kstdclb  rssi  slf clbw  rssi  k2  8   9  where stdclb is the function computing the distance based on the propagation model calibrated with h-model  slf clbg provides the distance by means of the propagation model calibrated with g-model and slf clbw provides the distance by means of the propagation model calibrated with pw-model  in order to gather a better view of the comparison we studied the probability density function  pdf  of the errors  based on the set of all the rssi measured between the communication from anchors to mobile  produced during the second phase of the measuring campaign  we estimated the pdf error as the frequency of the error affecting the estimated distance  in the next subsection we present the setup of our expiriment and the results of the comparison between our techniques  l1 l2 g-model 1.45 -8.96 -8.96 pw-model 1.45 -8.33 -7.30 h-model 1.46 -8.21 -6.40 as mentioned in section iv the l0 parameter can be estimated a priori as the path loss at a reference distance  to this purpose we preliminary evaluated l0 measuring the rssi between two anchors deployed at 1 meter distance  obtaing l0 = 10.06 we preliminary executed the h-model to obtain the reference parameters of the propagation model to be used for the comparison with g-model and pw-model techniques  in particular we estimated = 1.46  l1 = 8.21db  l2 = 6.4db  the parameters obtained with all the calibration methods are shown in table i during our experiments we observed the typical features of radio channels  15   asymmetrical links  the connectivity from node a to node b might be different than that from node b to node a   non-isotropic connectivity  the connectivity is not necessarily the same in all the directions from the source   and non-monotonic distance decay  nodes that are far away from the source may have better connectivity than nodes that are closer   note that non-monotonic distance decay is the main cause of localization error  b global self-calibration performance theoretical model and measured performance -6 h-model  g/pw  -model -8 -10 -12 we performed the experiments in our laboratory  it is a typical office environment with an area of approximately 7m by 10m  it has desks  chairs  cabinets  computers  monitors  etc  this environment is harsh for wireless communication due to multi-path reflections from walls and the possibility of interference from electronic devices  figure 1 shows the layout of the laboratory and the deployment of the anchors in the rooms  for the experiments we used a sensor network of 7 micaz  17  which use the chipcom cc2420 radio subsystem implementing the ieee 802.15.4 standard  the experiments consist in a set of measures between a pair of anchors or between an anchor and a point of the grid  in case of ad-hoc calibration   each measure collects 300 rssis  where every rssi is averaged over a set of 100 samples  thus every measure requires 5000 samples  each sample is obtained exchanging a beacon packet between two sensors every 1/32 second  using the highest transmission power of the micaz  rssi  db  -14 a experimental setup -16 -18 -20 -22 -24 -26 -28 1 10 distance  m  fig  2 recieved rssi measuered from the mobile node with global self-calibration  g-model  the estimated parameters are = 1.45 and l1 = l2 = lw = 8.96db  figure 2 and figure 3 show the results obtained in a single room  without the attenuation introduced by the walls  w af = 0   in particular  figure 2 shows the received power measured from the mobile  the dotted line is the h-model  and the solid line is g-model  as we can see from the figure  pdf of g inside a single room 0.08 cdf 0.3 0.07 0.25 0.06 probability probability 0.2 0.05 0.04 0.15 0.03 0.1 0.02 0.05 0.01 0 0 0.05 0.1 0.15 0.2 0.25 0 0 0.2 0.4 meters fig  3 pdf of g considering data within a room fig  5  1 1.2 1.4 pdf of w considering all the measured data table ii c omparison of the cdf of the errors 0.18 error  m  0.25 m 0.5 m 1m 1.5 m 0.16 0.14 probability 0.8 metri pdf of w in the whole environment 0.2 0.6 0.12 cdf of g 0.604 0.732 0.868 0.901 cdf of w 0.896 0.919 0.973 0.984 0.1 0.08 0.06 0.04 0.02 0 0 0.2 fig  4  0.4 0.6 0.8 meters 1 1.2 1.4 pdf of g considering all the measured data the two lines are practically overlapped due to the optimal fit of both lines  with the real path loss exponent  consecuently  the error of g-model with respect to the hmodel g is negligeble  figure 3 shows the pdf of g  it is seen that the error of g-model with respect to h-model is less than 25cm inside a single room  figure 4 shows the pdf of g for measures obtained in the whole enviroment  w af 6= 0   in this case the error is less then 1.5m in the 90 % of the cases  this results is due to the fact that the attenuation factor of both walls has been forced to be the same  consider that  from the measures in our enviroment  the h-model is affected by an error of about 1.5m  thus  the error of 1.5m of the g-model with respect to the h-model can be considered accetable since it fits the highest precision achievable in our enviroment  c per-wall self-calibration performance with pw-model the estimated parameters are = 1.45  l1 = 8.33db  and l2 = 7.3db  the main difficulty for this calibration method is due to the different number of sample used to estimate the single wall attenuation  in our case we have 5 anchors to estimate the first wall  and other 3 anchors for the second one  therefore  in order to resolve the equation  7  with the least mean square estimator  we weigh the w af parameters with a number directly proportional to the number of established links between pairs of anchors and inversely proportional to the number of anchors  figure 5 shows the pdf of w  it is seen that selfcalibration of individual walls improves the performance of self-calibration  in particular comparing the pw-model with the h-model we observed an error less than 1.5m in the 98 % of the cases  this is a significant improvement over g-model  table ii summarize the results obtained showing the cumulative distribution function  cdf  of g and w  this table highlight that the pw-model increase the performance with respect to the g-model  not surprisingly  the pw-model outperforms the g-model  due to the better accuracy in the walls modelling  vi  c onclusions and future work in this paper we considered the problem of a localization system  to estimate distances a self-calibration procedure that exploits rssi measurements between any pair of anchors  in particular we propose two heuristics for self-calibration and we evaluate their performance with respect to an ad-hoc calibration campaign by performing measures in an indoor environment with an ieee 802.15.4 sensor network  we show that the performance of self-calibration in terms of accuracy of the estimated distances is close to that achievable with more expensive  ad-hoc calibration procedures  and it is thus a viable alternative to simplify the calibration of a localization system  the proposed self-calibration procedure may have a significant impact on distance-based wireless sensor network localization where the distance is estrimated for the received signal strength measurements  r eferences  1  p baronti  p pillai  v chook  s chessa  a got ta  and y f hu  wireless sensor networks  a survey on the state of the art and the 802.15.4 and zigbee standards  computer communications  30:1655-1695  2007  2  r want  a hopper  v falcao  and j gibbons  the active badge location system  acm transactions on information systems  10  1  :91102  1992  3  g.d abowd  c.g  atkeson  j hong  s long  r kooper  and m pinkerton  cyberguide  a mobile context-aware tour guide  wireless networks  3  5   421-433  1997  4  y sumi  t etani  s fels  n simonet  k kobayashi  and k mase  cmap  building a context-aware mobile assis tant for exhibition tours  community computing and support systems  social interaction in networked communities  137-154  london  uk  springer-verlag  1998   5  k cheverst  n davies  k mitchell  a friday  and c efstratiou  developing a context-aware electronic tourist guide  some issues and experiences  sigchi conference on human factors in computing systems  pp  17-24  2000   6  n patwari  i hero  a.o  m perkins  n correal  and r odea  relative location estimation in wireless sensor networks  ieee transactions on signal processing  vol  51  no  8  pp  2137-2148  2003   7  p bergamo and g mazzini  localization in sensor networks with fading and mobility  in the 13th ieee international symposium on personal  indoor and mobile radio communications  vol  2  2002  pp  750-754   8  e elnahrawy  x li  and r martin  the limits of localization using signal strength  a comparative study  in first annual ieee communications society conference sensor and ad hoc communications and networks  2004  pp  406-414   9  d madigan  e einahrawy  r martin  w.-h ju  p krishnan  and a krishnakumar  bayesian indoor positioning systems  in ieee infocom 2005  vol  2  2005  pp  1217-1227   10  p bahl  v.n  padmanabhan  radar  an in-building rf based user location and tracking system  in proceedings of ieee infocom  tel aviv  israel  2000   11  n pryiantha  a chakaborty  h balakrishnan  the cricket locationsupport system  in proceedings of acm mobicomm 2000  pp  32-43  boston  massachussetts  2000   12  borrelli  a and monti  c and vari  m and mazzenga  f.channel models for ieee 802.11b indoor system design  ieee international conference on communications  pp 3701-3705  20-24 june 2004  13  e.green and m hata  microcellular propagation measurements in a urban environmentin proc  pimrc  pp  324-328  sept 1991  14  d lymberopoulos  q lindsey  and a savvides  an empirical analysis of radio signal strength variability in ieee 802.15.4 networks using monopole antennas  yale enalab technical report 050501  2005   15  d ganesan and b krishnamachari and a woo and d culler and d estrin and s wicker  complex behavior at scale  an experimental study of low-power wireless sensor networks  technical report csdtr 02-0013  ucla  february 2002   16  ake bjorck  solution of equations in rn  vol  1  northholland  1990  17  crossbow technology inc  http  //www.xbow.com  