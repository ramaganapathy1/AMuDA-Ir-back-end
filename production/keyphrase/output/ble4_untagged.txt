practical indoor localization using bluetooth master thesis daan scheerens january 2012 supervising committee  dr a wombacher msc  b.j  dil prof dr p.j.m  havinga faculty of electrical engineering  mathematics and computer science information systems engineering university of twente abstract localization is a problem that has been addressed using a variety of technologies  in this thesis the use of bluetooth for indoor localization is studied  the advantage of this technology over others is that it is pervasively available  is relatively cheap and has a relatively low power consumption  especially the fact that bluetooth is integrated in a wide range of mobile devices  makes its use attractive  the question being answered by this thesis is which design of a bluetooth based localization system works well for indoor environments  the context of the localization system is that of an office building in which the location of employees is tracked  the main contribution of this thesis is a practical evaluation of bluetooth as a technology for indoor localization  received signal strength in the inquiry phase of the bluetooth device discovery protocol has been identified as the most suitable localization measure  this measure  however  has the disadvantage that the sample rate is relatively low  tests have shown that at least one minute is required to collect a sufficient number of samples  because of the relatively low sample rate  accurate location estimation of moving people is not possible  to study the localization performance of bluetooth for indoor environments a number of localization algorithms were tested  these algorithms include  ecolocation  calibrated and uncalibrated log-normal shadowing model based algorithms and fingerprinting based algorithms  for each algorithm localization accuracy was computed using datasets which were collected in a test environment  furthermore  the effect of several controllable and uncontrollable parameters on localization accuracy was tested for the algorithms  the controllable parameters that were tested are  number of access points and window size  and the uncontrollable parameters that were tested are  device orientation  device height  transmitter power level and environment structure  an analysis of the effects of these parameters shows that the uncalibrated algorithms are less sensitive to the uncontrollable parameters  these algorithms  however  require more access points to achieve reasonable localization accuracy  the main conclusion of this thesis is that the uncalibrated localization algorithms are best suitable for indoor localization  this is because of the low impact of the uncontrollable parameters on their localization performance  which algorithm works the best depends on the number of access points that can detect a target  for 5 access points or less  ecolocation appears to yield the best location estimates  otherwise  the uncalibrated log-normal shadowing model based algorithm performs the best  i acknowledgements first i would like to take the opportunity to thank my supervisors  andreas wombacher  bram dil and paul havinga  especially andreas and bram have dedicated a lot of their time to support me in the process of the research  i have spent a lot of hours with both andreas and bram talking about my progress and how to proceed  initially andreas and i came up with a lot of wild and crazy ideas on how to tackle some of the problems faced with indoor localization  fortunately  bram got involved  which has probably prevented us from pursuing approaches which would not have been fruitful  it has been a good example though  showing once again that conceptually simple approaches often work best  a person that i would like to thank in particular is my girlfriend ingeborgh kloosterziel  she has given me great support during this research  apart from a lot of moral support  she has assisted me with most of the data measurements  also  in the last phase of the research  she supported me by taking care of the less pleasant housekeeping tasks such as cleaning  cooking and doing the dishes  so i could continue writing my thesis  i really appreciate all that she did for me  i would also like to thank my father  jaap scheerens  who has been so kind to check the text of my thesis for errors  furthermore i would like to thank the following people for assisting me with restructuring the layout of the smartxp lab for the data measurements  sjon berghout  mattijs jonker  fiona klaassen and alex van oostrum  finally i would like to show my gratitude to the people responsible for the smartxp lab  egbert nijland  alfred de vries and berend jan van der zwaag  who enabled me to perform my data measurements in the smartxp lab  iii contents abstract i acknowledgements iii contents 1 introduction 1.1 motivation     1.2 problem       1.3 research questions 1.4 contribution    1.5 outline       v                                                                                                                         1 1 2 3 5 5 2 localization basics 2.1 localization problem definition       2.2 signal based localization methods      2.2.1 signal strength based methods   2.2.2 time based methods         2.2.3 radio interferometric localization  2.2.4 event rate based methods      2.3 technologies                  2.3.1 dedicated localization technologies 2.3.2 localization enabling technologies 2.4 system properties               2.5 current advances                                                                                                                                                                                                                                                                            7 7 8 8 9 10 11 11 11 12 13 14 3 context 3.1 use case scenario            3.1.1 requirements          3.1.2 assumptions          3.2 test environment            3.2.1 hardware and infrastructure                                                                                                                    17 17 17 18 19 19                                                                            4 bluetooth 4.1 history                    4.2 technology overview             4.3 localization measures            4.3.1 inquiry process based localization  4.3.2 other measures                                                                                                                          23 23 23 24 24 26 5 localization parameters 5.1 controllable parameters             5.2 uncontrollable parameters            5.2.1 target device type            5.2.2 target device location and orientation                                                                                     29 29 30 30 30 v      vi contents 5.2.3 5.2.4 environment structure and layout                        localization problems                               6 localization algorithms 6.1 ecolocation              6.2 log-normal shadowing model    6.2.1 calibrated localization    6.2.2 uncalibrated localization  6.3 fingerprinting             6.3.1 mean rss           6.3.2 jensen-shannon divergence 6.3.3 inquiry response rate    6.4 comparison              31 31                                                                                                                                                                                     33 33 34 35 38 39 40 41 41 42 7 measurements 7.1 antenna orientation                 7.1.1 measurement setup for orientation     7.1.2 results                    7.2 calibration and evaluation datasets         7.2.1 measurement setup for dataset collection 7.2.2 performance bounds                                                                                                                               45 45 46 46 48 49 51        55 55 58 59 61 62 64 65 9 practical test 9.1 measurement setup                                     9.2 results                                            69 69 70 10 conclusions 73 11 future work 77 bibliography 79 a old dataset 83 b linear regression methods b.1 ordinary least squares                                  b.2 iteratively reweighted least squares                           85 85 85 c dongle orientation measurements c.1 tested orientations                                     c.2 results                                            c.3 consistency test results                                  87 87 88 88 d mobile phone test results 91 8 performance evaluation 8.1 general performance   8.2 orientation        8.3 environment structure  8.4 device height       8.5 transmitter power    8.6 number of access points 8.7 window size                                                                                                                                                                                                                                                                                                       chapter 1 introduction navigation is probably among one of the oldest problems faced by the human species  the early hunters and gatherers  after having successfully chased their prey  needed to find a way back to their camp  those people had acquired some remarkable skills in finding their way through the wilderness  such skills have now long been forgotten and only a few people remain that are familiar with them  one way people were able to navigate was using the orientation of stars on the night sky  this method has proven to be very successful at night and in the absence of clouds  however  during the day this method was useless and we are all well aware of the fact that we can not rely on clear skies  the invention of the compass was a big improvement  since it allowed people to navigate at anytime and anywhere  nowadays we have the luxury of electronics and the global positioning system  gps  has become the method of choice for navigation  in fact with our increased mobility navigation is still one of the tasks we perform regularly  some even need to do so on a daily basis  gps has greatly simplified our navigation problem and its popularity can be seen from the many car navigation systems that are being used  people using printed maps are becoming rarer every day  advances in  computer  electronics and the dynamic nature of the modern societies have also led to a desire for navigation on a smaller scale  more generally there is an increased interest in location aware services  such services adapt their functionality and processes based on their location  for example one can think of an application running on mobile phones that shows weather information for the area where the devices are located  while this application does not require a very fine location estimate  there are a lot of applications and services that would benefit from a location estimate with sub-meter accuracy  for rescue squats like fire fighters and the police  being able to locate persons in a building with an accuracy of 1 meter could make a difference between life or death  but also in less extreme cases would an accurate location estimate be really useful  for example finding your colleague in a big office building  this thesis is about localization using bluetooth technology in indoor environments  localization can be defined as the process of finding the location of an object or person  localization is thus the basis for navigation and other location aware services  bluetooth is simply one of the many technologies that could be used for localization  1.1 motivation localization was earlier defined as the process of finding the location of an object or person  the location is always relative to some user defined space  for gps this space is earth and each gps coordinate uniquely defines a location on earth  other localization system operate on a local space such as a city or building  this thesis focuses on the latter  the reason for that is quite simple  bluetooth has a limited range  using bluetooth technology for a larger scale would be cost ineffective and other technologies would be more appropriate  on the other hand localization technologies that operate on a large scale are not suitable for smaller scale environments like buildings  gps for example can not be used indoor  because a gps device requires a line of sight to at least four satellites  which is usually not possible in indoor environments  bluetooth is actually not a technology that is designed to be used for object localization  1 2 chapter 1 introduction in fact there are other technologies available which have been explicitly designed for accurate indoor localization  some of these technologies are able to achieve high location estimates with a high degree of accuracy  this raises the question what the advantage is of bluetooth over other technologies  even though this technology is not designed to support object localization it does have advantages over other technologies  which are  bluetooth is pervasively available  most mobile devices  like cell phones  pdas and laptops are already equipped with a bluetooth module  people carrying such a device already wear all the hardware which is required to localize them  many other indoor localization systems  however  require the person or object being localized to wear a special badge  this badge contains the hardware which interacts with other parts of the localization system to estimate the location of the target  using bluetooth instead of specialized localization technology thus has the advantage that the person being localized does not need to be equipped with additional hardware  bluetooth is relatively cheap  the widespread adoption of bluetooth in a large variety of devices has resulted in the availability of bluetooth chips at low prices  building a localization system using bluetooth technology can thus be done using low price  off the shelf hardware  also  since the system does not need to use tracking badges the only hardware costs stem from the bluetooth sensor network  commercial localization systems are rather expensive compared to the costs of building a bluetooth localization system  the power consumption of bluetooth modules is relatively low  the main purpose of bluetooth is to be a replacement for short distance wired data transfer  hence  it does not require a large transmission range and the bluetooth signals are transmitted at low power levels  since bluetooth is used in a lot of mobile devices  manufacturers have also put effort in producing bluetooth chips with even lower power consumption  as a result bluetooth puts less of a penalty on battery life compared to other wireless technologies  like wi-fi for example  despite the advantages of bluetooth  there are also some disadvantages  the fact that it has not been designed for object localization means that it will not be able to achieve the same accuracy as the technologies that have specifically been designed for localization  we also found that bluetooth is not suitable for real time target tracking  nonetheless  the advantages mentioned earlier make bluetooth an interesting technology for indoor localization  mainly because it can be realized with simple  off the shelf hardware  at a low cost and without having to bother people with badges that they should wear  1.2 problem the practical usefulness of a localization system depends on the context in which it will be used  in this thesis the context is that of indoor environments  more specifically the context is defined by a use case scenario for an office building  in which we would like to track to location of people inside the office  to evaluate whether a localization system is useful for a particular context  5 system properties were identified  these properties are  accuracy  responsiveness  calibration effort  adaptiveness and operational constraints  a full description of these properties is given in section 2.4 the desired accuracy of the localization system in the context of an office building is such that one would have no trouble finding a particular person in the building  for this context an accuracy of at most 5 meter is assumed to be required  although in buildings with a clear view a less accurate system will also suffice  people working in an office will not be moving around very often so the responsiveness of the system is no big issue  calibration effort and adaptiveness  however  are both more important properties  the localization system will be operational for an extended time period and during this time changes in the environment are bound to occur  some 1.3 research questions 3 of these changes may negatively affect the accuracy of the localization system  to cope with these changes the localization system needs to adapt automatically  be recalibrated or both  ideally the system adapts fully autonomously so no recalibration is required  if the calibration requires quite an effort  having to repeat this process over and over  quickly makes the maintenance of the system too cumbersome  finally the operational constraints of the system should be such that they do not hinder the people in their activities  in short this thesis is about the design of bluetooth based localization system to track the location of employees inside an office building  the desired system has at least an accuracy of 5 meters  is able to adapt to changes in the environment  requires minimal calibration effort and does not constrain the activities of the employees  the system does not need to accurately estimate the location of moving people  but it does for people who are in a stationary position  1.3 research questions based on the problem description  presented in the previous section  we would like to answer to the following main research question  which bluetooth based localization system design works well for indoor environments ? note that the term well may be a bit ambiguous  what is meant with this term is that the system is compliant with a set of minimal requirements  these requirements are specified in a later section  to answer the main question  research has been divided in the following sub questions  1 which localization measures are best suitable within the context ? bluetooth supports a number of different measures that can be used for localization  each of these measures has its own advantages and disadvantages  these advantages and disadvantages need to be weighted with respect to the context in which the localization system is to be applied  this question is answered in section 4.3  2 what are the parameters that influence localization performance ? localization performance  primarily accuracy  is affected by several controllable and uncontrollable parameters  these parameters need to identified in order to evaluate their impact on performance  this question is answered in chapter 5  3 which localization methods will be evaluated ? estimating the location of a target can be done using multiple methods  in fact  a huge number of methods exist  although most of them are variations of one another  however  each method has its own characteristics and not every method performs equally well under the same conditions  therefore a selection needs to be made of different localization methods  which will be used to evaluate localization performance  this question is answered in chapter 6  4 what is the optimal orientation between target device and access point sensors ? all antennas have a specific radiation pattern  meaning that they do not emit signals of equal strength in all directions  hence  orientation may have a significant effect on the observed values of the localization measures  therefore we wish to know if there is an optimal orientation between the antennas  this optimal orientation will then be used for collecting datasets to evaluate the effect of relative orientation of localization accuracy  this question is answered in section 7.1  4 chapter 1 introduction 5 what is the maximum localization accuracy that can be achieved ? the spatial deployment of sensors has influence on the localization results  with this information it is possible to compute a lower bound on localization accuracy for the setup used to evaluate the performance of various localization methods  this question is answered in section 7.2.2  6 how do the localization parameters affect localization performance ? there are a number of different parameters which have an influence on the location estimates  some of these are controllable  i.e  they can be set manually to a fixed state and are known to the system  others are uncontrollable  meaning they are variable and unknown to the system  to find a system design that works well for indoor localization  the effect of these parameters on localization performance needs to be evaluated  this question is answered in section 8 and is divided into the following sub questions for each localization parameter   a  to what extent does unknown device orientation affect localization accuracy ? in a practical application of the localization system  there is no control over the relative orientation between target devices and the access point sensors  we therefore would like to know how this affects localization accuracy  to see if this restricts the applicability of the system  this question is answered in section 8.2   b  to what extent do environmental changes affect localization accuracy ? within the context of indoor localization  environment changes are expected on a regular basis  these changes  which can be as simple as closing or opening a door  may affect the propagation of bluetooth signals  consequentially this influences the observed values of the localization measures and thus also influences location estimates  this question is answered in section 8.3   c  how significant is the effect of unknown device height on localization accuracy ? the goal of the system is to find the location of people in an office building  this is achieved by localizing mobile devices carried by people  since not people are of equal height and there are differences in the preferred location where people carry their device  e.g  trouser or sweater  devices can not be assumed to be on a specific height  height impacts localization estimates  because it changes the distances to the access points and it also changes relative orientation  this question is answered in section 8.4   d  how do varying levels of transmitter power affect localization accuracy ? the strength with which target devices transmit their signals is called the transmitter power level  tpl   this parameter affects the signals which are received by the sensors of the localization system and therefore may have an impact on location estimates  in an environment in which there is no control over the set of target devices  the tpl value can not be assumed constant  we therefore need to know the effect of this parameter on localization accuracy  this question is answered in section 8.5   e  what is the minimum required number of access points to achieve reasonable accuracy ? localization accuracy is expected to be a function of the number of access points  increasing the number of access points will likely also increase accuracy  however  in practice the amount of access points should be minimized  to reduce hardware  installation and maintenance costs  this question is answered in section 8.6   f  what is the minimum required window size to achieve reasonable accuracy ? another way to increase accuracy is to increase the number of samples used for estimating target locations  because the sample rate can not be increased  we need to measure for a longer period of time to increase the number of samples  this period of time  1.4 contribution 5 called the window size  is preferably small  so the system is more responsive to changes of the actual target location  this question is answered in section 8.7  1.4 contribution the main contribution of this study is a practical evaluation of bluetooth localization for indoor environments  while most work on localization provides a theoretical basis for controlled environments  this thesis assesses the consequence if there is no control over certain parameters  which influence localization performance  assuming no control over these parameters relates better to practical situations in which a bluetooth based localization system is deployed  the effect of these parameters is evaluated using a number of datasets  which have specifically been collected for the purpose of testing the influence of certain localization parameters in indoor environments  these datasets can serve as future reference data to test the performance of localization systems  1.5 outline this thesis can be divided in roughly two parts  a theoretical part  chapters 2 through 6  and an empirical part  chapters 7 through 9   the first provides background information and lays the theoretical foundations for the second part  the second part describes the measurements that were performed and gives an analysis of the resulting data in order to evaluate localization performance using bluetooth  in chapter 2 an introduction to localization is given  then the context of the bluetooth based localization system is described in chapter 3 a description of the bluetooth technology is given in chapter 4 based on the context description a set of controllable and uncontrollable parameters is identified in chapter 5 chapter 6 presents the different localization algorithms which were used for evaluating localization performance with bluetooth technology  the measurements performed and the datasets collected are described in chapter 7 a performance analysis for the different localization algorithms using this data is given in chapter 8 another performance analysis for a more realistic localization scenario is given in chapter 9 in chapter 10 the main conclusions of the thesis are presented  including an answer to the main research question  possible improvements and other suggestions for future research are given in chapter 11 to make the thesis more readable  each chapter begins with a short introduction of the topics covered by the chapter  also  at the end of each chapter a short summary is given that presents the most significant results and information  chapter 2 localization basics this chapter serves as an introduction to the localization problem  first a formal definition of the localization problem will be given  then section 2.2 gives an overview of different methods to solve the localization problem  in section 2.3 different technologies which can be used for localization are discussed  this section is followed by a listing of the most important localization system properties that determine the suitability of a system for a particular context  finally  the chapter ends with a discussion of current advances in localization using bluetooth  2.1 localization problem definition as already mentioned in the introduction  localization can be defined as the process of finding the location of an object or person  this definition may be a bit narrow  since in reality multiple objects or persons are often located by the same process at the same time  this also depends on the perspective  which can be either a single point of view or an external point of view  in the first case  the localization process is used to estimate the location of the object itself  for example a car navigation system which estimates the cars current location  in the second case  the localization process is tracking one or more target objects  for example a radar tower tracking ships near the coast  the latter thus locates multiple objects in the same localization process  the desired bluetooth based localization system in this thesis is also an example of the external point of view  formally the localization process can be defined as follows  let s denote the space in which objects are localized  consisting of a finite or infinite number of different locations  given a set of observations o in a certain time period  ta  tb  and a set of targets t  which may be derived from o   the localization process is defined as the repetitive evaluation of the following equation for a sequence of time periods  x = f  t  o   2.1  here x =  x1  x2  x3      xn  is the set of location estimates for each target  each xi in the set x satisfies xi s the function f is called the localization function  which maps a given set of targets and observations to a set of a location estimates for each target  in addition to parameters t and o  the localization function may take extra parameters  such as calibration information  which additional parameters are required depends on the localization algorithm being used to calculate the location estimates  if the set of real locations x =  x1  x2  x3      xn  for each target in the time period of o is also known  then mean localization error can be computed as follows  n e = 1x |xi xi | n  2.2  i=1 targets do not necessarily remain stationary within the time period of o  so it is not always possible to identify a single real location for a target  therefore the average of the real location within the time period  ta  tb  is taken for each target  with the definition of the mean localization error it becomes possible to quantify the accuracy of a given localization function f and set of observations o in the remainder of this thesis  mean 7 8 chapter 2 localization basics localization error will be used to describe the accuracy for localization  it should be noted that the mean localization error is not just affected by the localization function  but also by other factors including  the quality of measurements in the observation set  the number of samples in the observation set  the quality of the real target location measurements and the quality of the calibration data  the other properties of a localization system  listed in section 2.4  responsiveness  calibration effort  adaptiveness and operational constraints  can not be quantified as easily as accuracy  therefore a qualitative evaluation of these properties will be given when due  the localization function is a mathematical model to estimate the location of target objects for a given set of observations  this is the logical component of a localization system  it is implemented in a program which runs on one or more processing devices  the physical component of a localization system contains the hardware  such as sensors  network infrastructure and processing devices  which localization methods can be used in the logical component depends on the technology being used  i.e  the physical component  an overview of the different localization methods are given in the next section  different localization technologies are discussed in section 2.3  2.2 signal based localization methods most localization systems rely on signal propagation in some medium  such as air  ground or water  some exceptions to signal based localization systems are those that use accelerometer and gyroscope instruments  which can update a location estimate relatively to its previous position  these instruments can be found for example in game controllers  such as the wii remote  25   and car navigation systems  for car navigation systems  however  the instruments are used in the case gps signals are lost  e.g  when driving into a tunnel  another exception to signal propagation based systems is optical localization via cameras  where the video images are processed to detect and track objects of interest  signal propagation based localization systems use information derived from received signals to localize objects  information commonly derived from signals is the strength of the signals  the strength of the signal received by a sensor of localization system is called the received signal strength  rss   since signal strength decays exponentially over distance  rss values have a functional relation with distance  this functional relation can be used to estimate the distance of a target object to the sensor  different approaches for target location estimation using rss are discussed next  2.2.1 signal strength based methods proximity in proximity based methods the rss value is used to define a relative ordering between different sensor nodes  nodes which receive signals with a higher strength are located closer to the target device compared to nodes which receive lower strength signals  this information is used define a relative ordering of nodes based on proximity to the target  such systems do not try to make an actual estimate of the distance between the nodes and the target  instead they rely on the relative ordering to geometrically define an area in the localization space  which contains the location of the target  assuming the ordering is correct   after having identified this area  the centroid of the area is then usually taken as the estimated location of the target  the simplest proximity based localization method is to select the location of the node with the highest signal strength  however for this method to achieve high accuracy it requires a dense deployment of nodes  other methods may be able to achieve the same accuracy using a smaller number of nodes  this is the main disadvantage of proximity based localization systems  with the same amount of sensor nodes other rss methods can provide better accuracy  the advantage of these systems  however  is that they do not require calibration  two other examples of proximity based localization systems are ecolocation  29  and rocrssi  21   2.2 signal based localization methods 9 range based methods contrary to proximity  range based methods do attempt to estimate the distance between the sensor nodes and the target  this is done using a model that maps the rss values to distance  the most commonly used model is the log-normal shadowing  lns  model  16   which will be discussed in section 6.2 a model that defines the relation between rss and distance generally needs to be calibrated for the environment in which the system operates  the lns model  for example  includes two parameters which depend on the physical structure and properties of the environment and also on the transmitter strength of the targets  calibrating the model typically involves measuring the rss values at a few known distances and then fitting this data on some function that defines the relation between rss and distance  when the localization system is operational  the model is used to estimate the distance from each sensor node to the target  distance estimates are then combined  e.g  via trilateration  see section 2.2.2   to estimate the location of the target  when properly calibrated  range based methods outperform proximity based methods in terms of accuracy  4   fingerprinting both proximity and range based localization methods assume that an increase in rss corresponds with a decrease in distance  this is indeed the case if there are no noise factors  in practice  however  the environment is not free of these noise factors  noise factors may include interference from other transmitters  objects partially blocking the signal  shadowing  and multipath propagation  as a result the theoretical relation between rss and distance is not always accurate  fingerprinting approaches do not assume that a relation exists between rss and distance  but instead assume that there is relation between rss and location  this means that at a certain location the distribution of the rss values is assumed to remain constant as long as the target does not move and there are no changes in the environment affecting signal propagation  using the assumption that rss distribution depends on location  a fingerprint can be defined for each location in the localization space  this fingerprint describes the characteristics of the signal received by each sensors node for a target at the specified location  signal characteristics might be the mean rss value  the median rss value or a histogram of the rss values  all fingerprints together form a database  when the localization system is operational  finding the location of a target becomes the problem of selecting a fingerprint from the database that best matches the characteristics of signals received at that time  usually the location estimate is the  weighted  center of the top 3 or 4 best fingerprint matches  this is called k-nearest neighbour  where k is the number of best fingerprint matches which are selected  the reason for selecting fingerprints with k > 1 is that the real location of the target generally falls between a few of the fingerprinted locations  accuracy of fingerprinting based localization methods depends on the granularity and distribution of the fingerprinted location  increasing the number of fingerprints also increases the accuracy  eventually however  increasing the number of fingerprints does no longer significantly improve localization accuracy  2  17  20   with a sufficiently large fingerprint database  fingerprinting based localization achieves better accuracy compared to proximity and range based localization  this is especially true for environments which contain a lot of noise factors  a major disadvantage of fingerprinting is that it requires a large calibration effort  since each fingerprint is created by measuring the signal characteristics at a specific location  2.2.2 time based methods an alternative to rss is to measure the time of arrival  toa  of signals  signals propagate at a finite velocity which depends on the signal type and medium  radio signals  for example  propagate at the speed of light  thus for a signal to travel from the source to a sensor it takes some time  this time is directly proportional to the length of the path which the signal travels  10 chapter 2 localization basics if t0 is the time at which the signal was transmitted and ti is the time at which the signal was received by sensor i  then the length of the path is equal to  ti t0  v  where v is the velocity of the signal propagation  with three of such path length estimates the location of the transmitter can be determined using trilateration  illustrated by figure 2.1 p figure 2.1  estimated target location p with trilateration  localization using toa requires the clocks of the transmitter and sensors to be synchronized  in addition the transmitter should be able to communicate the time at which the signal was sent  t0  to the localization system  often however the clock of the transmitter can not be synchronized or the transmitter can not send the time of signal emission to the localization system  this is usually the case if one is not able to control the transmitting device because it is a localization target  a solution to this problem is to use time difference of arrival  tdoa   in which the difference of signal arrival time between pairs of sensors is used  for each pair of sensors the difference of arrival time defines a hyperboloid in the localization space on which the location of the transmitter lies  three pairs of sensors each produce different hyperboloids  which will ideally intersect in one point  the origin of the signal  because of noise and errors in the measurements all hyperboloids seldomly intersect at one point  in this case the location estimation becomes an optimization problem  localization using tdoa is called multilateration  tdoa requires at least 4 sensors where toa requires only 3 sensors  although tdoa does not require the clock of transmitter to be synchronized with the clock of the sensors  it still requires the clocks of the sensors to be synchronized among themselves  sometimes even this might not be possible for a localization system  this however can be solved using differential time difference of arrival  dtdoa   dtdoa works the same as tdoa but eliminates the need for clock synchronization by having a node in the localization system that transmits a signal which is echoed by the localization target  a sensor receives an echo request at time t1 from the transmitter node and echo-response at time t2 from the target  the difference of signal arrival time between two sensors i and j is then equal to  ti,2 ti,1   tj,2 tj,1  + ti tj  where ti and tj denote the time required for the signal travel from the transmitter node to sensors i and j these values are assumed to be known  as they can simply be computed from the distance between the transmitter node and the sensors  2.2.3 radio interferometric localization radio signals behave like waves  so at a certain location two signals create a specific interference pattern  this pattern depends on the distance between the source and receiver of the signal  when the signals are transmitted at a slightly different frequency measurements of the resulting signal at two different locations allow the computation of a linear combination of the distance 2.3 technologies 11 between nodes  because a simple description of how these distances are inferred can not be given  the interested reader is referred to  23  or  6  for a complete description of radio interferometric localization  2.2.4 event rate based methods most signals are used to transmit data from one device to another  to enable effective wireless data transfer communication protocols are needed  for example both bluetooth and wi-fi are technologies for wireless data transfer which employ a stack of protocols to enable communication  typically these protocols include mechanisms to detect errors in the received data due to signal corruption  some localization systems  22  18  have effectively used the bit error rate  ber  for localization  the ber appears to increase as the distance between transmitter and receiver increases  therefore ber has been used as a substitute for rss  allowing the localization methods discussed in section 2.2.1  proximity  range based and fingerprinting  to be applied  apart from the ber other event rate based measures can be derived from some of the communication protocols  for example  the inquiry response rate  irr  of the bluetooth device discovery protocol has been used effectively in  3  to estimate the location of bluetooth enabled devices  in section 8.1 the localization accuracy of irr compared to other localization methods is reviewed  2.3 technologies localization systems have been build using a variety of technologies  these technologies can be divided into two classes  those that have been designed for localization and technologies which were designed for another purpose but can be used for localization  technologies in the first class are called dedicated localization technologies and those in the second class are called localization enabling technologies  in this section an overview of several different technologies from both classes will be given  2.3.1 dedicated localization technologies radar radar is an acronym for radio detection and ranging  as the name implies  radar is a localization system that uses radio waves to determine the location of objects  such as ships  aircrafts and clouds  a radar installation is able to locate objects by emitting radio pulses  which are reflected by objects on the path of pulses  reflected pulses are received by the radar installation  the signal power of the received pulses can then be converted to an estimate of the distance between the radar installation and the object  radar installations use directed antennas  so the location of an object is determined by its distance from the installation and the current angle of the antenna  hence a radar system can localize objects using a single transmitter and receiver only  sonar sonar  an acronym for sound navigation and ranging  is a localization system for locating objects which are submerged into water such as fish or submarines  sometimes sonar is also used for localization of objects in the air  like radar systems  a sonar localization systems use the reflection of signal pulses to locate objects  however  instead of using radio signals  sound waves are generated  also instead of using reflected signal strength  sonar systems measure the time from pulse emission to the moment at which the reflected pulse is received  this time can be converted to a distance estimate by multiplying it with the propogation velocity of the medium  12 chapter 2 localization basics the direction of objects is determined by using multiple receivers and using the difference of arrival time to find the angle  gps as mentioned in the introduction gps  global positioning system  uses satellites  these satellites continuously send messages  using radio signals  containing the time at which the messages were send and the location of the sending satellite  a gps receiver uses the time at which the message was received to compute the travelling time of the message from satellite to receiver  the distance between the receiver and satellite can then be computed by multiplying the travel time times the speed of light  since gps messages also include the position of the satellite  the location of the gps receiver can be computed using trilateration  because gps receiver clocks are not exactly synchronized with those of the satellites  distance estimates are very rough  to compensate for these estimation errors at least 4 satellites should be in range of the gps receiver  active bat the technologies discussed so far were all designed to operate in outdoor environments and are not suitable for indoor localization  however  the active bat localization system  15  is meant for accurate indoor localization  the system works by equipping the objects to be localized with a badge that emits ultrasound pulses  receivers mounted overhead measure the time of flight of the pulses and compute the distance to the target by multiplying the time of flight times the speed of sound  with at least three estimates the system computes the location of the target using trilateration  2.3.2 localization enabling technologies gsm gsm  global system for mobile communications  is a technology for digital cellular networks  which enables telephony for mobile phones  the technology can  however  also be used to estimate the location of a mobile phone  base stations surrounding a mobile phone can measure the strength of a roaming signal emitted by the phone  with a propagation model of the radio signals emitted by the phone  the rss values measured by the base stations surrounding the phone can be used to estimate the distance to the phone  trilateration can then be used to estimate the location of the device  wi-fi wi-fi is the current standard for small scale fast wireless networks  the name is a trademark for products which use the ieee 802.11 standards family  today the technology is usually found in laptops and smart phones  one of the earliest proposals to use wi-fi for localization is the radar system  2   not to be confused with radar technology   localization using wi-fi is possible because wi-fi uses radio signals in the 2.4 ghz range and the standard allows software to query the signal strength of devices in range  this enables the use of rss based localization methods  see section 2.2.1  to estimate the location of target devices  rfid rfid is an acronym for radio-frequency identification  the technology uses radio signals to transfer the identification code of an electronic tag to a receiver  rfid tags typically use the energy from a transmitted radio signal to send a response message and thus do not need a battery  the range in which these tags can be scanned is limited  active tags  those with a battery  can be read from greater distances  localization using rfid tags is possible by using the signal strength 2.4 system properties 13 of response messages from the tags  when such information is available  the rss based localization methods discussed in section 2.2.1 can be used to estimate the location of an rfid tag  bluetooth in many ways bluetooth is a technology that is similar to wi-fi  it is also a wireless networking technology  but at smaller scale  bluetooth transmits radio signals at the same frequencies as wi-fi does  so many of the localization principles for wi-fi are also applicable for bluetooth  an elaborate discussion of how bluetooth can used for localization is given in section 4.3  2.4 system properties the practical usefulness of a localization system depends on the context in which it will be used  one of key properties that determines whether a localization system is suitable for a particular context is its accuracy  for example  it makes no sense to use gps for tracking the location of ants  even if an ant was strong enough to carry a gps tracking device  the accuracy of the location estimates would be far to low  if one really wishes to track the location of ants  a localization system with sub-decimeter accuracy is required  a bluetooth localization system is expected to be able to make location estimates somewhere in the range of 1 to 10 meters  tracking ants is not a viable option using bluetooth  but tracking people in an office building might be possible  the list below gives an overview of the other properties which determine to what degree a localization system is suitable for a particular context  these properties are used throughout this thesis as key aspects on which the performance of a localization system will be evaluated  accuracy defined as the average distance between the estimated location and the actual location of an object  i.e  the mean error in location estimates  note that when this thesis refers to a system with high accuracy  mean error in location estimates is small compared to a system with low accuracy  accuracy is thus inversely proportional to mean estimation error  responsiveness the responsiveness determines how quickly the location estimate of a moving target is updated  calibration effort many localization systems need to be calibrated to make location estimates with reasonable accuracy  the amount of effort required for the calibration process can have a big influence on the usefulness of a system  especially if a lot of effort is required  another factor of the calibration effort is whether it is a process that needs to be performed only once or repetitively  if calibration needs to be performed only once a large effort is less of a problem than if it has to be repeated over time  adaptiveness some changes in the environment may affect the localization system  the ability of the localization system to cope with these changes is called its adaptiveness  a system that is able to adapt to environmental changes can provide better localization accuracy than systems that can not adapt  an adaptive system can also prevent the need for repeated calibration  operational constraints these define under what circumstances the localization system will provide location estimates with reasonable accuracy  for example  some localization systems  15  10  require a direct line of sight to one or more base stations  operational constraints may thus limit the applicability of a localization system  an ideal localization system estimates the target location with zero mean error  updates the target location immediately if the target moves  requires no calibration  adapts automatically to changes in the environment and has no operational constraints  unfortunately  such a system does 14 chapter 2 localization basics not exist  in reality most systems make a trade-off between these properties  giving more weight the those properties that are important for the localization context  for example requiring high accuracy usually comes at the cost of increased calibration effort  in section 3.1.1 the minimal requirements for these properties are listed for the context of a localization system used to estimate the location of employees in an office building  2.5 current advances the idea of using bluetooth technology for localization is not new  because of its widespread adoption in various mobile devices  bluetooth has been an attractive technology for unobtrusive localization  this section presents some of the earlier work on bluetooth based localization systems and discusses how this thesis is related to the earlier work one of the earliest works on bluetooth based localization is that of hallberg and nilsson  14   they describe  a localization system based on a calibrated log-normal shadowing  lns  model  trilateration is used to estimate target locations  which differs from the approach taken in this thesis in which the location estimate is determined by finding the position in which the difference between expected and measured rss values is minimized  another difference is that the rss values are measured using an active bluetooth connection  similar bluetooth localization systems are described in  8  9   feldman et al   8   attempt to describe indoor signal propagation using three different models  including the lns model  the other models relate distance to rss via quadratic and cubic functions and are given by equations 2.3 and 2.4 with a set of observations the parameters for these two models and the lns model are determined  one of these models is then selected based on the least squared sum of deviations  evaluation of this method results in a mean error of 2.06 m  which is similar to results from the current study  as will be presented in section 8.1 y = c0 + c1 x + c2 x2  2.3  y = c0 + c1 x + c2 x2 + c3 x3  2.4  fernandez et al   9  recognize that signal propagation may be affected by changes in the environment and thus can invalidate calibration data  they propose a localization system that automatically updates its calibration data using fixed reference devices  similar to the automatic calibration of the lns model described in section 6.2.1 other approaches to cope with changes in the environment that affect signal propagation are presented in  13  30   although these works are based on wi-fi  the principles also apply for bluetooth  haeberlen et al   13  address the issue by introducing a linear calibration function that maps observed rss values in the online phase to rss values as they would have been observed in the training phase  to obtain the parameters for calibration function they use a history of recent observations from which they construct an estimate of the calibration parameters  yin et al   30  argue that calibration function used in  13  to adapt to environmental changes can not be uniformly performed across all locations  instead they present a new algorithm called location estimation using model trees  that is able to better cope with the non-uniform nature of the environmental changes  this algorithm is based on learning mapping functions in the training phase and dynamically computing the expected signal strength vector spaces in the online phase  the disadvantage of the latter approach is that it still requires manual recalibration  although the amount of effort is significantly reduced  a bluetooth localization system based on dtdoa is described by fisher et al  in  10   they are able to achieve a relative high accuracy with a mean localization error around 1 m this  however  requires a direct line of sight from all sensors to the target  when this condition is not satisfied  accuracy drops rapidly  so for a typical office environment this method is not practical  also  to keep the system compliant with the bluetooth specification  l2cap echo commands are used  the drawback of using these commands is that an active connection is required between the base stations and the target device  2.5 current advances 15 machine learning approaches have also been applied for bluetooth based localization  mayrhofer et al   24  use both neural network approximation and evolutionary systems structure identification techniques to infer the relation between rss and distance  of these two techniques  the neural network approximation yields the best results  the authors claim to have achieved a mean localization error of 0.1 m using this technique with 4 base stations  their data was obtained using a dataset for 7x7 grid with 0.5 m cell sizes  while this approach seems promising  the disadvantage is that it requires a lot of calibration effort  it is also unknown how well this system responds to variances in the uncontrollable localization parameters  see section 5.2   another neural network based localization system is presented by altini et al   1   the fundamental difference between the work of mayrhofer et al  and the work of altini et al  is that latter also includes device orientation  this is done by extending the target devices with a compass module  during the calibration phase of the system 4 different neural networks are created  each with a different orientation  in the online phase information provided by the compass module is used to dynamically select one of the 4 networks  although this approach can provide better location estimates in the presence of varying orientations  having to equip target devices with compass modules is not practical  the effect of device orientation is addressed by seshadri et al   28  by modeling the localization problem as a stochastic process in which the location and orientation of a target device are represented as probability distributions  estimates of these variables are computed using bayesian filtering  for each location in the radio map they collect rssi fingerprints for a number of different orientations  this approach is  however  not practical because of the large amount of calibration effort that is required  the same problem is true for the work of li et al   20   which addresses the orientation issue by averaging the rss values for different directions  for each fingerprint they record the rss values when facing north  west  south and east  the average of these values for each access point is then used to form a fingerprint  the main difference between related work and this thesis  is that this study focuses on a practical application of a bluetooth based localization system  while some of the related contributions provide possible solutions to the problems discussed in section 5.2.4  most of them only focus on a single aspect  the prespective in this thesis is different as it attempts to consider all aspects that might possibly limit a practical application of the localization system  summary this chapter has given an introduction to the localization problem in general  first a formal definition of the localization problem has been given  also a measure for quantifying localization accuracy has been presented  this measure is the mean error between estimated and real target locations  in addition to accuracy 4 other localization system properties have been described  these are  responsiveness  calibration effort  adaptiveness and operational constraints  this chapter has also given an overview of the different signal based localization methods that exist  in general the following classes of localization methods can be distinguished  signal strength based  time of arrival based  event rate based and radio interferometric based methods  for some of these classes a short description has been given as to how they work  finally the chapter also describes different technologies which have been used for localization  a broad distinction between these classes can be made based on whether they have been explicitly designed for localization  those that are  are called dedicated localization systems  while those that have been designed for another purpose but do support localization in some way are called localization enabling technologies  bluetooth falls in the latter category  chapter 3 context in this chapter the context of the bluetooth based localization system studied in this thesis is described  this context is important because it governs some of the choices that were made  a use case scenario is applied to define the context  for this use case scenario requirements are set for the localization system properties listed in section 2.4 also  a set of assumptions for the use case is given  the chapter ends with an overview of the test environment in which empirical measurements were performed to study the performance of bluetooth localization for different localization methods  3.1 use case scenario the use case scenario for this thesis is a localization system that helps people to find colleagues in an office building  the localization targets are thus people inside the building  to find the location of a specific person in the building  the user logs in on the localization system and then queries the system by either specifying an identifier for that person  the persons name for example  or by manually searching the floor plan of the building on which the locations of all persons are shown  for a person to be localized  that person is required to be carrying a device which is equipped with a bluetooth module  also bluetooth has to be enabled on the device  3.1.1 requirements based on the use case scenario description several requirements for the localization system can be defined  these requirements are based on the 5 system properties which were defined in section 2.4 as a baseline reference office this thesis considers the building in which the computer science department of the university of twente is situated  this building can be viewed as an example of a typical office building  the localization system is able to estimate the location of a person with reasonable accuracy  reasonable accuracy means here that a person should have no trouble finding another person  whether the accuracy of the system is reasonable depends on the layout of the building  in a building in with a relatively large line of sight accuracy does not need to be as high as in a building in which the line of sight is more restricted  an accuracy of 5 m is assumed to be sufficient to find someone without problem  therefore the upper bound on mean localization error should be 5 m a reasonable location estimate should be obtained for a stationary person within at least 5 minutes  although this upper bound on the responsiveness of the system is rather weak  it is sufficient for most office environments  this is because it is assumed that people in an office building will spend most of their time stationary  e.g  sitting behind a desk or in a conference room  stationary is considered here as staying within a circle of small radius  because nobody remains completely motionless within a period of 5 minutes  when it is the case that people are moving  the system does not need to estimate with reasonable accuracy  as an extra feature the system might detect that a target is moving so it can warn users of 17 18 chapter 3 context the system that the location estimate for moving persons might be off by a large amount  this is however not a requirement  calibration effort for the localization system should be minimal  since calibration effort is usually a function of surface area and office spaces can be quite large  calibration may be a tedious task  repetition of calibration is therefore especially undesirable  it is hard to place an upper bound on the calibration effort as what is acceptable depends on the particular situation and may include factors such as accessibility and labour costs  for a typical office a maximum initial effort of 5 min per 100 m2 is assumed and no repetitive calibration  the system needs to automatically adapt to changes in the environment  this is a direct consequence of the requirement that no repetitive calibration needs to be performed  changes like objects being added  removed or repositioned affect signal propagation  if the system does not account for these changes  localization accuracy will degrade  over time changes will accumulate and eventually the localization accuracy may drop below what is reasonable  therefore the localization system should be able to cope with these changes  there should be no other operational constraints than that people to be localized are required to wear a device with a bluetooth module and that bluetooth is enabled on the device  if a user does not wear such a device or has bluetooth disabled  the system will not estimate the location of the person  the reason for selecting this limited set of constraints is that it does not burden the employees in the office  having to carry a device with bluetooth is for most people not a burden  because they already do so  3.1.2 assumptions the discussion of localization using bluetooth in the next chapters makes several assumptions about the environment  these assumptions are listed below  if one of these assumptions is not true it may negatively affect localization accuracy or limit the practical application of the localization system for the target environment  note that the absence of some assumptions in the list impacts the design of the localization system  for example the list does not include the assumptions that sensors have a line of sight to the target devices or that all target devices are of the same type and model  some of these absent assumptions are so called uncontrollable parameters of the localization system  which will be discussed in section 5 the assumptions for the context of the desired localization system described in this thesis are  people are aware that in order for them to be localized they need to wear a device with bluetooth capabilities  if they do not wish to be localized they disable bluetooth on their device  people will spend most of their time stationary  in all areas of the building in which the localization system operates it is possible to install bluetooth sensors  a homogeneous set of sensors can be installed  the location of all sensors is known and the location coordinates are defined in the same reference space  the localization system operates on a single floor and will not be affected by bluetooth enabled devices on other floors  this assumption simplifies the discussion of the localization system in the subsequent sections  in practice  however  a localization system is likely to be required to operate on multiple floors  extending a localization system from single floor to multi floor is a problem which will not be addressed in this thesis  3.2 test environment 19 it is sufficient to make location estimates in a two dimensional plane  which is parallel to the floor  this means that estimates are given in x and y coordinates and there is no z  height  component  for most offices this is a reasonable assumption  since floors usually contain a single level  an example of an environment in which this might not be sufficient is a large room which contains balconies  3.2 test environment ultimately the localization system will be deployed in an office building  therefore final tests to see whether a system matches the requirements discussed in section 3.1.1 should be conducted in this type of environment  such an environment is however not suitable for initial tests  because of its size  complexity and organisational demands  therefore the tests have been performed in a smaller environment in which most of the parameters which affect localization could be controlled  this environment is the so called smartxp lab and located next to the computer science department building of the university of twente  the smartxp lab is a big room with an approximate dimension of 30 m 10 m 10 m  length  width  height   originally this room was meant to host various multi-media projects  currently it is also being used as a presentation and lecture hall  a photo of the smartxp lab is shown in figure 3.1 and a floor plan is shown in figure 3.2 figure 3.1  photo taken from inside of the smartxp lab on 19 november 2011 the smartxp lab contains three metal truss installations of which the height can be adjusted  there is also a balcony along the length of the room  in all tests the balcony was ignored and localization was only performed for targets on the ground floor  the room was also filled with various objects like tables  chairs  computers  screens  curtains and even a car  for most tests  however  these objects were moved elsewhere to clear the floor  3.2.1 hardware and infrastructure the hardware used for the experiments consisted of linksys nslu2 devices  these are small network attached storage  nas  devices  the firmware of the nslu2 devices was re-flashed with a slugos/be minimal linux operating system with ssh access  in addition to slugos/be the bluez d-bus bluetooth stack was installed on the devices  which provided an api to the bluetooth hci  each of these devices was equipped with a sitecom usb bluetooth dongle  model cn-512 v2 001 figure 3.3 shows a picture of both a nslu2 device and a usb dongle  20 chapter 3 context left truss middle truss 8m balcony right truss figure 3.2  schematic view of the smartxp lab from above  figure 3.3  linksys nslu2 device and sitecom cn-512 v2 001 bluetooth dongle the nlsu2 devices equipped with bluetooth dongle could serve a dual function  they could act either as sensor or as transmitter  in the latter case the device would become localization target  a device could not serve both functions at the same time  devices which acted as sensors  which will be called access points from now on  were connected via an ethernet cable to the university network  the access points would send their readings to a central server  via udp datagram packets  each packet contained a single tuple consisting of a time stamp  identifier of the access point  mac address of the target bluetooth device and the value of reading itself  the central server was configured to act as a relay server  which would redistribute received packets to a set of specified target computers  this allowed for easily performing tests and data analysis from various computers  summary within this thesis a use case scenario is applied to describe the context of the localization system  the use case scenario is that of an office building in which the location of people is tracked  for this scenario the most important aspect is that localization should be unobtrusive  e.g  it should not bother people  and should be simple to deploy  the system is therefore required to have no other operational constraints than the people to be localized need to carry a bluetooth enabled device  3.2 test environment 21 because office buildings typically contain a large surface space that need to be covered by the localization system  having to calibrate the system is undesirable  in order to maintain a steady level of localization accuracy  manual recalibration in particular  should be avoided since changes in environment structure are expected to occur often in minor scale but also on larger scale  though less frequent   the localization system should be able to cope with these changes automatically  people inside an office will spend most of their time stationary  so the minimum requirement for responsiveness is not that strict  the system should be able to give reasonable location estimates for stationary people only and do so within 5 minutes  a reasonable accuracy is obtained when one has no trouble finding another person using the localization system  a minimum mean localization error of 5 m is sufficient for this requirement  for simplicity it is assumed that the localization system is deployed on a single floor only and that 2 dimensional location estimates are sufficient  in addition to the context for the use case scenario  this chapter has also presented the environment which has been used for testing localization performance for various algorithms using bluetooth  this environment is a large rectangular room  which contains three metal truss installations and a balcony running along the length of the room  the balcony is however ignored in the localization tests  used hardware for localization consists of modified network attached storage devices  which were equipped with bluetooth dongles  these device could either act as bluetooth transmitters or as bluetooth sensors  in the latter case device were hooked up to the local network and the readings measured by the sensors were send to a central server  chapter 4 bluetooth an introduction to the bluetooth technology is given in this chapter  first a short history overview is given  followed by a summary of the bluetooth technology  the chapter concludes with a review of different localization measures that are available for bluetooth  these measures are reviewed with the localization context in mind and one is selected that best fits the requirements listed in section 3.1.1 based on this review an answer is formulated to researchquestion 1  which localization measures are best suitable within the context ?  4.1 history bluetooth was originally a codename for a project lead by a special interest group  sig  consisting of major companies  like ericsson  intel and nokia  the project was a cooperation between several companies to define a standard for short range wireless communication  when the sig was about to be launched  the official name for the standard was decided to be pan  an acronym for personal area networking  however just before the launch  members of the sig discovered that a trademark search on the internet for pan resulted in too many hits  this forced the sig to continue using the name bluetooth at the time of the launch  the intention was to change the name later  once the marketing group had decided on an official name  bluetooth  however  was picked up quickly by the press and thus eventually became the official name  the name bluetooth was suggested by the swedish company ericsson  which was a reference to king harald bluetooth  king harald bluetooth was a danish king living in the 9-th century and was known for uniting scandinavia  this latter achievement was the link between the bluetooth standard  which intended to unite pcs and mobile devices via a short range wireless link  19   in 1999 the bluetooth sig released the first specification of the bluetooth standard  since then several new versions of the specification have been published  the most recent version of the specification at time of writing is bluetooth v4.0  the bluetooth technology discussed in this thesis report and used in experiments are based on the bluetooth v1.2 specification  with the exception of bluetooth hs  high speed   adopted by the bluetooth sig in 2009  all bluetooth specifications are backwards compatible  4.2 technology overview as mentioned in the previous section  bluetooth is meant to enable short range wireless communication between devices  it is therefore mainly a replacement for wired communication  bluetooth uses radio signals in the 2.4 ghz range to transmit data between devices  the 2.4 ghz range is globally license free  which allows the technology to be deployed without additional license costs  bluetooth is not targeted for a specific application  but supports a multitude of applications  therefore the technology has been adopted by wide variety of devices  including computers  cell phones  headsets  pdas and cars  to support device intercommunication the bluetooth standard specifies a set of mandatory protocols which must be implemented for each bluetooth module  in addition a set of optional protocols is also specified  bluetooth enabled devices are able to query other devices for a list of 23 24 chapter 4 bluetooth their supported protocols  on top of these protocols devices can support one or more bluetooth profiles  these profiles are application specific standards that define an interface to which the devices must conform  devices can query another device whether it supports a specific profile  this enables a cell phone for example to connect to a wireless headset and use its features via the headset profile  hsp   examples of other frequently used profiles are  a2dp advanced audio distribution profile  supports streaming audio between devices  hfp hands-free profile  commonly used in cars and hands-free kits to allow people to make hands free calls with their phone  hid human interface device profile  provides support for input devices like keyboards  mice and game controllers  pan personal area networking profile  allows the encapsulation of network layer 3 packets  which enables devices to connect different networks using a bluetooth link  bluetooth is designed to support low power wireless communication  therefore one of its features is power control  this feature allows a transmitter to adjust its strength based on the rssi  see section 4.3  received from another device  with this feature transmission strength can either be increased or decreased to ensure the received signal strength is within an optimal range for the receiver  for some bluetooth devices this may lead to a significant reduction in consumed power  due to the fact that it does not always need to transmit with maximum power output  table 4.1 gives an overview of the different power classes which are defined in the bluetooth standard  power class 1 2 3 max power output 100 mw  20 dbm  2.5 mw  4 dbm  1 mw  0 dbm  min power output 1 mw  0 dbm  0.25 mw  -6 dbm   power level control mandatory optional optional table 4.1  bluetooth power classes  4.3 localization measures bluetooth has several possible measures which can be used as input data for localization algorithms  the first measure discussed is rssi during inquiry phase  which is the measure used in the rest of the thesis  section 4.3.2 reviews alternative localization measures for bluetooth  4.3.1 inquiry process based localization devices that want to communicate via a bluetooth link first need to establish a connection  a connection is established via a number of steps and is initiated by a device called the master  when a master device wishes to connect to another device the first step is to discover the devices in range  to do so the master enters an inquiry state in which it continuously sends inquiry messages at pseudo-random frequencies  during this period the master sequentially sends inquiry messages at two different frequencies in a single time slot  in the next time slot the master listens for inquiry response messages at same frequencies from the previous time slot  this process is repeated for a specified period of time  usually 10.24 seconds as recommended by the bluetooth specification  11   or until the target device has been detected  devices which are willing to be discovered  slave devices  are set to the inquiry scan state  a slave device in this state listens for inquiry messages  the slave also uses pseudo-random 4.3 localization measures 25 frequencies  but switches at a much lower rate to ensure that both master and slave eventually use the same frequency  once a slave device receives an inquiry message  it responds after a small delay with a frequency hopping synchronization  fhs  packet  the fhs packet contains among others a 48-bit mac address  which is a unique identifier of the slave device  using the inquiry process described above a master device can discover and identify the bluetooth devices in its range  if it wishes to connect to a certain device  the master waits until it receives a fhs packet with the correct mac address and then sends an additional message to synchronize both devices and to setup a connection  upon the receival of an fhs packet  the master device also determines a so called received signal strength indication  rssi  value  which depends on the power of the received signal  the host command interface  hci   an application layer interface to the bluetooth hardware controller  allows for querying for both the mac address and rssi value of the last received fhs packet via an event called inquiry result with rssi  the bluetooth specification defines the rssi value for the inquiry result with rssi event as the signal strength in dbm  11   it is an 8-bit integer in the range from -127 to +20  measuring the rssi for a specific target device  identified by its mac address  from various known locations allows the use of the rss based localization methods discussed in section 2.2.1 to estimate the location of the target device  figure 4.1 shows an example of measured rss samples in a 1 minute time period for a stationary target and two access points  the dataset from which these rss samples where taken is described in appendix a two observations can be made from this graph  first it displays that for a stationary target  the rss samples do not form a smooth flat line but instead show a high variation  for example the difference between the maximum and minimum rss value for the red line is 20 dbm  secondly it shows that the sample rate is low  about 20 samples per minute  from the complete dataset described in appendix a the average sample rate was 18.6 samples per minute for each access point and device pair  time  sec  rss  dbm  -50 -55 -60 -65 -70 -75 -80 -85 -90 0 5 10 15 20 = access point 1 25 30 35 40 45 50 = access point 2 55 60 figure 4.1  plot of measured rss samples for a stationary target and two access points  the effect of high variation in measurements is that localization accuracy may suffer  increasing the number of samples can compensate for this effect  however  since the sample rate is low  relatively large window sizes are required by the localization algorithms to achieve reasonable accuracy  real time target tracking is therefore not possible using the inquiry rssi measure  fortunately the responsiveness requirement for the target context is not that strict  so this is not an issue  26 4.3.2 chapter 4 bluetooth other measures the inquiry result with rssi event is not the only way to build a bluetooth localization system  an overview of other measures that can be used is given in  18   this overview included  link quality  lq   rssi in the connected state and transmit power level  tpl   the lq is a 8-bit integer ranging from 0 to 255 which indicates the quality of the connection  where higher values indicate a better link state  the lq can be queried via the hci  both  18  and  22  have shown that the lq is related to the distance between bluetooth devices  usually the lq is derived from the bit error rate of the received data  the bluetooth specification  however  does not specify how the lq should be measured and leaves this open to the bluetooth module manufacturer  consequently the lq can only be used for localization with a homogeneous set of bluetooth sensors  master devices   although the slave device also maintains a lq measure  it can not be used for localization  since the set of target devices is not assumed to be homogeneous  when a connection has been established between two bluetooth devices  the hci also allows for querying the rssi for the established link  like the lq this can be done at both the master and client device  according to the bluetooth specification the definition of the rssi value during connection state differs from the rssi value during inquiry state  in the connection state it is defined as how many db the rss is above upper limit or below the lower limit of the golden receive power range  grpr   a value of 0 indicates that the rss lies within the grpr  equation 4.1 shows how the rssi value can be converted to the power of the received signal in dbm  the constants tu and tl respectively denote the upper and lower limits of the grpr  rssi + tu if rssi > 0 rssi + tl if rssi < 0 p = undefined otherwise  4.1  there are three problems with using the rssi during connection for localization  first  if the rss is within the grpr  the rssi value will be zero  in that case the rss lies between the lower and upper limit of the grpr but the exact value is unknown  a second problem is that the grpr limits are not specified by the bluetooth standard and are vendor specific  the biggest problem  however  is that rssi value can be used by the other device to adjust its transmission strength  this power control feature of bluetooth aims to find the optimal transmission power so that the rss at receiver lies within the grpr  a result of this feature is that the rss at the receiver may change even if the distance between the devices does not change  due to the transmission power control feature the transmission strength during a bluetooth connection may change for the device  the transmit power level  tpl  is also a value that can be queried via the hci  but only in connected state   in  18  the relation between tpl and distance was tested  but appeared to be unusable for localization because it remained constant  all of these measures require an active bluetooth connection to the target device  the advantage of having an active bluetooth connection to a target device is that it allows for a higher sample rate compared to the sample rate of the rssi value in the inquiry process  however the number of connections that can be handled by a single device is limited  devices supporting only a single connection are not uncommon  for a localization system this means that only one sensor may receive samples from a target device  which is not sufficient to estimate the location of the target  in addition a new bluetooth connection on a mobile device usually needs to be accepted by a user  this conflicts with the design goal that the localization system should not bother people  for these reasons the lq  tpl and rssi in connected state are not viable measures for the desired localization system  another measure that uses the inquiry process is the inquiry response rate  irr   which is the number of received inquiry responses per interval  in  3  the irr of a target device for a number of sensors was used to construct a fingerprint database  localization accuracy of this approach will also evaluated in section 8.1  4.3 localization measures 27 this concludes the discussion of the different localization measures that are available for bluetooth and gives an answer to research question 1  which localization measures are best suitable within the context ? the answer to this question is  the localization measures best suitable within the context are irr and rssi during inquiry phase  summary this chapter has given an overview of the bluetooth technology  its main purpose  however  was the discussion of different measures which can be used for localization  the first measure is rssi value measured during the inquiry phase of the bluetooth device discovery protocol  according to the bluetooth specification this value is the measured signal strength in dbm for inquiry responses received by master devices  the main disadvantage of this measure is its relative low sample rate  other measures are rssi during connection state  link quality  lq   transmit power level  tpl  and inquiry response rate  irr   the first  rssi during connection state  is not a practical measure because of its loose definition in the bluetooth standard  in addition it requires an active connection to the target device  which may make bluetooth on the target device unusable for other connections  finally  a target device may adjust its transmission power during the connection  lq and tpl also require an active connection to the target device  thereby making them impractical measures for localization  little is known about irr  but earlier work has suggested that it is a measure that can be used for localization  therefore rssi during inquiry phase and irr are the most practical localization measures for the context described in chapter 3 chapter 5 localization parameters the performance of a localization system with respect to the properties discussed in section 2.4  accuracy  responsiveness  calibration effort  adaptiveness and operational constraints  depend on a multitude of parameters  first a set of controllable parameters is described  then  based on the context description given in section 3  several parameters can be identified which can not be controlled for the desired localization system  these parameters may affect localization performance  are variable and unknown to the system  at the end of this chapter a set of fundamental localization problems is derived based on these parameters  this chapter answers research question 2  what are the parameters that influence localization performance ?  5.1 controllable parameters some of the localization parameters can be set manually by either the system operator or the system itself  either way  the value of these parameters is known to the system or can be predicted  such parameters are called controllable parameters  there are three different controllable parameters for an indoor localization system based on bluetooth  these parameters are  window size the window size is the amount of time in which localization measure samples are collected for the purpose of target estimation  in general  the larger the window size  the more samples are available and thus the better the location of a target can be estimated  on the other hand  the larger the window size  the lower the system responsiveness will be  selecting the appropriate window size is thus a trade-off between localization accuracy and responsiveness  number of access points the more access points that can perceive a certain target  the more information is available for the localization system about the targets location  therefore localization accuracy increases with an increasing number of access points  however  because the range of bluetooth access points is limited  relatively much of these devices may be required to cover the entire localization space  in order to make the system cost effective and to reduce installation and maintenance effort  keeping the number of access points to a minimum is desirable  this means that the number of access points is a trade-off between localization accuracy and hardware  installation and maintenance costs  access point layout physical deployment of access points is another parameter that influences localization performance  if all access points are clustered together the system may be able to make target location estimates with relatively high accuracy close to the cluster of access points  but low accuracy estimates for the rest of the localization space  earlier studies have shown that the best deployment of access points is a uniform distribution over the localization space  for this reason access point layout is a parameter which will not be considered during the evaluation of localization performance  instead it is ensured that access points are uniformly distributed in the localization space  29 30 5.2 chapter 5 localization parameters uncontrollable parameters uncontrollable parameters are those parameters over which the system and system operators do not have control ; meaning that they are random and unknown to the localization system  therefore the system can only make weak assumptions about the possible values for these parameters  since these parameters can influence localization accuracy  a localization system is ideally designed to deal with these parameters in such a way that their impact on localization accuracy is minimized  for this reason  identifying the uncontrollable parameters is vital for the design of a practical localization system  this section discusses the uncontrollable parameters for the localization context described in section 3  5.2.1 target device type because of todays large variety of smart phones and other electronic gadgets one can not assume that all people in an office environment will carry the same type of target device  there might be companies that have strict policies about what kind of device is allowed  but in the general case the set of target devices is heterogeneous  as a result devices may have different bluetooth modules  antennas and casings  the effect of these differences is that the radio signal radiation pattern differs per device  this is because each type of antenna has its own radiation pattern  also  the casing may absorb and reflect part of the signal  the amount of absorption and reflection depends on the shape  structure and materials used for the casing  another result of the differences in hardware is devices may transmit their signals at a different strength  if noise is ignored  a sensor might measure different rss values for devices which are at an equal distance from the sensor  for example consider a scenario with two target devices and a single sensor  both devices are located at a distance of 5 m from the sensor  assuming the devices have a uniform radiation pattern and there is no noise in the measurements  the sensor might measure an rss value of 3 dbm for the first device and 13 dbm for the second device  if the system assumes both devices transmit with equal power  then according to the measured rss values  the first device is located further away from the sensor then the second device  because of this scenario  the system can not assume devices transmit with equal power  5.2.2 target device location and orientation the real targets to be localized by the systems are people  since the system can only estimate the location of a bluetooth enabled device  people need to wear such a device  one  however  does not wish to tell people how these devices should be worn  because this would be unpractical  some people might prefer to put the device in the pocket of their trouser whereas other prefer to carry it in a pocket of a sweater  this means that the location of the device relative to the human body varies  people also come in difference sizes and shapes  the system will therefore not be able to assume that devices will be carried at the same height  although the localization system does not need to make 3 dimensional location estimates  see section 3.1.1   the height of the target device does influence the measurement of rss values  consider for example a target at certain location on the floor  if the z component  height  of location coordinate changes  while the x and y components remain the same  then the distance between the target and sensors will also change  the change in height thus results in a change in measured rss values by the sensors  orientation of the target devices also plays a role in the measured rss values  this is because the radiation pattern of a device is not expected to be uniform  a non uniform radiation pattern implies that signal strength is a function of both distance and angle between the signal source and receiver  since the orientation of a device carried by a person can not be controlled  device orientation is one of the localization parameters  5.2 uncontrollable parameters 5.2.3 31 environment structure and layout another parameter which influences localization is the structure and layout of the environment in which the system operates  radio waves are influenced by the objects they encounter along their paths  the trajectory of a single wave is not just a straight line  once it hits an object it may be reflected or bend  this can lead to so called multipath propagation  there might be multiple paths from a signal transmitter to the receiver  rss values measured by the receiver are influenced by multipath propagation  because waves arriving from multiple paths could either amplify or fade the received signal  radio waves can also lose part of their energy when they hit or pass through objects  this effect is called shadowing  shadowing can also influence the rss values measured by a sensor  consider for example a radio wave beam which follows a straight path to a sensor  if an object which absorbs a part of the energy contained in the signal would be placed in this path  then the signal received by the sensor would be less strong than it was before  as a result the measured rss values will also be lower than before  both multipath propagation and shadowing influence the propagation of radio signals in the environment  the exact influence of these fading effects is a complex function of environment structure and layout  also the physical properties  like material type and surface structure affect signal propagation  it is infeasible to construct a model that can predict signal propagation with exact precision for an office environment  the reason for that is the huge number of input parameters required for such a model  this model would also need to be updated for each change in the environment  for example a door being opened or closed  5.2.4 localization problems based on the localization parameters discussed in the previous sections several problems can be identified that may negatively effect localization performance  these problems are listed below  in the next sections the impact of these problems is considered in more detail  an attempt will also be made to find methods to cope with these problems  unknown device orientation  each target device may have its own unique radiation pattern  because this pattern is not uniform in all directions  the strength of a signal received by a sensor depends on the orientation of the target device  unknown transmitter strength  differences in bluetooth hardware may result in target devices transmitting their signals at different power levels  rss samples generated by a sensor for two different devices can therefore not be related  unknown device height  since the height of a target device is one of the components that determines the distance to the bluetooth sensors  height also influences the measured rss values  unknown environment structure  radio wave propagation is a affected by the structure of the environment  without this information and the lack of an exact propagation model  the relation between measured rss values and distance can only be estimated using approximate propagation models  summary to be compliant with the requirements set for the context of localization in an office building  there are some parameters which can not be controlled  these parameters are likely to have an effect on the rss measurements and thus also on location estimates for target devices  the parameters which can not be controlled in the context environment and which have an effect on localization are  32 chapter 5 localization parameters device orientation  device height  transmitter power level of the target devices and the structure of the environment  in addition there are two controllable parameters for the localization system  these parameters are  window size and number of access points  chapter 6 localization algorithms each localization method has different characteristics and some will be able to deal with the localization problems listed in 5.2.4 better than others  to evaluate how different localization methods perform in the presence of these problems a variety of localization algorithms have been tested  this chapter answers research question 3  which localization methods will be evaluated ? at least one algorithm has been selected for each rss based localization method  these methods are proximity  range based and fingerprinting  see section 2.2.1   in section 6.1 through 6.3 these algorithms are described  based on these descriptions a qualitative comparison of these algorithms is made in section 6.4 with respect to their expected ability to cope with the localization problems and the requirements discussed in section 3.1.1  6.1 ecolocation ecolocation was mentioned in section 2.2.1 as an example of a proximity based localization method  this algorithm was chosen as a candidate localization algorithm because of its simplicity and its reasonable accuracy  the name ecolocation is derived from error controlling localization  because the authors found an analogy between the algorithm and error controlling via redundancy  a complete description of the ecolocation algorithm is given in  29   the concept of ecolocation is based on partitioning the localization space using distance constraints  a distance constraint is defined for a location in the localization space and a pair of access points  given the location of two access points ai and aj  where i 6= j  and some location x  then x is either located closer to access point i or closer to access point j the first case is represented by the constraint  ai < aj  and the second by the constraint  aj < ai   with a total number of n access points  n  n 1  /2 different constraints can be defined for a random location x figure 6.1 shows the constraint set for two locations p and q in a localization space with three access points  the individual partitions for the localization space are marked using different shadings  the set of constraints for a given location is called c a given constraint set defines a convex polygon within the localization space in which every location contained by the polygon has the same set of constraints  such a convex polygon forms a partition of the localization space  for n access points  the number of different constraint sets that can be constructed is 2n  n1  /2  since each constraint set defines a partition of the localization space  the maximum number of partitions that can be defined is also 2n  n1  /2  often  however  the actual number of partitions is less than this maximum  because for some constraint sets no location exists where all constraints are satisfied  for example the constraint set   a1 < a2    a2 < a3    a3 < a1   defines an area which does not exist in figure 6.1 the total number of partitions is therefore not only a function of n but also of the spatial distribution of access points  to estimate the location of a target device ecolocation matches the rss measurements against the constraint set for each partition  the partition for which the most constraints are satisfied is selected as the area in which the target is located  the location of the target is then estimated by taking the centroid of this area  if there is more than one partition with the highest number of satisfied constraints  the union of these partitions is taken  given an input set of rss samples for a specific target  the mean rss value for each access 33 34 chapter 6 localization algorithms a1 < a3 p a2 < a1 a2 < a3 a1 a2 a2 < a1 q a3 < a1 a3 < a2 a3 figure 6.1  ecolocation space partitioning for 3 access points  point is computed  ecolocation then uses the mean rss value to determine which constraints are satisfied  a constraint  ai < aj  is satisfied if pi > pj  where pi and pj respectively denote the mean rss value for access point i and j this rule is based on the assumption that an increasing order of mean rss corresponds with a decreasing order of distance  in most cases this assumption is valid  because received signal strength will be higher closer to the source then further away from the source  however  due to multipath propagation and shadowing  this is not always true for all locations  nonetheless  if the assumption holds for the majority of the constraints  it is still possible that the correct partition will be selected  although the location estimation part of ecolocation is straightforward  partitioning the localization is not  to determine the exact shape of each partition requires iterative splitting of polygons  while there exists methods to do so  there is a simpler approach  instead of computing the exact partition bounds  an arbitrary number of sample points are selected  for each of these points the constraint set is computed  during the location estimation phase the sample points are used instead of partitions  this results in an approximation of the partitions  note that localization accuracy does not necessarily need to be worse using this approach  with the polygon approach  the centroid of partitions is selected as the location estimate  but this is just a guess  the actual location of the target might just as well be in one of the corners  selecting the centroid is the best option if the probability of the target being in a certain location is equal for all locations within the partition  if this is not the case  then the sample point approach location estimate could actually be better  to achieve reasonable accuracy  the sample point approach requires a sufficient number of sample points and a uniform distribution of these points  6.2 log-normal shadowing model the log-normal shadowing  lns  model attempts to describe signal propagation via equation 6.1 in this model the received power p is a function of the distance d between the source and receiver  according to the model  signal strength decays exponentially over distance with n  which is called the path loss exponent  the value of n depends on the environment and is affected by multipath propagation and shadowing  in a vacuum and unbounded space the value of n is equal to 2  because there are no fading effects  for a typical office building n is expected to be > 2 because walls will absorb the signals energy  which means signal strength will decay faster compared to the vacuum and unbounded space  accurately predicating the value of n is almost impossible for all but the simplest of environments  therefore the value of n is usually acquired using empirical measurements  6.2 log-normal shadowing model 35  pd = p0 10n log10 d d0  + x  6.1  another parameter in the lns model is p0  which is the signal strength at reference distance d0  usually 1   the reference rss parameter  p0  depends among others on the antenna orientation of both sender and receiver  5  and the strength of the transmitter  this parameter is therefore typically measured for a specific device type  in an environment with a homogeneous set of target devices assuming a single value of p0 may be inaccurate  finally  the lns model also assumes that there is a random variable x  which is normally distributed with 0 mean and a standard deviation of  this variable represents the measurement error in dbm  so the variable follows a log-normal distribution  note that if the error would not have 0 mean  this would have been added to the reference rss parameter p0  a consequence of the assumption that the error follows a log-normal distribution is that measurement error get worse with increasing distance  6.2.1 calibrated localization suppose the parameters p0 and n are known for a specific environment and target device  it then becomes possible to calculate the expected rss value at a specific location using equation 6.1 for each location in the localization space a vector p can be defined which contains the expected rss value for each access point  figure 6.2 shows this vector for location r in an environment with three access points for a path loss exponent of 2.3 and a reference rss value of 40 dbm  if the actually measured rss values at location i are denoted by yi  then according the lsn model  the variance of yi pi is equal to 2  a1 =  1  1  a2 =  6  2  4.2 2.8 2.2 a3 =  2  5  35.6 r =  4  4  pr = 39.6 42.0 figure 6.2  expected rss vector for location r  p0 = 40  n = 2.3   given a set of rss measurements for a specific target device  a vector y can be constructed which contains the mean rss value for each access point  the location of the target can be estimated by finding the location in the localization space for which the expected rss values best match the measured rss values  one way of finding the best match is using the euclidean distance of the difference between vectors y and p  represented by equation 6.2 using this approach the measured and expected rss values are considered as coordinates in n dimensional space  where n is the number of access points  the shortest distance between these coordinates is the euclidean distance  if the measured values are similar to the expected values  then the coordinates are located closer than if the values do not match well  hence  the euclidean distance gives an indication of how well the measured rss values match the expected rss values at a certain location  36 chapter 6 localization algorithms x = argminky px k  6.2  x finding the value of x in equation 6.2 is an optimization problem  which can be solved using maximum-likelihood estimation  27   another approach is to use the same sample point approach as discussed for ecolocation  instead of considering the localization environment as a continuous space it is converted to a discrete space  consisting of a finite number of sample points  in that case equation 6.2 still applies  but since the set from which x can be selected is finite  x can be evaluated by computing ky px k for each sample location x there may be some loss of accuracy with this approach  but with a sufficient number of sample points and uniform distribution  the loss in accuracy is negligible  to be able to calculate the expected rss vector for a certain location  the parameters p0 and n need to be known  up until now these are assumed to be known in advance  however  these parameters depend on the type of target device and environment  and can not be predicted with reasonable accuracy  therefore the only option is to measure them  which is referred to as calibration of the lns model  calibration of the model is performed by collecting sample measurements at known locations  parameters p0 and n are estimated by finding the best fit for equation 6.1 and the measurements  finding the best fit depends on the minimization criterion being used  a criterion which is often used is minimizing 2  error variance   minimizing 2  means finding the values for p0 and n which result in the minimal variance in error between measured rss and expected rss values  finding the best fit for parameters p0 and n for this minimization criterion is expressed by equation 6.3 here n is the number of sample rss measurements  yi is the rss value for measurement i and di is the distance between access point and transmitter for measurement i the values of di are assumed to be known  since during calibration access point and measurement locations are also known   p0  n  = argmin p0  n n x  yi p0 + 10n log10 di  2  6.3  i=1 equation 6.3 can be evaluated used ordinary least squares  ols  linear regression  this is because equation 6.1 can be written in linear form + x  where = p0  = n and x = 10 log10 d ols minimizes the sum of squared vertical distances between observed samples and samples by predicted linear approximation  since variance is equal to this sum divided by the number of samples  ols also minimizes variance  parameters and can be computed efficiently using ols for a sample dataset  the order of time complexity of this computation is o  m   where m is the number of samples  this is what makes the criterion to minimize 2 attractive  an analytical method for solving linear regression using ols is described in appendix b.1  figure 6.3 shows a plot of a set of sample rss measurements and the function which best fits these data points using the minimized 2 criterion  the dataset has been collected by measuring the mean rss value for each access point at 75 different locations  at each location  rss samples were collected during a period of 10 minutes and then averaged  for this test 9 access points were installed  so the total number of data points is equal to 9 75 = 675 more details about this dataset are given in appendix a an alternative minimization criterion is to find a fit that minimizes the average error between measured rss and expected rss values  this minimization criterion is expressed by equation 6.4 evaluation of p0 and n for this criterion can be done using least absolute deviations  lad  linear regression  although linear regression based on lad looks no more difficult than ols  computing a solution is not as efficient  this is because no analytical method exists to find a solution and an iterative approach is therefore required  for this reason  the minimization criterion expressed by equation 6.4 is seldomly used in localization systems  to see if there is a significant difference in localization accuracy  both minimization criteria were tested  the iteratively reweighted least 6.2 log-normal shadowing model 37 distance  m  rss  dbm  -46 -48 -50 -52 -54 -56 -58 -60 -62 -64 -66 -68 -70 -72 -74 -76 -78 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 figure 6.3  lns model fit for rss samples  p0 = 50.2  n = 1.54  = 2.90   red dots show the measured mean rss value and the blue line shows the rss value predicted by the lns model  squares  irls  method was used in these tests to solve the lad linear regression problem  irls is discussed in appendix b.2   p0  n  = argmin p0  n n x |yi p0 + 10n log10 di |  6.4  i=1 estimating the parameters p0 and n using the minimization criterion from equation 6.3 or equation 6.4 may not result in the best localization accuracy  this is because accuracy was defined in terms of mean localization error  given a dataset of rss measurements for m different locations  the optimal values of p0 and n are defined by equation 6.5 this equation states that the optimal lns model parameters are such that if they are used to estimate the m locations in the dataset  mean localization error is minimized  the symbols xoj  ai and pi  j in equation 6.5 respectively denote the actual location j  the location of access point i and the mean rss value observed by access point i for location j unfortunately no analytical method exists to evaluate this equation  equations 6.3 and 6.4 therefore only give an approximation of the optimal values of p0 and n in practice this works well  but a different value for p0 or n may sometimes lead to better location estimates  m n x x 2 o pi  j p0 + 10n log10 kx ai k  p0  n  = argmin xj argmin x p0  n j=0  6.5  i=0 obtaining the dataset to find the lns model parameters for a specific environment is something which can be done automatically  by placing several reference devices at known locations  the access points will receive a continuous stream of rss samples  this stream can then be used to compute the lns model parameters using one of the minimization criteria mentioned earlier  the advantage of this approach is that the parameters will be updated periodically  as a result localization accuracy does not degrade due to changes in the environment which affect signal propagation  auto-calibration  however  comes at the cost of extra hardware requirements  38 6.2.2 chapter 6 localization algorithms uncalibrated localization in the previous section a localization method was presented using a calibrated lns model  while auto-calibration can cope with an unknown and dynamic environment structure it does not solve the other problems listed in section 5.2.4  unknown orientation  unknown device type and unknown height   if no calibration is required  no assumptions are made about device type and orientation  therefore a localization algorithm which does not require calibration will typically be more tolerant towards variations in device type and orientation  a localization method using the lns model which does not require calibration is described in  12   this method is based on the inclusion of a location parameter x in equation 6.3 the resulting minimization criterion  given by equation 6.6  tries to find the combination of location x  reference rss value p0 and path loss exponent n which minimizes variance between measured and expected rss values  in this equation dx  i represents the distance between the access point for measurement sample i and location x once a solution has been computed  x contains the estimated location of the target device   x  p0  n  = argmin n x  yi p0 + 10n log10 dx  i  2  6.6  x  p0  n i=1 the difference between equation 6.3 and equation 6.6 is the substitution of di for dx  i  where dx  i represents the distance between the access point for measurement sample i and location x although the difference is subtle  computing a solution for the equation is not as simple as for equation 6.3  because an additional parameter x is introduced  in  12  three approaches are given to find a solution  the simplest of these is a grid-based approach  which is similar to the conversion of the localization space to a finite set of locations  suppose the number of locations in the set of sample locations is m  then for each location xj  j = 1    m  the parameters p0 and n can be estimated using ols linear regression  with these estimated parameters the error variance 2 can be computed  the location with the lowest value of 2 is the estimated target location  figure 6.4 shows an example of how the square root of the error variance  standard deviation  varies with location  this plot was generated using the rss samples from one of the sample locations in the dataset described in appendix a  8m 0.70 1.68 2.67 3.65 4.63  dbm  5.62 figure 6.4  variation of over location for the lns model  the white cross indicates the location of the target device  figure 6.4 reveals an issue with location estimation using equation 6.6 in the plot two blobs can be observed where is relatively low ; the two blue areas on the left and right  the blob on the left contains the lowest value of  so the estimated location is not far from the actual target 6.3 fingerprinting 39 device location  2 m error   however  the blob on the right is not coincidentally  it appears for all targets located at the left or right side of the localization space  in fact all plots show that the variation of is roughly symmetrical through a vertical line at the center of the localization space  a problem of this phenomenon is that the mirror blob sometimes contains the minimum value of  when this occurs  the estimated target location is on the wrong side of the localization space and accuracy is severely decreased  note that for targets close to the center of the localization space  this phenomenon is less of an issue  because the mirrored blobs do not lie that far apart  fortunately a simple solution exists for this problem  the mirroring effect occurs due to the fact that measured rss samples are reversed on the x-axis  distance  for locations at the opposite side of the localization space  hence ols linear regression will be able to fit the data quite well using a negative value of n a negative value of n means that signal strengh increases over distance  which is physically impossible  adding the restriction that n 0 to equation 6.6 solves the problem  applying this restriction enforces ols linear regression to use a positive or flat slope  figure 6.5 shows the same plot of over varying location with the added restriction that n may not be negative  the plot now contains only a single blob of relative low values of  8m 0.70 1.68 2.67 3.65 4.63  dbm  5.62 figure 6.5  variation of over location for the lns model with restricted value of n 6.3 fingerprinting the third class of rss based localization methods is fingerprinting  which is a conceptually simple approach  measured rss samples at a certain location are converted into a fingerprint  this is done for a number of locations in the localization space and the set of fingerprints is called the radio map  construction of the radio map is often referred to as the training phase  when the localization system is operational  the online phase  fingerprints are again generated using the measured rss samples  these generated fingerprints are then matched with the fingerprints in the radio map  the location of the best matching fingerprint in the radio map is selected as the estimated location of the target device  if the set of fingerprinted locations is denoted by l then equation 6.7 gives the estimated target location  in this equation y is the fingerprint of the target whose location is to be estimated  fx is the fingerprint for location x and c is a cost function that computes the difference between fingerprints  x = argmin c  y  fx   6.7  xl a common extension to fingerprinting is k-nearest neighbour  with this extension the top 40 chapter 6 localization algorithms k best fingerprint matches are selected from the radio map  the location estimate is computed by taking the weighted average of the fingerprint locations  the k-nearest neighbour extension usually results in better localization accuracy  this is because the actual location of a target falls between fingerprinted locations in the majority of the cases  therefore the radio map fingerprints closest to the actual target location have about the same matching score  selecting the weighted average of best k matches thus yields a more accurate location estimation then if only a single fingerprint is selected  the method of constructing fingerprints from rss measurements and matching them against others depends on the representation of the fingerprint  several variations are possible for the fingerprint representations  one of the most commonly used representation is a vector that contains the mean rss value measured by each of the access points in the system  other options are vectors containing the median rss value or variation of rss for each access point  instead of representing the fingerprint with a vector they can also be represented by a set of histograms  for example one histogram for each access point which contains the distribution of measured rss values  although many different fingerprinting approaches have been proposed  empirical measurements  7  show that there is no single best approach  therefore it was decided to only test two different approaches  one with a vector based representation and one with a histogram based representation  in addition a third approach was included  which is not based on rss but instead on inquiry response rate  irr   6.3.1 mean rss the localization method described in this section is based on the radar localization system  2   radar is one of the first proposed localization methods that uses fingerprinting to estimate target locations  this method was chosen because of its simplicity  localization using mean rss fingerprinting is conceptually similar to calibrated lns model localization described in section 6.2.1 the difference lies in obtaining the vector of expected rss values px at a certain location x for the calibrated lns model these values are computed using equation 6.1 with fingerprinting the vector px is obtained directly by measuring the rss values for a target at location x once the rss samples have been collected vector px is constructed by taking the mean rss value for each access point  multiple cost functions exists for matching a fingerprint y during the online phase with those in the radio map  it was decided to use the euclidean distance  since this is how fingerprints are compared in the radar localization system  2  and because it is also being used for calibrated lns model localization algorithm  the cost function c for the euclidean distance is given by equation 6.8  where n is the number of access points  note that the square root in this function is not strictly necessary  but was included so the function accurately represents euclidean distance  v un ux c  a  b  = t  bi ai  2  6.8  i=1 an alternative to the euclidean distance is the sum of the absolute differences in expected and measured rss value for each access point  this difference is known as the manhattan distance and the corresponding cost function is given by equation 6.9 however  the manhattan distance will not be considered in the rest of this thesis  c  a  b  = n x i=1 |bi ai |  6.9  6.3 fingerprinting 6.3.2 41 jensen-shannon divergence from the rss samples collected for an access point and target device pair it is possible to construct a histogram  this is done by creating a bin for each rss value and counting the number of rss samples for each bin  according to the lns model this should result in a histogram that follows a normal distribution  because the histogram is constructed for an access point and device pair  fingerprints represented by histograms are vectors that contain n histograms  where n is the number of access points in the localization system  the cost function c therefore needs to be able to compute the difference between two vectors of histograms  the first step in doing so is computing the histogram difference for each access point  one method for measuring difference between histograms is the jensen-shannon divergence  the jensen-shannon divergence is a distance measure for two probability distributions and is based on the kullback-leibler divergence  unlike the kullback-leibler divergence  the jensen-shannon divergence has the property that it is symmetrical and bounded  equation 6.10 gives the jensen-shannon divergence expressed in terms of the kullback-leibler divergence  d  p  m  d  q  m  +  6.10  2 2 here m is the merged probability distribution of p and q  given by m =  p + q  /2  function d gives the kullback-leibler divergence for two probability distributions  this kullback-leibler divergence function is defined by equation 6.11 jsd  p  q  = d  p  q  = x i p  i  log p  i  q  i   6.11  for two probability distributions p and q which are equal  p = q  the jsd function returns 0 and for two distributions which are completely different the function returns log 2 therefore the range of the jsd function is bounded by the interval  0  log 2   because of this property the jensen-shannon divergence can be used as a measure for comparing histogram differences  this allows the set of histogram differences for two fingerprints to be viewed as an n dimensional vector  the length of this vector can then be used to compare fingerprints which are composed of set of histograms  one histogram for each access point  equation 6.12 gives the cost function for two histogram composed fingerprints a and b v un ux c  a  b  = t jsd  ai  bi  2  6.12  i=1 6.3.3 inquiry response rate the third fingerprinting localization algorithm which has been tested is based on inquiry response rate  irr   it was decided to include this algorithm to see how its accuracy compares to rss based fingerprinting  location estimation using irr fingerprints has first been proposed in  3   in this work the authors claim to have found a relation between distance and the number of inquiry responses per interval for the bluetooth inquiry phase  since the inquiry phase is used also to collect rss samples  computing the irr is as simple as counting the number of rss samples that have been collected and dividing that by the length of the time period in which they were collected  in the approach described in  3  fingerprints are represented by histograms  a bin is created in the histograms for each access point and stores the number of inquiry responses received by the access point  two fingerprints are then compared by taking the jensen-shannon divergence of the normalized histograms  the cost function is thus given by equation 6.13  where  c  a  b  = jsd  a  b   6.13  42 6.4 chapter 6 localization algorithms comparison table 6.1 gives on overview of the expected algorithm performance for the localization properties listed in section 2.4 note that the properties responsiveness and operational constraints are not included  this is because responsiveness is dominated by the rate at which measurement samples are generated  since the bluetooth inquiry phase is used  this rate can not be controlled and is the same for all algorithms  operational constraints are not included because none of the described algorithms has extra requirements  algorithm accuracy calibration effort ecolocation calibrated lns  ols  calibrated lns  lad  uncalibrated lns fingerprinting  mean rss  fingerprinting  jsd  fingerprinting  irr  ? = good = mediocre = bad adaptiveness table 6.1  overview of expected algorithm performance with respect to localization system properties  accuracy is generally best for those algorithms which need to be calibrated  since these algorithms have more knowledge about signal propagation compared to those depending on calibration  this signal propagation knowledge is contained in the calibration data  because the data is collected for a specific environment  for this reason uncalibrated lns is expected to be a little less accurate than calibrated lns  also  the jenson-shannon divergence fingerprint algorithm is expected to perform a little worse compared to mean rss fingerprinting  because  13  has shown that histogram based fingerprinting is less accurate compared to gaussian based fingerprinting  localization accuracy for irr based fingerprinting is unknown because there are no models that describe irr as a function of location and the only empirical measurements in  3  are insufficient to make any prediction about accuracy  calibration effort is best for the ecolocation and uncalibrated lns algorithms  because these do not require any calibration at all  for the fingerprinting algorithms calibration effort is worst  this is because a large number of fingerprints need to be collected in order to achieve reasonable accuracy  the calibrated lns algorithms require measurements at a few locations only  so calibration effort is somewhere in the middle  note that for these algorithms calibration effort can be significantly reduced by installing reference devices so the system can perform the calibration automatically  see section 6.2.1   adaptiveness is directly tied to the amount of calibration which is required  since signal propagation information is contained within the calibration data  changes in the environment which affect signal propagation  may cause this data to become invalid  as a result localization accuracy is expected to drop for algorithms which depend on this data  the localization algorithms discussed in this chapter can also be rated on their ability to cope with the localization problems listed in section 5.2.4  unknown orientation  unknown transmitter strength  unknown height and unknown environment structure   an overview of the expected capability of each of the algorithms to cope with these problems is given in table 6.2 little information is known about the performance of irr based localization  so the irr fingerprinting algorithm has been excluded from this overview  in general the ability of an algorithm to cope with these problems is inversely proportional to the amount of calibration required  hence  ecolocation and uncalibrated lns score the best and the fingerprinting algorithms receive the lowest score  unknown target device height is not 6.4 comparison algorithm orientation tpl height ecolocation calibrated lns  ols  calibrated lns  lad  uncalibrated lns fingerprinting  mean rss  fingerprinting  jsd  = good = mediocre = bad 43 structure table 6.2  overview of expected algorithm ability to cope with localization problems  expected to be a major problem  because the range of possible values is limited  nobody carries their phone on their head or in their shoes  so target device height has a range of approximately 0.5 to 1.5 meter  taking into account stance  differences in length of people and the location of the phone relative to the body  e.g  carried in a trouser or sweater pocket   the effect of a 1 meter variation in target device height is that it slightly affects the distance between the device and access point  hence measures rss value will be slightly higher or lower  but this change is not expected to be of much influence to localization accuracy  differences in transmitter power level are a more severe problem for those algorithms which depend on calibration  this is because the bluetooth standard defines 3 different power classes  for which the maximum transmission strength differs by about 20 dbm  see section 4.2   a 20 dbm difference corresponds to a difference in distance by a factor 10  so calibration data for a certain power class may be inaccurate for bluetooth devices from another power class  from the algorithm ratings with respect to localization system properties  table 6.1  and ability to deal with problems  table 6.2  the uncalibrated lns algorithm is expected to perform the best  its accuracy is not expected to be as high as some of the other algorithms  but it scores well on all of the other points  in the next chapters the performance of the discussed localization algorithms is evaluated using empirical measurements  summary in this section a number of different localization algorithms have been described  which could possibly be used for an indoor bluetooth based localization system  to get a good representation from the large number of different localization systems that exist  at least one algorithm from the 3 major signal strength based localization methods was chosen  from the proximity based methods  ecolocation has been selected because of its simplicity and relative good accuracy  for the range based methods  3 algorithms have been selected that are based on the log-normal shadowing  lns  model  this model is widely recognized for its good approximation of signal propagation in various environments  two of these lns model based algorithms require calibration  while the third does not  finally 3 algorithms from the class of fingerprinting localization methods have been selected  one based on mean rss vectors  one based on rss histograms and one based on inquiry response rate  irr   for these algorithms best localization accuracy is expected for the calibrated algorithms  however  the algorithms which do not require calibration are expected to be less sensitive to the uncontrollable localization parameters  chapter 7 measurements this chapter describes the measurements which were performed to collect the necessary data for the performance evaluation of the algorithms presented in the previous chapter  first the measurement results for various antenna orientations are given  which is done to test the significance of orientation on measured rss values  based on these measurements an optimal orientation is identified to answer research question 4  what is the optimal orientation between target device and access point sensors ? in the second part of this chapter  two datasets are described which have been used for the evaluation of localization performance  the chapter concludes with an estimate of expected localization accuracy for these datasets  this answers research question 5  what is the maximum localization accuracy that can be achieved ? 7.1 antenna orientation the relative orientation between the antennas of a sender and receiver has a direct influence on the signal strength measured by the receiver  5   to see how rss measurements were influenced by orientation of the bluetooth dongles used in the data collection setups  rss measurements were performed for a number of different orientations  the reason for doing so was twofold  first it gave an indication of the extent to which orientation had an influence  more importantly however  it provided data for finding the optimal orientation of the antennas for localization  3m 45 a 3m b figure 7.1  side view of a setup with one access point and two targets  to see why this is important consider the scenario illustrated by figure 7.1 two target devices are located below an access point  one at a 0 degree angle  point a  and one at a 45 degree angle  point b if the radiation pattern is non-uniform  then the value of p0 in the lns model  see equation 6.1  is a function of the angle between the antennas  suppose the devices which emit radio signals at locations a and b have a similar radiation pattern and are aligned parallel to each other  also suppose for these devices that p0 is 50 dbm for an angle of 0 degrees and 55 dbm for 45 46 chapter 7 measurements an angle of 45 degrees  with a path loss exponent of 2  the access point in figure 7.1 will measure the following mean rss values for a and b  pa = 50 10 2 log10 3 ' 40.46 dbm pb = 55 10 2 log10 p 32 + 32 ' 42.45 dbm  7.1   7.2  the example shows that even though the target at location b is located further away from the access point  a higher signal strength is measured by the access point for that target  such a situation would lead to inaccurate location estimations  therefore it is important to know for which orientation this effect does not occur or is minimal  another aspect of the optimal orientation is the maximum received signal strength  the reason for trying to maximize the measured rss values is that it increases the range up to which access points can detect target devices  7.1.1 measurement setup for orientation to discover the optimal orientation of the bluetooth dongles used in the test environment  rss values were measured by a single access point for a number of different orientations  this was done by placing 4 target devices 1 meter away from an access point at different angles  figure 7.2 shows a schematic view of the setup  note that only positive angles were tested  this was because of the limited material that was available at the time of the experiment  assuming that target devices will never be located above access points  the angle between access points and target devices lies within the range of  90  90   hence the maximum angle in the setup was 90 degrees  1m 90 60 30 0 figure 7.2  measurement setup for optimal bluetooth dongle orientation  the setup shown in figure 7.2 was repeated for a number of different relative orientations between the access point and target devices  the relative orientation between the access point and the target at 0 degrees was defined as the base orientation  for the other target devices at 30  60 and 90 degrees  bluetooth dongles were aligned parallel to the dongle of the target at 0 degrees  appendix c.1 lists the different base orientations which were tested  to compensate for noise in measurements  rss values were collected during a 10 minute time period and then averaged  a photo of the actual test setup is shown in figure 7.3  7.1.2 results a complete overview of the mean and standard deviation for the measured rss values is given in appendix c.2  figure 7.4 shows the measured mean rss value per relative orientation and angle  7.1 antenna orientation 47 figure 7.3  photo of the measurement setup used to find the optimal dongle orientation  it also shows the mean rss value for each orientation if angle is ignored  i.e  when the data from the 4 different angles is merged  orientation -42 -44 -46 -48 rss  dbm  -50 -52 -54 -56 -58 -60 -62 -64 1 2 =0 3 4 5 = 30 6 7 = 60 8 9 10 = 90 11 12 13 14 = merged figure 7.4  measured mean rss value for different bluetooth dongle orientations  one of the things this graph makes clear is that relative orientation has a big impact on the measured rss values  the difference in maximum and minimum mean rss is about 20 dbm  for the lns model a 20 dbm difference corresponds to a large difference in physical distance  for example  assuming n = 2 and d0 = 1m  then according to the lns model a 20 dbm decrease in rss corresponds with the following distance  10 20 10 2 = 10 m  7.3  48 chapter 7 measurements this means that a scenario is possible where an access point estimates the distance to a target to be 10 meter instead of 1 meter  such a scenario could lead to big errors in location estimates  orientation of the bluetooth dongles is thus something which significantly affects localization accuracy  the graph in figure 7.4 also reveals that none of the orientations is optimal with respect to their relation with angle  in the ideal case the mean rss value is the same for each angle or decreases with increasing angle  none of the orientations  however  shows such a relation  therefore each of the orientations is prone to the problem that an access point might measure higher rss values for targets located further away  consequentially the best orientation is thus the one which shows the least variation in mean rss for the different angles  this appears to be the case for orientation 1  which also has the highest merged mean rss value  orientation 1 was therefore selected as the one closest to optimal orientation and this orientation was used in subsequent tests  the optimal dongle orientation is shown in figure 7.5 the left dongle in this figure is that of the access point and the right one is that of the target device  through the translucent casing of the bluetooth dongles the location of the pcb antenna was visible  this location has been marked in figure 7.5 by the dark area  figure 7.5  optimal dongle orientation  interestingly the 30 degree angle resulted in a higher mean rss value than the 0 degree angle for all but 2 of the orientations  this gave raise to suspicion that the target devices might have been transmitting at different power levels  to verify if this was indeed the case  measurements were repeated for the first orientation using different target devices and a different access point  this test was repeated 4 times and each time the bluetooth dongles of the target devices were rotated  the results of these tests are given in appendix c.3  each of the test runs  however  showed the same results for orientation 1 in figure 7.4  so there was no difference in transmission power of the bluetooth dongles  7.2 calibration and evaluation datasets to evaluate the performance of the algorithms discussed in section 6  calibration and evaluation datasets are required  a calibration dataset contains the data which is required to calibrate the algorithms  the mean rss fingerprinting algorithm uses this data for example to construct mean rss vectors for each location in the calibration dataset  the evaluation datasets contain data which is used to compute localization accuracy for the algorithms  these datasets contain rss measurements for a number of locations  mean localization error can be computed by comparing the actual target locations with the locations estimated from the evaluation dataset  the structure of calibration and evaluation datasets is similar  so they can be used interchangeably  each dataset contains a set of locations and for each location a set of rss measurement samples  which can be represented mathematically as    x  d    t  a  p      the elements of this set are  x  location of the device  7.2 calibration and evaluation datasets 49 d  identifier of the device  t  time at which the sample was generated  a  identifier of the access point that generated the sample  p  rss value measured by the access point  in chapter 5 a set of uncontrollable localization parameters was identified  these parameters were  relative orientation  device height  transmission power and environment structure  in order to evaluate the impact of each of these parameters on localization performance 5 different evaluation datasets are needed  1 dataset in which all of these parameters are fixed and 4 datasets where one of the parameters is random  also one calibration dataset is required which needs to be collected under the same conditions as the evaluation dataset for which all parameters are fixed  the impact of each parameter can then be evaluated by comparing the localization error for the dataset in which all parameters are fixed with the dataset where the parameter in question is randomized  note that collecting a dataset with random environment structure is not feasible as this requires constant changes in structure or layout  which is almost impossible to do when rss measurements are performed at a large number of locations  a better approach is to just collect the dataset in the same environment with a fixed but different structure  unfortunately it was not possible to collect all of these datasets  this was due to the limited availability of the test environment  the large amount of time it took to prepare the measurement setup and to perform the measurements  another issue was that transmission power could not be changed on the target devices  for these reasons it was decided to focus on relative orientation  evaluating the impact of the other parameters was also possible to some degree  impact of environment structure could be evaluated using an older dataset  see appendix a  that was collected previously in the same environment  when this older dataset was collected  the layout of the room was different  hence it allowed for using this dataset to evaluate impact of environment structure  the impact of device height has been evaluated by repetitively computing the localization error for each algorithm using different heights  finally  the effect of the transmission power level  tpl  has been tested by creating simulated datasets with different tpl values based on the real datasets  7.2.1 measurement setup for dataset collection two different datasets were collected for the purpose of evaluating localization performance  for both datasets device height  transmission power and environment were static  device orientation was the only parameter which was different for these datasets  the first dataset was collected with a fixed device orientation using the optimal orientation identified in section 7.1.2 in the second dataset device orientation was random at each location for which rss measurements were performed  to collect rss measurements 10 access points were installed in the test environment  the locations of the access points are shown in figure 7.7 access points were mounted in the corners of truss installations  to reduce interference from the metallic construction of the truss installations and to increase line of sight  bluetooth dongles were lowered to about half a meter below the access point  see figure 7.6   dongles were fixed into position using pieces of cardboard and tape  the access points were responsible for collecting rss measurements and sending them to a central server where they were stored  rss samples were generated by recording the signal strength of inquiry response messages received by the access points  inquiry response messages originated from target devices  which were placed at known locations  each target device was mounted on a tripod and the bluetooth dongles for these devices were elevated to 1.10 meter below the sensors of the access points  prior to the measurements the floor was marked to indicate the positions at which the target devices would be placed  these locations formed a grid below each truss with a 1 meter spacing  figure 7.7 shows the locations at which the target devices were placed  50 chapter 7 measurements figure 7.6  photo of a bluetooth dongle for one of the access points  8m = target location = access point figure 7.7  location of target devices and access points  7.2 calibration and evaluation datasets 51 a set of 9 target devices was available  so measurements could be performed at 9 different locations at once  therefore a total of 14 measurement runs needed to be performed to sweep the whole space  to collect enough rss samples for each location data was recorded during a period of 5 minutes  it was ensured that there was no movement within this period  so rss measurements were not influenced by changes in signal propagation  7.2.2 performance bounds the measurement setup described in the previous section provides information which can be used to give a lower bound on localization accuracy  this can be done using the cramer-rao lower bound  crlb   which gives a lower bound for the variance of an unbiased estimator  for any unbiased estimator this lower bound is given by equation 7.4  where f is the fisher information matrix  fim   this definition of the crlb thus states that the variance of an unbiased estimator for an unknown parameter is at least as high as the trace of the inverse fim  var   tr f   1  7.4  the crlb for rss based localization has been studied in earlier work  26  12   for the localization problem the unknown parameter is target location x and the fim for estimates of this parameter is given by equation 7.5  see  26  for a derivation   within this equation ai represents the location of access point i and the subscripts x and y denote the x and y components of a location  the constant is called the channel constant and its definition is given by equation 7.6   xx ai  x  2  xx ai  x   xy ai  y  n x kx ai k4 kx ai k4 f  x  = 2  xx ai  x   xy ai  y   xy ai  y  i=1 kx ai k4 kx ai k4 2  10n = log 10  7.5   7.6  equations 7.5 and 7.6 show that the crlb depends on the configuration of access points and the lns model parameters n and  since the configuration of access points is the same for both datasets described in the previous section  estimator variance is similar for both datasets  the only difference is the magnitude of  because this constant depends on n and which are different for the datasets  the channel constant thus acts as a scalar factor on the variance lower bound  hence the crlb can be defined for rss based localization as  var  x  1 f 0  x  f 0  x  = tr  f  x   7.7  1  7.8  as can be seen from equation 7.7  the lower bound on variance for a certain environment is proportionate to 1 /n  the lower bound on variance for location estimate x gives an indication of localization accuracy which can be achieved at that location  consequentially minimum localization accuracy for a specific environment depends on the ratio of parameters and n a practical error measure for the crlb is the root mean square error  rmse   which gives the expected localization error at a certain location  the rmse is defined by equation 7.9 rmse = p p tr f  x  1 = 1 f 0  x   7.9  figure 7.8 shows a plot of the square root of function f 0  x  for the test environment setup described in section 7.2.1 to get an actual estimate of the localization error  i.e  the rmse  52 chapter 7 measurements 8m 2.35 3.53 4.71 5.88 7.06 p f 0  x  8.23 figure 7.8  indication of how localization error varies over location for the test setup  p values need to be multiplied by 1  in the middle of the test environment access point density is relatively low  because only two access points are installed in the center truss  localization error is thus expected to be to be the highest for this area  which is confirmed by figure 7.8 the lower localization accuracy in the middle of the test environment is also observed when the localization errors for the datasets are computed  figure 7.9 shows the localization error for the uncalibrated lns model algorithm applied to the fixed orientation dataset  the other algorithms show similar spatial error plots for both datasets  to generate the error map shown in figure 7.9 localization errors were interpolated using inverse distance weighting with a distance exponent of 10  8m 0.0 2.0 4.0 6.0 8.0 e  m  10.0 figure 7.9  localization error for the uncalibrated lns model algorithm applied to the fixed orientation dataset  table 7.1 shows the lns model parameters which were estimated from the two datasets  the value of  the square root of its inverse and the average rmse value are also listed  the rmse values shown in this table have been computed by evaluating equation 7.9 for each tested location and taking the average  according to these results accuracy of location estimates will be higher for the second dataset compared to the first dataset  this is because a higher value of leads 7.2 calibration and evaluation datasets 53 to a decrease in the lower bound on estimation error variance  note that relative orientation is fixed for the first dataset and randomized for the second  the results are therefore conflicting with expectations  since localization accuracy is expected to be worse for randomized orientation  the crlb for these datasets  however  indicates the opposite  p p0 n 1 rmse dataset 1  fixed orientation -51.16 1.29 5.44 1.07 0.97 4.64 dataset 2  random orientation -51.21 1.39 5.44 1.24 0.90 4.31 table 7.1  lns model parameters and channel constant estimates for both datasets  earlier work on the effect of antenna orientation  5  has shown that it impacts the value of p0  this was  however  tested using omnidirectional antennas  since the measurements in section 7.1.2 for different orientations indicate that the used antennas are not omnidirectional it is questionable whether p0 is affected in the same way by orientation  assuming that it is  then the results in table 7.1  indicate that the fixed orientation dataset might not have been collected with optimal orientation  considering the fact that it was only possible to test orientations with 4 different angles in a single dimension  the selected orientation might indeed not have been the most optimal one  another indication that this might have been the case is the relative low value of n for the fixed orientation  any value of n below 2 indicates that signal strength decays slower than in a theoretical unbounded vacuum space  for an indoor environment a value below 2 is caused by  multipath propagation  a radiation pattern which emits higher power signals at angles for targets located further away  see section 7.1   it is therefore likely that the fixed orientation was not optimal for the dataset collected with fixed orientation  summary the impact of relative orientation on measured rss values was tested by performing a series of measurements with different orientations  the results of the measurements show a significant influence on mean rss value  from these measurement results one orientation has been identified as the best option  this orientation has been used for collecting a dataset of rss measurements at a large number of locations in the test environment  the same measurements were repeated  but instead using a random orientation at each location  an initial performance analysis of this data using the cramer-rao lower bound  crlb  indicates that a mean localization error of 4.64 m and 4.31 m is expected for the fixed and random orientation datasets respectively  the estimation of the lns model parameters for both datasets has  however  raised some doubt as to whether the orientation used for the fixed dataset was indeed optimal  this is because these parameters do not show the expected behaviour for the difference between fixed and random orientation  chapter 8 performance evaluation this chapter serves to answer the sub questions of research question 6  how do the localization parameters affect localization performance ? using the two datasets described in the previous section  a performance analysis of different localization algorithms was performed  it was decided to focus the analysis on accuracy  i.e  mean localization error  first a general discussion about the performance of the algorithms is given  then the effect of the uncontrollable parameters  orientations  device height  transmitter power level and environment structure  is discussed  finally a performance analysis is given for the controllable parameters  number of access points and window size  8.1 general performance this section presents the general localization accuracy results for each of the algorithms which were discussed in section 6 with a total of 2 different datasets  4 different combinations of calibration and evaluation datasets can be made  table 8.1 shows the mean localization error and standard deviation for each algorithm and dataset combination  the lowest value of mean localization error is marked in a bold font for each of the algorithms  for the fingerprinting algorithms computing mean localization error only has meaning if the calibration and evaluation dataset are different  this is because if the same dataset is used for both  fingerprints can be matched exactly  resulting in a mean error of 0 meter  therefore only the two columns with different calibration and evaluation datasets are listed for fingerprinting  for the algorithms which do not need to be calibrated this is also the case  because these depend only on the evaluation dataset  hence the table lists only two columns for these algorithms in order to avoid repetition  calibration dataset evaluation dataset algorithm ecolocation calibrated lns  ols  calibrated lns  lad  uncalibrated lns fingerprinting  mean rss  fingerprinting  jsd  fingerprinting  irr  fixed fixed e e 2.12 1.60 2.23 1.73  fixed random e e 2.75 2.11 2.33 1.74 2.50 1.91 2.40 2.23 2.58 2.00 2.64 1.95 8.93 6.06 random fixed e e 2.57 1.61 1.87 1.41 1.92 1.47 2.20 1.69 2.30 1.85 2.44 1.95 8.32 5.42 random random e e 2.13 1.55 2.35 1.70  table 8.1  mean and standard deviation of localization error in meters  note that in order to make a fair comparison between the fingerprinting algorithms and the others  output range for the location estimations was limited to the set of fingerprinted locations  this was done because the other algorithms can produce an infinite number of different estimates  while fingerprinting output is restricted to the locations at which fingerprints were collected  55 56 chapter 8 performance evaluation the first thing which is immediately evident from these results is that irr has a much lower accuracy compared to the rss based localization methods  figure 8.1 shows a plot of the number of received inquiry responses for the fixed orientation dataset  although the irr has a functional relation with distance according to  3   studying the graph in figure 8.1 reveals no correlation between irr and distance  it was therefore decided to discard irr based fingerprinting from the rest of the performance analysis  distance  m  200 180 number of inquiry responses 160 140 120 100 80 60 40 20 0 0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 figure 8.1  plot of irr over varying distance  secondly  the results show that an lns model which is calibrated using lad linear regression is less accurate than using ols linear regression  for all combinations of calibration and evaluation datasets  the ols calibrated lns model outperforms the lad variant  since the difference in mean error is not that big  lad will still be considered in the performance analysis of the localization parameters  8m 0.13 0.97 1.81 2.65 3.50  dbm  4.34 figure 8.2  spatial variation of for the fixed orientation dataset  an interesting result is that all algorithms  except for irr based fingerprinting  were able to 8.1 general performance 57 achieve a mean localization error roughly 2 meter below the mean rmse predicted by the crlb in section 7.2.2 for the fixed and random orientations datasets a mean localization error was predicted of 4.64 m and 4.31 m respectively  the crlb is based on the assumption that the lns model parameters are independent of location  which is not always true  consequentially if these parameters are location dependent  the value of can easily be overestimated  since the rmse is proportional to /n  an overestimation of this parameter may cause the predicted localization error to be higher than the actual measured errors  to show that this is actually the case for the datasets  the lns model parameters were estimated for each location in the fixed orientation dataset  figure 8.2 shows a plot of estimated value of as a function of location  the average value of is much lower in this plot than the value of 5.44 dbm which was computed for the whole localization space  a similar result is obtained if the same plot is generated for the random orientation dataset  this explains why the algorithms achieved a better accuracy than predicted by the crlb  another interesting result is that the calibrated lns model algorithms achieve the best accuracy using the random orientation dataset for calibration and the fixed orientation dataset for evaluation  it was expected that the best accuracy would be obtained if the same dataset was used for both calibration and evaluation  this illustrates  however  that estimating the lns model parameters using linear regression does not necessarily lead to the lowest mean localization error as discussed in section 6.2.1 like the difference between predicted accuracy by the crlb and actual accuracy  this appears to be the result of spatial dependency of the lns model parameters  by computing global lns model parameters using linear regression this dependency is ignored  as such  the estimation may not lead to the optimal values of p0 and n which minimize localization error  figure 8.3 shows a plot of mean localization error for varying values of n this figure confirms that the globally estimated values of n for both datasets do not minimize error  according to figure 8.3 the optimal value of n lies at 1.4 for the fixed orientation dataset and at 1.55 for the random orientation dataset  while the estimated values using ols linear regression are 1.29 and 1.39 respectively  path loss exponent  n mean localization error  e  m  3.1 3.0 2.9 2.8 2.7 2.6 2.5 2.4 2.3 2.2 2.1 2.0 1.9 1.8 1.0 1.1 1.2 = fixed orientation 1.3 1.4 1.5 1.6 1.7 1.8 = random orientation 1.9 2.0 figure 8.3  mean localization error as a function of path loss exponent n a similar result is obtained if mean localization error is plotted as a function of reference power p0  this plot is shown in figure 8.4 like the path loss exponent parameter n  the estimated reference power parameter p0 for both datasets is not the optimal one  figure 8.4 shows that 58 chapter 8 performance evaluation the optimal values of p0 lie around -52.5 dbm for both datasets  however  the estimated values for this parameter using ols linear regression are -51.16 dbm and -51.21 dbm for the fixed and random orientation datasets respectively  reference power  p0  dbm  3.4 mean localization error  e  m  3.2 3.0 2.8 2.6 2.4 2.2 2.0 1.8 1.6 -58 -57 -56 -55 = fixed orientation -54 -53 -52 -51 -50 -49 -48 -47 = random orientation -46 -45 -44 figure 8.4  mean localization error as a function of reference power p0  note that the localization errors for the non-fingerprinting localization algorithms listed in table 8.1 are not realistic  this is because their set of possible output locations has been restricted to the set of possible locations for the fingerprinting algorithms  while this enables a fair comparison between the different algorithms  it does represent a realistic scenario as in practice the set of possible target locations is infinite  though bounded   therefore the non-fingerprinting algorithms in reality need to consider a larger set of possible target locations  to see how the increase in output range impacts localization accuracy  mean error was computed for the algorithms using an output set defined by a grid with cells of 0.1 by 0.1 meter in the localization space  the results are listed in table 8.2 for an easy comparison between the mean localization error with limited output range  the results for the non-fingerprinting algorithms listed in table 8.1 are repeated in table 8.2  those algorithms listed without asterisk   again  lowest mean localization error for each of the algorithms has been marked in a bold font  localization results for a realistic set of output locations  shows an increase of about 25 % in mean localization error compared to the limited set  the decrease in accuracy can be explained by considering the fact that for the limited output set  algorithms will only be able to select from a set of locations of which all have exact matches  because the density of these locations is relatively low  the algorithms have a better chance of selecting the right location  for the realistic set of output locations density is much higher  so the algorithms are more likely to miss the actual target location  this means that the mean localization errors listed in table 8.2 correspond to a more realistic estimation of localization accuracy for in a practical setting  8.2 orientation table 8.1 shows that the best localization accuracy for all algorithms is achieved using the random orientation dataset for calibration and the fixed orientation dataset for evaluation  note that the ecolocation and uncalibrated lns model algorithm only depend on the evaluation dataset  for the calibrated lns model algorithms the fact that the combination of random and fixed dataset results 8.3 environment structure calibration dataset evaluation dataset algorithm ecolocation ecolocation * calibrated lns  ols  calibrated lns  ols  * calibrated lns  lad  calibrated lns  lad  * uncalibrated lns uncalibrated lns * fixed fixed e e 2.12 1.60 2.46 1.68 2.23 1.73 2.75 1.77  59 fixed random e e 2.75 2.11 3.06 2.19 2.33 1.74 3.19 2.03 2.50 1.91 3.51 2.02 2.40 2.23 2.77 2.32 random fixed e e 2.57 1.61 2.89 1.61 1.87 1.41 2.19 1.45 1.92 1.47 2.45 1.66 2.20 1.69 2.62 1.78 random random e e 2.13 1.55 2.54 1.64 2.35 1.70 2.99 1.86  table 8.2  mean and standard deviation of localization error in meters  the asterisk indicates mean error was computed with a realistic output range  in the best localization accuracy is surprising  as it was expected that using the same dataset for both calibration and evaluation gives the best location estimates  however  as discussed earlier  a probable cause is that the lns model parameters are not location independent  therefore the globally estimated parameters using linear regression do not result in the best location estimates  in general  table 8.1 shows that using the fixed orientation dataset for evaluation yields better location estimates than if the random orientation dataset is used  this is regardless of which calibration dataset is used  according to the crlb analysis of these datasets  see section 7.2.2   the channel constant for fixed and random orientation is 1.07 and 1.24 respectively  since the inverse of the channel constant gives an indication of relative accuracy  the crlb predicts better localization performance for the random orientation dataset  which is in conflict with the results  however  the problem that the lns model parameters are not location independent is also likely to be the cause of this difference  this is because the values of n and  which determine the magnitude of the rmse  are rough estimate for the whole space  the ratio between these parameters just happens to be more favourable for the random orientation due to chance  the main conclusion that can be drawn from table 8.1 is that random orientation leads to an increase in localization error of about 15 %  compared to fixed orientation  8.3 environment structure both datasets described in section 7.2 were collected in a static environment  there were no changes in layout in between of the measurements  in order to test the effect of environment structure on localization accuracy  another dataset is needed  fortunately some measurements were performed before in the same environment  using roughly the same setup  this dataset  which will referred to as the old dataset  is described in appendix a the differences between the old dataset and new datasets  described in section 7.2  is that in the old dataset only 9 access points were available  also the old dataset contains less locations for which rss measurements were performed  the set of measurement locations is however a subset of those of the new datasets  another difference between the old dataset and the new datasets is that the layout of the test environment was different at that time  figure 8.5 shows photos of the environment layout when rss measurements for the old and new datasets were performed  these photos were taken at approximately the same position  the biggest difference between the layouts is the object configuration in the middle of the room  for the old dataset this area contained tables and chairs aligned in rows  there was also a thick divider screen running across the middle of the room  the black curtain which is visible in both photos was wrapped around the center truss in the old layout while it was wrapped at the left truss for the new layout  finally the arrangement of objects 60 chapter 8 performance evaluation underneath the balcony was different for both layouts   a  layout for old dataset  b  layout for new datasets figure 8.5  photos of environment layout for the old and new datasets  to evaluate the impact of the environment structure  localization accuracy has been computed for both the old and new datasets  since orientation was fixed for the old dataset  the fixed orientation dataset from the new datasets was also used as evaluation data  the random orientation was used as calibration data  this was done to make a fair comparison between the old and new dataset with fixed orientation  mean localization error and standard deviation are shown in table 8.3 note that the old dataset contained rss samples for a time period of 10 minutes  while this time period was 5 minutes for the new datasets  to compensate for this difference  the old dataset was split in two halves and location estimates were computed for both parts and then averaged  when the differences in localization error for the individual parts were examined only minor differences were observed  so the averaging did not have much influence on the mean localization error  calibration dataset evaluation dataset algorithm ecolocation calibrated lns  ols  calibrated lns  lad  uncalibrated lns fingerprinting  mean rss  fingerprinting  jsd  random fixed new e e 2.29 1.38 1.75 1.34 1.63 1.08 1.92 1.43 2.04 1.66 2.46 2.12 random fixed old e e 2.17 1.20 1.75 1.10 1.79 1.12 1.65 0.99 2.11 1.54 2.05 1.28 table 8.3  mean and standard deviation of localization error in meters  the calibration and evaluation dataset combination random  fixed new corresponds with the combination random  fixed listed in section 8.2 mean localization error is  however  a bit better because most locations from the center of the test environment were excluded since these are not available in the old dataset  localization error is biggest in the center of the test environment  see section 7.2.2   so excluding these locations results in a lower mean localization error  the mean localization errors listed in table 8.3 do not display big differences between the two evaluation datasets  a maximum difference in mean error is found for the jsd fingerprinting algorithm  which shows a difference of 0.31 m neither of the two datasets can be marked as the one that performs better in terms of accuracy  consequentially one has to conclude that the differences in environment layout for both evaluation datasets did not affect signal propagation 8.4 device height 61 by such a degree that localization accuracy was significantly affected  this conclusion is not that surprising considering the fact that there were no major changes in the layout  like changes in line of sight between the access points and target devices  in both datasets all access points had a direct line of sight to each of the target locations  in a more realistic scenario  such changes are more likely  because target devices are located closer to the ground than during the collection of the datasets  when a device is located closer to the ground it also more likely to encounter obstacles along the path to an access point  8.4 device height so far a 2 dimensional target space has been assumed  while a 2 dimensional space is sufficient to satisfy the requirements for the localization system that are specified in section 3.1.1  height of the target devices does affect localization results  this is because height affects relative orientation and distance to the access points  in turn this affects the rss values measured by access points  to test the impact of device height on localization performance a dataset is needed with all parameters being fixed except for height  which has to be randomized  by comparing the mean localization error for this dataset with a reference dataset in which all parameters all fixed  the difference in mean error shows the impact of unknown and variable height  unfortunately no such dataset is available  the impact of unknown height  however  can be tested under the assumption that all devices are located at the same height  height can only be included in the lns model based algorithms  this is because ecolocation and the fingerprinting algorithms do not compute the physical distance between  possible  target locations and the access points  for the lns model algorithms height can included by computing distances in 3 dimensional space rather than in 2 dimensional space  to do so  these algorithms need to know the distance between target devices and access points along the z axis  during the collection of the datasets used to evaluate localization performance  the antennas of the target devices were located 1.1 meter below those of the access points  if this distance is called z  then equation 8.1 gives the distance between a target location x and an access point a in 3 dimensional space  q d =  xx ax  2 +  xy ay  2 + z 2  8.1  note that equation 8.1 has been used all along during the evaluation of localization accuracy in the previous sections with a value of 1.1 for z in a practical application of the bluetooth localization system  z is unknown and different for each target  assuming  however  that z is constant for all targets  then it is possible to determine its impact by computing the mean localization error for various values of this height  this has been done for the uncalibrated and ols calibrated lns model algorithms  the results are shown in figure 8.6 in this graph the height along the x axis corresponds with the difference between the actual value of z  so 0 means devices are located 1.1 meter below the access points and 4 means a distance of 4.1 meter  the graph in figure 8.6 shows that localization accuracy is relatively independent of the value of z this can be explained by the fact that height has less influence with increasing distance  equation 8.2 gives the difference between distance in 3 dimensional space and distance in 2 dimensional space  the average distance between any point in the localization space of the test environment and the access points is 11.6 m for a value of 1 m for z  this results in an average difference of 0.043 m between 3 and 2 dimensional space  this difference is too small to have a significant effect on localization accuracy  however  if z is increased to 4 m  the average difference increases to 0.670 m  which is no longer insignificant  d = p d2 + z d  8.2  62 2.30 chapter 8 performance evaluation height difference  z + 1.1  m  mean localization error  e  m  2.25 2.20 2.15 2.10 2.05 2.00 1.95 1.90 1.85 1.80 -4.0 -3.5 -3.0 -2.5 -2.0 -1.5 -1.0 -0.5 = calibrated lns  ols  0.0 0.5 1.0 1.5 2.0 = uncalibrated lns 2.5 3.0 3.5 4.0 figure 8.6  impact of z on mean localization error  nonetheless  the uncalibrated lns model algorithm shows no signs of accuracy loss for higher values of z this is because adjusting the distances for height results in a compression of the linear regression data  while this effects the values of p0 and n  it does not significantly effect the value of  which is minimized by this algorithm  since the compression is not linear  z will eventually impact localization accuracy as well  because it breaks the linear relation between the logarithm of distance and rss  the calibrated lns model is more sensitive to device height as shown in figure 8.6 the reason that this algorithm is more sensitive is because it does depend on the values of p0 and n  unlike the uncalibrated model  in practice the calibrated lns model is even more sensitive to height due to the fact that height influences relative orientation between target devices and access points  since the height of a target devices is not necessary the same as the height of the devices during calibration  the estimated lns model parameters p0 and n may be off for the height of the target device  this is true for all calibrated localization algorithms  fortunately the range of possible device heights is limited in practice  an average height of 1 m is expected with a maximum deviation of about 0.5 m figure 8.6 shows that localization accuracy is not significantly affected within the range of  0.5  0.5   in reality the calibrated lns model based algorithm will be affected more than is shown in this figure  due to changes in relative orientation  the uncalibrated lns model  however  will not be significantly effected by unknown and varying device height  8.5 transmitter power unfortunately it was not possible to collect a dataset with different transmitter power levels  tpl   however  it was possible to simulate a different tpl for the datasets which have been collected  this has been accomplished by modifying the rss samples in the datasets  for example to simulate a decrease of 5 dbm in tpl  5 dbm has been subtracted from each of the measured rss values in the dataset used for evaluation  with this approach it was possible to study the effects of the tpl on the accuracy of the localization algorithms  note that the approach is based on the assumption that a difference of p in tpl results in the same difference for all measured rss values  according the the lns model  this assumption is correct and the reference power 8.5 transmitter power 63 parameter p0 can be viewed as the effective tpl value at reference distance d0  to test the effect of the tpl on the accuracy of the localization algorithms  mean localization error has been computed for a range of different tpl values  the results of this test are shown in figure 8.7 because the actual tpl value of the target devices was not known  the tpl values have been expressed as the difference to p0 in dbm  for calibration the random orientation dataset was used and the fixed orientation dataset has been used for evaluation  rss values were only adjusted for the evaluation dataset  which was done to simulate a scenario in which the tpl of the target devices is different from that of the devices used to collect the calibration data  note that mean localization error for the histogram based fingerprinting algorithm has only been computed for integer values of p0  this is because the jsd histogram distance function only supports integer shifts of the histogram bins  for non-integer shifts the function returns the maximum distance value log 2  6.0 tpl difference  p0  dbm  mean localization error  e  m  5.5 5.0 4.5 4.0 3.5 3.0 2.5 2.0 1.5 -20 -18 -16 -14 -12 -10 -8 -6 -4 -2 0 2 4 6 = ecolocation = calibrated lns  ols  = uncalibrated lns = fingerprinting  mean rss  8 10 12 14 16 18 20 = calibrated lns  lad  = fingerprinting  jsd  figure 8.7  impact of p0 on mean localization error  as expected  figure 8.7 shows that the uncalibrated algorithms are independent of the tpl value  for ecolocation this is because the relative ordering between access points is unaffected when all rss values are shifted by the same value  the uncalibrated lns model algorithm is unaffected by tpl because this value does not influence  which is being minimized by the algorithm to find the best location estimate  for the calibrated algorithms  except the histogram based fingerprinting algorithm  there appears to be a linear relation between the value of p0 and mean localization error  with different slopes for the negative and positive values of p0  according to figure 8.7 there is only a error margin of -2 to 3 dbm in tpl  before the uncalibrated lns model algorithm outperforms the calibrated lns model algorithms  in practice a difference of more than 3 dbm between the tpl of the target devices and that of the calibration data is expected to be common  this might not only be the case because of differences in tpl  but also because of differences in the device casing which may absorb the radio signals with varying degree  thereby influencing the effective value of p0  consequentially  the uncalibrated lns model algorithm is expected to outperform its calibrated counterparts in an environment with a heterogeneous set of target devices  the tpl value appears to have to biggest influence on the histogram based fingerprinting algorithm  which shows an exponential relation between p0 and mean localization error  this big influence can be explained by considering the effect of p0 on the histogram  which shifts 64 chapter 8 performance evaluation the histogram to the left or right  for increasing absolute values of p0  the histogram shifts further from its original location  the jsd histogram function can be approximated by computing the overlapping area of two histograms  since the histograms are normally distributed  according to the lns model   small shifts result in relatively large changes in the overlapping area of the histograms  for larger shifts the change in overlapping area diminishes  considering the nature of the histograms and the jsd function  the relation between p0 and e can be described using a negated gaussian function  this is confirmed if the complete graph of the jsd based fingerprint algorithm is shown  see figure 8.8   because of the relative big impact of p0 on mean localization error for this algorithm  it is not a suitable algorithm for a realistic localization scenario  tpl difference  p0  dbm  20 mean localization error  e  m  18 16 14 12 10 8 6 4 2 -20 -18 -16 -14 -12 -10 -8 -6 -4 -2 0 2 4 6 8 10 12 14 16 18 20 figure 8.8  impact of p0 on mean localization error for the jsd fingerprinting algorithm  8.6 number of access points the localization parameters considered so far were all uncontrollable parameters  a parameter which can be controlled is the number of deployed access points in the localization space  generally the more access points  the better localization accuracy will be  this is because increasing the number of access points increases the amount of information that is available for targets  thereby reducing the impact of noise in the data  to see how significant the number of access points is on accuracy  mean localization error has been computed for a varying number of access points  this was done by selectively disabling access points in the datasets  because the number of different combinations of disabled access points was too high to compute the mean error for each of these combinations  subsets of these combinations were tested and then the errors were averaged  the results are displayed in figure 8.9 the random and fixed orientation datasets were used respectively for calibration and evaluation  figure 8.9 shows that the uncalibrated localization algorithms are more sensitive to the number of access points  this is as expected  because calibrated algorithms are more informed and therefore require less information from access points than the algorithms which are not calibrated  an interesting result is that ecolocation appears to be more accurate than the uncalibrated lns model algorithm for a low number of access points  in a practical application of the localization system  to cover enough surface the number of access points probably not as high as 10 to optimize localization accuracy when the use of calibrated algorithms is not a viable option  the localization 8.7 window size 65 number of access points  n 6.0 mean localization error  e  m  5.5 5.0 4.5 4.0 3.5 3.0 2.5 2.0 1.5 3 4 = ecolocation = uncalibrated lns 5 6 7 = calibrated lns  ols  = fingerprinting  mean rss  8 9 10 = calibrated lns  lad  = fingerprinting  jsd  figure 8.9  impact of number of access points on mean localization error  system could dynamically select a localization algorithm based on the number of access points that can perceive a certain target  for example if only 3 access points detect and generate rss samples for a target device  ecolocation will likely outperform the uncalibrated lns model algorithm in terms of accuracy  on the other hand if the number of access points is 7  the uncalibrated lns model is more likely to make better location estimates  according to figure 8.9 the threshold lies at 6 access points  the other localization algorithms show an approximate linear relation between the number of access points and mean localization error for the interval n =  3    10   both the calibrated lns model algorithms and fingerprinting algorithms show similar behaviour  where none of the algorithms in their respective classes are favourable above one another with respect to accuracy  the plot shown in figure 8.9 can also be used to derive the minimum number of access points that is required to achieve reasonable localization accuracy  in section 3.1.1  reasonable localization accuracy has been defined as a maximum mean localization error of 5 m because the plot in figure 8.9 was generated using a restricted set of output locations  mean localization error is 25 % higher for a realistic scenario  see section 8.1   this means that the threshold for reasonable localization accuracy lies at 4 m in figure 8.9 at this threshold it appears that 3 access points are sufficient for the calibrated localization algorithms  for the uncalibrated algorithms  however  at least 5 access points are required to obtain reasonable localization accuracy  8.7 window size window size is another controllable parameter of the localization system  the window size is the length of the time period in which rss samples are used to estimate the location of a target device  for optimal responsiveness the window size should be rather low  in the order of a few seconds  however  the window size also affects accuracy as the number of rss samples to be used for target estimation is a function of the window size  selecting an appropriate window size is therefore a trade-off between accuracy and responsiveness  to test the effect on localization accuracy for the different algorithms  mean localization error has been computed with for a window size ranging from 5 seconds to 5 minutes  the results are displayed in figure 8.10 mean localization error was computed using the random orientation dataset for calibration and fixed orientation dataset for 66 chapter 8 performance evaluation evaluation  window size  t  min  mean localization error  e  m  4.4 4.2 4.0 3.8 3.6 3.4 3.2 3.0 2.8 2.6 2.4 2.2 2.0 1.8 0.0 0.5 1.0 = ecolocation = uncalibrated lns 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 = calibrated lns  ols  = calibrated lns  lad  = fingerprinting  mean rss  = fingerprinting  jsd  figure 8.10  impact of window size t on mean localization error  figure 8.10 shows that mean localization error is fairly constant for all algorithms when the window size is 1 minutes or larger  when window size is decreased below 1 minute  the error begins to increase exponentially  this leads to the conclusion that a time window of 1 minute is sufficiently large to make location estimates with reasonable accuracy  a window size of 1 minute may seem rather high  however  as discussed in section 4.3.1  the sample rate of rss measurements is low  about 18.6 samples per target device and access point per minute  for 10 access points this corresponds to an average of 223 rss samples  note that increasing or decreasing the number of access points affects the number of rss samples in the window  to see if the number of access points has a significant impact on the time at which the mean localization error stabilizes  the same test has been repeated using 4 access points instead of 10 the results of this test are shown in figure 8.11 comparing the results for 4 access points with the results for 10 access points  it can be seen that the curves are less smooth and mean localization error lies higher  in general  however  the graphs show similar behaviour of e for varying values of t also the point at which the error stabilizes is the same in both graphs  therefore a 1 minute window size appears to be sufficient regardless of the number of access points  with a window size of 1 minute  the localization system complies with the accuracy and responsiveness requirements set in section 3.1.1 for all algorithms the mean localization error is below 5 meter  taking a 25 % increase in account for a realistic output range   thereby satisfying the accuracy requirement  the responsiveness requirement states that targets should be localized with reasonable accuracy within 5 minutes  so a window size of 1 minutes is sufficiently small  in fact the margin is large enough to increase the window size  for a practical deployment of the localization system this might be necessary  as the number of access points that will be able to detect a target device is expected to be less than 10 therefore a larger window size might be required to still achieve localization estimates with reasonable accuracy  8.7 window size 67 window size  t  min  6.5 mean localization error  e  m  6.0 5.5 5.0 4.5 4.0 3.5 3.0 2.5 0.0 0.5 1.0 = ecolocation = uncalibrated lns 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 = calibrated lns  ols  = calibrated lns  lad  = fingerprinting  mean rss  = fingerprinting  jsd  figure 8.11  impact of window size t on mean localization error with 4 access points  summary localization based on irr has resulted in a very poor performance  when the correlation between irr and distance was checked  no relation was found and thus it was decided to ignore this method  best localization accuracy was obtained for all algorithms using fixed orientation  when using a random orientation  mean error increased about 15 %  for those algorithms that required calibration  using the random orientation dataset for calibration has produced the best location estimates  this is due to the fact that the lns model parameters were estimated globally  while these appear to be location dependent  the random calibration dataset  by chance  produces a better estimate of lns model parameters on global scale  device height appears to be no issue for the lns model based algorithms  this is because of the relative small range of possible heights  which therefore has little effect on distance  in practice height is expected to be of more influence because it changes the relative orientation between the target and the access points  transmitter power level  tpl  of the target devices did appear to be an important parameter for localization accuracy  while the uncalibrated algorithms are independent of this parameter  the calibrated algorithms are affected by this parameter  especially the histogram based fingerprinting algorithm is sensitive to this parameter  the main conclusion that can be drawn is that even for small deviations  3 dbm  of the tpl value  the uncalibrated lns model algorithm yields better localization accuracy compared to the other algorithms  the dataset described in appendix a was used to test the impact of changes in environment layout  although there were a lot of small layout changes  localization accuracy was not worse for this dataset  this is likely to be the result of the absence of major changes in environment structure  apart from the uncontrollable parameters two controllable parameters were also tested  the first of these is the number of access points  which appeared to have the biggest influence on the accuracy of the uncalibrated algorithms  an interesting result is that if the number of access points is less than 6  ecolocation outperforms the uncalibrated lns model algorithm  however  if the number of access points is higher than 6  this is the other way around  furthermore a rough linear relation was observed for the number of access points and the mean localization error for 68 chapter 8 performance evaluation the calibrated algorithms  the second controllable parameter  window size  has revealed that a 1 minute window contains a sufficient number of rss samples to make location estimates with reasonable accuracy  this threshold appears to be independent of the number of access points  also increasing the window size beyond 1 minute does not significantly improve localization accuracy  chapter 9 practical test the performance evaluation of the localization algorithms in the previous chapter has given insight in how the localization parameters influence localization accuracy  it should be noted  however  that this evaluation was performed for controlled environment  i.e  the parameters were selectively set to fixed or variable values  for the evaluation in chapter 8 at most one parameter was varied  while the results allow for a rough prediction of localization performance when multiple parameters are unknown and variable  a more realistic test scenario is missing  therefore another test was performed using a mobile phone to more accurately simulate a practical scenario  this chapter describes the setup of this test and the results  9.1 measurement setup to test localization performance in a setting that more accurately simulates a practical environment  a mobile phone was used as target device  with this scenario it was possible to vary the device orientation  device height and transmitter power level parameters from the datasets described in section 7.2 first of all because a different device was used  the radiation pattern of the radio signals was different which results in the same effect as a different orientation  also the device was carried in the pocket of a trouser which was at a lower height than the target devices used for the performance analysis in chapter 8 finally the transmitter power level might also have been different for the mobile phone  whether this was actually the case is not clear  because this value was unknown for both the mobile phone and the target devices used for collecting the datasets  note that because the phone was carried in the pocket of a trouser  there was an additional effect of the human body absorbing part of the radio signals  which is something that will also happen in a practical setting  the mobile phone used for these tests was a nokia 6300  shown in figure 9.1 figure 9.1  nokia 6300 mobile phone  the test was performed in the same environment as described in section 7.2 therefore envi69 70 chapter 9 practical test ronment structure and access point layout were the same  because the available time to perform the measurements was limited  only a few measurements were made  the measurements were performed with 4 different orientations  facing north  west  south and east  for each location  for each of the orientations at a certain location  rss samples were collected during a period of 2 minutes  measurements were performed in the center of the 3 truss installations  so a total of 12 different sample sets were collected  the location and orientation of the mobile phone in the trouser pocket was not changed until all measurements had been performed  figure 9.2 shows the locations in the test environment for which the rss measurements were performed as well as the location of the access points  8m = target location = access point figure 9.2  tested locations with mobile phone and access points locations  9.2 results using the measurement samples that were collected for each location and orientation the error between the actual location and estimated location were computed  this was done for each localization algorithm described in chapter 6  except for irr based fingerprinting  for the algorithms that required calibration  localization error was computed using both the fixed and random orientation datasets for calibration  the complete results are listed in appendix d in figure 9.3 mean localization error is shown for each of the algorithms  this is done using both the fixed and random orientation dataset for calibration  the first thing figure 9.3 illustrates is that using the random orientation dataset for calibration yields better location estimates then if the fixed orientation dataset is used  a similar result was observed in section 8.1  when mean localization error for the algorithms was compared using the fixed and random datasets for evaluation  for the calibrated lns model based algorithms this is likely to happen because of the same reason as in section 8.1  the lns model parameters for the test environment are estimated better using the random orientation dataset  the fingerprinting based algorithms  however  show much more improvement in accuracy as compared to section 8.1 because of the small number of sample sets  it is not clear if this is just a coincidence or an effect that is structural  if it is  then a possible explanation might be that the radiation pattern of the mobile phone differs to a large degree from that of the target devices in its fixed orientation  the random orientation used for the other dataset might therefore have more closely reflected the radiation pattern of the mobile phone  another thing that is shown by figure 9.3 is that the uncalibrated algorithms appear to yield the best location estimates  this result is in line with expectations  because the uncalibrated algorithms are less sensible to the uncontrollable localization parameters  the calibrated algorithms  on the other hand  rely on information which was gathered for a specific combination of parameter 9.2 results 71 algorithm 8.0 7.5 mean localization error  e  m  7.0 6.5 6.0 5.5 5.0 4.5 4.0 3.5 3.0 2.5 ecoloc lns  ols  lns  lad  = calibrated with fixed orientation uc lns fp  mean  fp  jsd  = calibrated with random orientation figure 9.3  mean localization error for each localization algorithm per calibration dataset  settings  for the mobile phone measurements  these parameters were different  resulting in lower localization accuracy  the localization performance test using a mobile phone  thus illustrates that the algorithms that do not require calibration are preferred over those that do require calibration in a practical setting for a bluetooth based localization system  figure 9.4 shows a graph of the mean localization error for each of the 3 tested locations  this graph was generated using the random orientation dataset  from this graph it can be seen that localization error is the highest for the location in the center truss  this is also predicted by the crlb analysis and observed in the performance analysis in chapter 8 the reason for this is that the density of access points in the middle truss is less than the density of access points for the other truss installations  summary to get an indication of localization performance in a practical setting  rss samples were also collected for a mobile phone  this was done in the same environment as for the datasets described in section 7.2 and also with the same setup  for 3 different locations  measurements were performed when the mobile phone was carried by a person in a trouser pocket  measurements were repeated 4 times for each location with different orientations  facing north  west  south and east   with this setup the parameters  device orientation  device height and possibly also transmitter power level  were different than those from the calibration data  resulting a scenario that more closely resembles a realistic situation  the main result of this test is that the uncalibrated localization algorithms appear to perform better in such a setting than the algorithms which need to be calibrated  this is in line with expectations  because the uncalibrated algorithms are less sensible to variations the localization parameters  72 chapter 9 practical test algorithm 10 mean localization error  e  m  9 8 7 6 5 4 3 2 1 0 ecoloc = left truss lns  ols  lns  lad  uc lns = middle truss fp  mean  fp  jsd  = center truss figure 9.4  mean localization error for each localization algorithm per location  chapter 10 conclusions in this thesis the use of bluetooth for localization in a practical setting was studied  the context of the localization system is that of an office building in which the location of people is tracked  to determine whether bluetooth is a viable localization technology for this application  minimal requirements for 5 system properties were set  these requirements are  mean localization error should be no higher than 5 m for a stationary person  the system should be able to give a reasonable location estimate within 5 minutes  initial calibration effort should be minimal and periodic manual recalibration should not be necessary at all  the system should be able to adapt to changes in the environment automatically  the only thing people should do in order to be localized is to turn on bluetooth on their mobile phone  based on these requirements two different measures have been selected for bluetooth that can be used to estimate target locations  the first is the received signal strength indicator  rssi  during the inquiry phase of the bluetooth device discovery protocol and the second is inquiry response rate  irr  the results  however  have shown that irr provides no location information and thus this measure has been excluded from the performance analysis  research question 1  which localization measures are best suitable within the context ?  can thus be answered with  the localization measure best suitable within the context is rssi during inquiry phase  also based on the requirements  a set of uncontrollable parameters has been identified that may possibly have a negative impact on localization accuracy  these parameters are  relative orientation between target devices and the access point antennas  varying levels of transmitter power for different target devices  unknown height of the target devices  a dynamic environment structure and layout  the answer to research question 2  what are the parameters that influence localization performance ? is therefore  the parameters influencing localization performance are  device orientation  transmitter power level  device height and environment structure  to test the impact of these parameters  a number of localization algorithms were selected on which the effect of each of these parameters was tested  at least one algorithm from each class of signal strength based localization methods was chosen  these algorithms form the answer to research question 3  which localization methods will be evaluated ? the algorithms that were tested are  ecolocation 73 74 chapter 10 conclusions log-normal shadowing model calibrated using ordinary least squares linear regression  log-normal shadowing model calibrated using least absolute deviations linear regression  log-normal shadowing model without calibration  fingerprinting using mean rss vectors  fingerprinting using the jenson-shannon divergence for rss histograms  prior to collecting the datasets for evaluating localization performance  it was first checked how significant device orientation influenced measured rss values  this was done by comparing the average rss values measured for a number of different orientations  differences in mean rss were found of up to 20 dbm  which corresponds to a large difference in distance  from these measurements one orientation was selected that appeared to be optimal  this orientation is shown in figure 7.5 and answers research question 4  what is the optimal orientation between target device and access point sensors ? next  two datasets in a test environment were collected  one with a fixed optimal orientation and one with a random orientation of target devices  to answer research question 5  what is the maximum localization accuracy that can be achieved ?  a cramer-rao lower bound  crlb  analysis was performed on these datasets  this analysis has resulted in the following answer  a mean localization error of 4.64 and 4.31 m is expected for the fixed and random orientation datasets respectively  the analysis  however  shed some doubt as to whether the orientation used for the fixed dataset was indeed optimal  when mean localization error was computed for the different algorithms it was found that using a fixed orientation resulted for all algorithms in the best accuracy  this  however  contradicts the expectations from the crlb  the most probable cause of this discrepancy is that the crlb assumes the log-normal shadowing  lns  model parameters to be location independent  while this appears not to be the case in the test environment  this idea is reinforced by the fact that the estimation of lns model parameters using linear regression did not result in the best localization accuracy  for instance  better localization results were obtained using the random orientation dataset for calibration and fixed orientation data set for evaluation as compared to the case when both the calibration and fixed datasets were the same  based on an inspection of the mean localization errors that were computed for various combinations of calibration and evaluation datasets  random orientation appears to increase localization error with 15 % as compared to fixed orientation  which answers research question 6a  to what extent does unknown device orientation affect localization accuracy ? this answer can be formulated as  compared to fixed device orientation  mean localization error increases by about 15 % when the orientation randomized  despite the decrease in accuracy for random orientation  all algorithms produced a mean localization error well below 5 m  which is the minimal requirement for accuracy  testing the effect of changes in environment layout with an older dataset  revealed no significant change in localization accuracy  it should be noted  however  that even though there were lots of small difference in layout  there were no major differences  in both evaluation datasets all target devices had a clear line of sight to the access point antennas  because of this  it is not possible give a conclusive answer to research question 6b  to what extent do environmental changes affect localization accuracy ? while it was not possible to collect a dataset for random target device height  the influence of height for the lns model based algorithms was still tested  this was done on the the assumption that all devices are located on the same height for both calibration and evaluation data  by explicitly including the height between the access points and target devices  it was possible to check the influence if this value would be unknown  the results show that these algorithms are not very sensible to this height  especially the uncalibrated algorithms  in actual practice height will be of more influence  due to the fact that height also influences the measured rss values  which could 75 not be simulated  this is  however  only a problem for the calibrated localization algorithms  an answer to research question 6c  how significant is the effect of unknown device height on localization accuracy ?  can thus be formulated as  device height does not have a significant effect on localization accuracy for uncalibrated localization methods  but for calibrated localization methods it does have a negative impact if the height of target devices deviates from the calibrated device height  since no dataset with varying transmitter power levels  tpl  was available  such a dataset was simulated by modifying the rss values of one of the datasets which had been collected  this was done to answer research question 6d  how do varying levels of transmitter power affect localization accuracy ? the results of the analysis of this parameter using the simulated dataset shows that the histogram based fingerprinting algorithm is very sensitive to this parameter  thereby making it impractical for realistic localization environments  the analysis also shows that the uncalibrated algorithms are not affected by this parameter at all  while there appears to be linear relation for the calibrated algorithms  except the histogram based one   with a tpl deviation within the range of -2 to 3 dbm  the calibrated algorithms show the best localization accuracy  outside of this range  the uncalibrated lns model algorithm outperforms the other algorithms  since absolute tpl deviations of more than 3 dbm are expected to common in a realistic setting  the uncalibrated lns model algorithm seems to be the best choice  in short the answer to research question 6d is  transmitter power level has no influence on the accuracy of the uncalibrated localization algorithms  but the calibrated algorithms  except histogram based fingerprinting  show a linear relation between transmitter power level and accuracy  in addition to the uncontrollable localization parameters  the impact of two controllable parameters was also tested ; those being  the number of access points and the window size  for the number of access points a roughly linear relation was found with mean localization error for the algorithms which used calibration  the uncalibrated algorithms were affected to a larger degree by the number of access points  it appears that for 5 access points or less ecolocation provides the best location estimates  while the uncalibrated lns model algorithm performs better if the number of access points is 7 or higher  furthermore  the analysis of the effect of the number of access points shows that 3 access points are enough for the calibrated algorithms to achieve a reasonable localization accuracy  while 5 access points are required for the uncalibrated localization algorithms  the answer to research question 6e  what is the minimum required number of access points to achieve reasonable accuracy ? is thus  a target device has to be detected by least 3 access points for the calibrated localization algorithms and by at least 5 access points for the uncalibrated algorithms  to estimate the location of the target with reasonable accuracy  testing the influence of window size revealed that roughly 1 minute of rss sample data is sufficient for making reasonable location estimates  when less than 1 minute of data is used  mean localization error becomes unstable and increases exponentially  the answer to research question 6f  what is the minimum required window size to achieve reasonable accuracy ?  is thus  a window size of 1 minute is sufficient to achieve location estimates with reasonable accuracy  returning to the main research question which bluetooth based localization system design works well for indoor environments ?  the conclusion is that for the context of indoor localization using bluetooth the best option is to use a combination of two algorithms  if a certain target is perceived by 5 or less access points  then the best option is to use ecolocation  otherwise  if the number of access points is higher than 5  then the uncalibrated lns model algorithm is the best option  these two algorithms are preferable over the other algorithms  because they do not require any calibration  therefore these algorithms are less sensitive to changes in environment structure  transmitter power level  orientation and device height  this conclusion was confirmed when the localization algorithms were tested with a mobile phone to simulate a more realistic localization setting  the test showed that the two uncalibrated algorithms performed better with respect to accuracy as compared to the calibrated algorithms  the results also indicate that the uncalibrated algorithms conform to all of the minimal requirements set for the localization context  chapter 11 future work although it appeared to be possible to find a suitable localization system design for indoor environments  thereby answering the main research question  some parts of the performance evaluation could be improved  firstly it was only possible to collect 2 datasets  while a total of 6 datasets is required to do a complete evaluation of the impact of the uncontrollable parameters identified in chapter 5 these required datasets are  a calibration dataset in which all parameters are fixed  a control dataset for evaluation  also with all parameters fixed  an evaluation dataset with random device orientation  an evaluation dataset with random transmission power levels  an evaluation dataset with random device heights  an evaluation dataset with a changed layout of the test environment  in this study it was possible to collect one dataset with all parameters fixed and one in which orientation was randomized  because of the availability of an older dataset with different different environment layout  the effect of this parameter could also be tested  the differences were  however  not significant enough to have clear impact on localization performance  device height could only be partially tested and the effect of tpl has been tested using simulations  therefore collecting these missing datasets should help to get more insight into the effect of these parameters  there is also some doubt as to whether the fixed orientation indeed was the most optimal one  it is worthwhile to repeat the rss measurements for various orientations  but instead of only testing a few angles in one dimension  the number of angles should be increased and should be measured in two dimensions  this will give a more complete picture of the radiation pattern of antennas in the bluetooth dongles  one thing that was not addressed in this thesis is the presence of non line of sight conditions  which are very common for indoor environments  most office buildings are divided into rooms which are separated with concrete  bricks or some other material  the effect of these materials on signal propagation is likely to affect localization performance  this is therefore something which needs to be evaluated  because it may lead to such a drop in accuracy for the algorithms identified that they are no longer practical  77 bibliography  1  marco altini  davide brunelli  elisabetta farella  and luca benini  bluetooth indoor localization with multiple neural networks  in proceedings of the 5th ieee international conference on wireless pervasive computing  iswpc10  pages 295300 ieee press  2010   2  p bahl and v.n  padmanabhan  radar  an in-building rf-based user location and tracking system  in infocom 2000 nineteenth annual joint conference of the ieee computer and communications societies  proceedings  ieee  volume 2  pages 775784  2000   3  mortaza s bargh and robert de groote  indoor localization based on response rate of bluetooth inquiries  in proceedings of the first acm international workshop on mobile entity localization and tracking in gps-less environments  melt 08  pages 4954  new york  ny  usa  2008 acm   4  b.j  dil and p.j.m  havinga  on the calibration and performance of rss-based localization methods  in internet of things  iot 2010  tokyo  japan  pages 18  usa  november 2010 ieee computer society   5  b.j  dil and p.j.m  havinga  rss-based localization with different antenna orientations  in telecommunication networks and applications conference  atnac   2010 australasian  pages 1318  november 2010   6  b.j  dil and p.j.m  havinga  stochastic radio interferometric positioning in the 2.4 ghz range  in proceedings of the 9th acm conference on embedded networked sensor systems  sensys 2011   seattle  usa  pages 108120  2011   7  eiman elnahrawy  li xiaoyan  and richard p martin  the limits of localization using singal strength a comparative study  in first annual ieee communications society conference on sensor and ad hoc communications and networks  ieee secon 2004   pages 406414  october 2004   8  silke feldmann  kyandoghere kyamakya  ana zapater  and zighuo lue  an indoor bluetoothbased positioning system  concept  implementation and experimental evaluation  in international conference on wireless networks  pages 109113  las vegas  usa  june 2003   9  t.m  fernandez  j rodas  c.j  escudero  and d.i  iglesia  bluetooth sensor network positioning system with dynamic calibration  in wireless communication systems  2007 iswcs 2007  4th international symposium on  pages 4549  october 2007   10  gunter fischer  burkhart dietrich  and frank winkler  bluetooth indoor localization system  in proceedings of the 1st workshop on positioning  navigation and communication  wpnc04   pages 147156  2004   11  bluetooth special interest group  bluetooth core specification 1.2  november 2003 https  //www.bluetooth.org/spec/   12  fredrik gustafsson and fredrik gunnarsson  localization in sensor networks based on log range observations  in 2007 10th international conference on information fusion  pages 18  july 2007  79 80 bibliography  13  andreas haeberlen  eliot flannery  andrew m ladd  algis rudys  dan s wallach  and lydia e kavraki  practical robust localization over large-scale 802.11 wireless networks  in proceedings of the 10th annual international conference on mobile computing and networking  mobicom 04  pages 7084  new york  ny  usa  2004   14  josef hallberg and marcus nilsson  positioning with bluetooth  irda and rfid  masters thesis  lulea university of technology  march 2002   15  andy harter  andy hopper  pete steggles  andy ward  and paul webster  the anatomy of a context-aware application  in proceedings of the 5th annual acm/ieee international conference on mobile computing and networking  mobicom 99  pages 5968  new york  ny  usa  1999 acm   16  h hashemi  the indoor radio propagation channel  in proceedings of the ieee  volume 81  pages 943968  july 1993   17  a.k.m  mahtab hossain  hien nguyen van  yunye jin  and wee-seng soh  indoor localization using multiple wireless technologies  in ieee international conference on mobile adhoc and sensor systems conference  pages 18  los alamitos  ca  usa  2007 ieee computer society   18  a.k.m  mahtab hossain and wee-seng soh  a comprehensive study of bluetooth signal parameters for localization  in ieee 18th international symposium on personal  indoor and mobile radio communications  2007 pimrc 2007  pages 15  2007   19  jim kardach  tech history  how bluetooth http  //eetimes.com/electronics-news/4182202/  got its name  april 2008   20  binghao li  yufei wang  hyung k lee  andrew dempster  and chris rizos  method for yielding a database of location fingerprints in wlan  ieee proceedings-communications  152  5  :580586  october 2005   21  chong liu  kui wu  and tian he  sensor localization with ring overlapping based on comparison of received signal strength indicator  in ieee international conference on mobile ad-hoc and sensor systems  2004  pages 516518  october 2004   22  anil madhavapeddy and alastair tse  a study of bluetooth propagation using accurate indoor location mapping  in ubicomp 2005  ubiquitous computing  volume 3660 of lecture notes in computer science  pages 105122 springer-verlag  2005   23  miklos maroti  peter volgyesi  sebestyen dora  branislav kusy  andras nadas  akos ledeczi  gyorgy balogh  and karoly molnar  radio interferometric geolocation  in proceedings of the 3rd international conference on embedded networked sensor systems  sensys 05  pages 112 acm  2005   24  rene mayrhofer  stephan winkler  helmut hlavacs  michael affenzeller  and stefan schneider  on structural identification of 2d regression functions for indoor bluetooth localization  in computer aided systems theory  eurocast 2009  lecture notes in computer science  pages 801808 springer-verlag  2009   25  nintendo  wii remote controller  http  //www.nintendo.com/wii/console/controllers   26  n patwari  iii hero  a.o  m perkins  n.s  correal  and r.j odea  relative location estimation in wireless sensor networks  ieee transactions on signal processing  51  8  :2137 2148  august 2003 bibliography 81  27  n patwari  r.j odea  and yanwei wang  relative location in wireless networks  in ieee vts 53rd vehicular technology conference  2001 vtc 2001 spring  volume 2  pages 1149 1153  2001   28  vinay seshadri  gergely v zaruba  and manfred huber  a bayesian sampling approach to in-door localization of wireless devices using received signal strength indication  in ieee international conference on pervasive computing and communications  pages 7584 ieee computer society  2005   29  kiran yedavalli  bhaskar krishnamachari  sharmila ravula  and bhaskar srinivasan  ecolocation  a sequence based technique for rf localization in wireless sensor networks  in fourth international symposium on information processing in sensor networks  2005 ipsn 2005  pages 285292  april 2005   30  jie yin  qiang yang  and lionel m ni  learning adaptive temporal radio maps for signalstrength-based location estimation  ieee transactions on mobile computing  7:869883  july 2008 appendix a old dataset before the datasets described in section 7.2 were collected  another dataset had already been collected  originally this dataset consisted of two separate datasets  which were intended to be used for evaluating the localization algorithms  however due to some problems  these datasets were not suitable for that purpose  the first problem was that the middle of the test environment was not accessible for collecting a set of rss measurements at systematically selected locations  also  it was not possible to install access points at all of the intended locations  finally  because of time constraints only one full dataset could be collected  the second dataset contained only a small number of locations  which were randomly selected  while these datasets were sufficient for initial testing of the localization algorithms  they were not suitable for the complete performance analysis that was to be made  see chapter 8   later both datasets had been merged into a single dataset  this was done by taking all locations from the first dataset and 5 locations from the second dataset  these 5 locations were in the middle of the test environment and had not been included in the first dataset  figure a.1 shows the tested locations for the merged dataset as well as the locations of the access points that were used for collecting the rss measurements  8m = target location = access point figure a.1  location of target devices and access points  the setup for this dataset has been almost the same as that of the datasets described in 7.2 bluetooth dongles of the access points had been mounted into a fixed orientation using cardboard and were lowered to about 0.5 m below the metallic structure of the truss installations  all dongles were aligned in the same direction  i.e  they all had the same orientation  and all were located 2.5 m above the ground  the target devices were mounted on tripods and the dongles were elevated using cardboard to a height of 1.07 m below the bluetooth dongles of the access points  all dongles were aligned in the same direction  such that the relative orientation between the access points dongles and target device dongles corresponded to the optimal orientation identified in section 7.1.2 the setup of target devices is shown in figure a.2 a total of 5 target devices were available at the time of the measurements  with a total number of 80 locations  16 runs were needed to collect all of rss sample sets  each measurement 83 84 appendix a old dataset figure a.2  target device positioning for dataset collection  run was performed for a time period of 10 minutes  during the measurements  it was made sure that there was no movement within the test environment  this was done to ensure that rss measurements were not affected due to  temporary  changes in signal propagation  for the same reason  the layout of the test environment was not altered until all of the measurement runs had been performed  appendix b linear regression methods b.1 ordinary least squares ordinary least squares  ols  is a linear regression method that minimizes the variance of the errors between observed samples in a dataset and samples predicted using linear approximation  this minimization criterion is expressed by equation b.1     = argmin n x   yi xi  2  b.1  i=1 in this equation n is the number of samples in the dataset  yi is the observed value for sample i and xi is the regressor for sample i the symbols and denote the parameters of the linear approximation  equations b.2 and b.3 respectively give the analytical solution for finding the optimal values of and  n p n n 1 p p xi yi n i=1 i=1 i=1 =  n 2 n 1 p p 2 xi xi n i=1 i=1 = xi yi n n 1 x 1 x yi xi n n i=1 b.2  b.2   b.3  i=1 iteratively reweighted least squares iteratively reweighted least squares  irls  is a method for solving least absolute deviations  lad  linear regression  lad linear regression is based on the minimization of the absolute differences between observed samples in a dataset and the samples predicted using linear approximation  this minimization criterion is expressed by equation b.4     = argmin  n x |yi xi |  b.4  i=1 unlike ols linear regression no analytical solution exists for lad linear regression  consequentially equation b.4 needs to be evaluated using an iterative approach  a simple method for doing so is irls  with irls the values of and are updated iteratively until they converge  initially the linear approximation parameters are assigned a random value  e.g  1 for both and  the values of and for each iteration are then defined as  0 = 1 85  b.5  86 appendix b linear regression methods 0 = 1 n p n+1 = i=1 wi x2i n p n p n p n+1 = wi i=1 n p wi y i i=1 wi i=1 n p i=1 n p wi n p wi x2i i=1 wi x i y i i=1 n p n p 2  b.7  wi x i wi x i i=1 wi x2i n p i=1 wi xi yi n p wi x i i=1 i=1 i=1  b.6  n p n p wi y i i=1 2  b.8  wi x i i=1 here wi is defined as  wi = 1 |yi n n xi |  b.9  after a sufficient number of iterations n  n and n hold the final values of the linear approximation parameters  the number of iterations is sufficient if the values of and for iteration n do not show a significant change compared to the values for iteration n 1 appendix c dongle orientation measurements c.1 tested orientations figure c.1 shows the different dongle orientations that have been tested  for each of the listed orientations  the left dongle represents the dongle of the access point and right one represents the dongle of the target device  the dark areas on the dongles in figure c.1 show the location of the pcb antenna on the dongles and also serve as way for differentiating between orientations  orientation 1 orientation 2 orientation 3 orientation 4 orientation 5 orientation 6 orientation 7 orientation 8 orientation 9 orientation 10 orientation 11 orientation 12 orientation 13 orientation 14 figure c.1  tested dongle orientations  87 88 c.2 appendix c dongle orientation measurements results table c.1 shows the mean and standard deviation for the rss values measured at different bluetooth dongle orientations  data is aggregated for a time period of 10 minutes  the merged column shows the mean and standard deviation for the merged rss samples  i.e  angle is ignored  orientation 1 2 3 4 5 6 7 8 9 10 11 12 13 14 merged 46.13 3.25 48.80 4.17 49.38 3.44 50.91 4.68 51.56 4.80 51.72 5.59 52.59 5.74 53.65 7.45 53.65 3.59 54.05 6.58 54.07 5.63 54.74 5.97 55.27 5.19 56.49 7.20 0 46.99 52.42 53.31 49.61 56.01 48.61 50.09 62.80 58.07 56.21 59.37 58.99 60.52 63.49 1.47 5.07 2.62 1.76 3.82 1.97 1.71 7.23 2.88 3.92 3.46 3.65 4.20 5.07 30 43.09 45.44 48.22 46.87 48.70 59.75 49.47 51.41 53.94 57.72 55.53 58.05 55.84 60.41 1.99 1.48 2.48 2.37 1.13 4.03 2.66 5.49 1.92 8.92 3.13 5.36 3.29 5.22 60 48.27 47.60 46.75 54.64 47.88 51.56 57.41 48.18 51.45 53.98 54.10 48.88 53.90 50.84 3.84 3.20 2.21 4.11 2.70 3.65 8.04 2.88 2.09 4.52 4.77 5.31 4.48 4.99 90 45.93 49.95 49.17 52.71 53.65 47.41 53.13 52.50 51.31 48.09 47.04 52.36 50.41 51.26 2.29 2.20 2.15 5.21 4.77 1.63 3.66 3.44 2.48 1.61 1.28 2.36 2.35 2.47 table c.1  mean and standard deviation  in dbm  of measured rss values for different orientations  c.3 consistency test results to verify whether dongle orientation produces the same results  independently of the individual dongles being used  measurements for orientation 1 have been repeated  this was done using a new set of dongles for the access point and target devices  measurements were collected 4 times  each time moving dongles one position up to the next angle  the results for each repetition are shown in table c.2  repetition 1 2 3 4 merged 48.15 4.60 48.58 4.47 48.96 5.10 48.81 4.64 0 47.41 47.07 47.75 47.88 3.44 3.41 3.18 3.45 30 45.00 45.95 45.41 45.26 1.73 1.73 1.92 1.69 60 52.18 53.43 54.94 53.62 5.78 5.35 5.70 5.28 90 47.38 48.17 47.77 48.18 2.11 2.43 2.63 2.22 table c.2  measurement results for orientation 1 with dongles rotated each repetition  a visual comparison of the measured mean rss values for original and repeated tests of orientation 1 is show in figure c.2  the graph shows similar mean rss values for each test  mean rss values were a little higher for some angles of the original test  this is caused by the fact that the measurement setup was rebuild later for the repetitive tests  as a result there were some differences in positioning  which explain the differences in mean rss for some angles  c.3  consistency test results 89 orientation -42 -44 -46 -48 rss  dbm  -50 -52 -54 -56 -58 -60 -62 -64 original = 0 rep 1 = 30 rep 2 = 60 rep 3 = 90 rep 4 = merged figure c.2  mean rss for repeated angle tests using dongle orientation 1 appendix d mobile phone test results calibration dataset algorithm ecolocation calibrated lns  ols  calibrated lns  lad  uncalibrated lns fingerprinting  mean rss  fingerprinting  jsd  fixed orientation n w s e 2.22 2.12 2.20 1.92 3.58 2.84 3.15 2.01 3.58 2.84 3.15 2.01 2.22 2.84 1.42 3.09 3.15 3.03 2.99 1.42 3.15 2.27 3.15 3.03 random orientation n w s e 2.22 2.12 2.20 1.92 3.58 2.84 3.15 2.01 3.58 2.84 3.15 2.01 2.22 2.84 1.42 3.09 0.98 0.99 0.98 1.02 0.98 0.04 0.98 1.02 table d.1  location estimation errors in middle of left truss installation  calibration dataset algorithm ecolocation calibrated lns  ols  calibrated lns  lad  uncalibrated lns fingerprinting  mean rss  fingerprinting  jsd  fixed orientation n w s e 3.18 7.40 3.10 3.15 11.52 10.55 2.95 9.54 11.52 11.55 11.48 9.54 4.20 7.67 3.53 3.11 11.38 11.42 3.58 3.55 13.31 13.35 13.31 13.35 random orientation n w s e 3.18 7.40 3.10 3.15 10.51 10.55 2.95 3.55 11.52 10.55 2.95 3.55 4.20 7.67 3.53 3.11 2.92 10.41 9.51 9.54 13.46 13.50 9.51 9.54 table d.2  location estimation errors in middle of center truss installation  calibration dataset algorithm ecolocation calibrated lns  ols  calibrated lns  lad  uncalibrated lns fingerprinting  mean rss  fingerprinting  jsd  fixed orientation n w s e 2.81 2.57 2.22 2.55 2.20 2.22 2.20 2.95 2.20 2.22 2.20 2.95 2.22 3.15 2.22 2.95 7.97 9.58 7.97 2.95 2.23 2.20 22.70 2.76 random orientation n w s e 2.81 2.57 2.22 2.55 2.20 2.81 2.20 2.95 2.20 2.22 2.20 2.95 2.22 3.15 2.22 2.95 2.22 2.23 2.22 2.22 2.22 1.97 2.22 2.01 table d.3  location estimation errors in middle of right truss installation  91 